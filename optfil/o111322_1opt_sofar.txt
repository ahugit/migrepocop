nop,maxfn,iprint,nloop,iquad:   938000  20  95   1
stopcr,simp:    20.0000       0.00000    
T0,Tstep:    95.4076      0.500000    
Tfreq:   78
nop,maxfn,iprint,nloop,iquad:   938000  20  95   1
stopcr,simp:    20.0000       0.00000    
T0,Tstep:    95.4076      0.500000    
Tfreq:   78
 Estimating   78 parameters on   1 communicators
 Progress Report every  20 function evaluations
 EVAL.   FUNC.VALUE.          PARAMETER VALUES
iter,obj,time:      2        318.03         92.22          1.14         39.88          1.01          0.04        134.29
iter,obj,time:      3        325.87         87.52          1.15         40.06          1.06          0.05        129.84
iter,obj,time:      4        317.71         87.43          1.14         39.97          0.91          0.05        129.51
iter,obj,time:      5        332.75         87.33          1.11         39.85          1.26          0.05        129.59
iter,obj,time:      6        319.72         87.36          1.12         39.78          1.56          0.05        129.86
iter,obj,time:      7        332.46         87.30          1.12         39.81          1.25          0.05        129.53
iter,obj,time:      8       1924.53         87.59          1.19         39.95          0.59          0.04        129.37
iter,obj,time:      9        322.68         87.38          1.15         40.04          1.10          0.05        129.71
iter,obj,time:     10        329.96         87.36          1.14         40.02          1.03          0.05        129.60
iter,obj,time:     11        300.44         87.64          1.19         40.08          0.43          0.04        129.39
iter,obj,time:     12        320.09         87.50          1.14         40.04          0.88          0.05        129.61
iter,obj,time:     13        964.14         88.00          1.24         39.81          0.61          0.05        129.71
iter,obj,time:     14        310.89         87.43          1.16         39.96          1.00          0.05        129.59
iter,obj,time:     15        558.18         87.22          1.16         40.30          0.63          0.05        129.37
iter,obj,time:     16        315.77         87.41          1.13         39.96          0.96          0.05        129.52
iter,obj,time:     17        487.96         87.33          1.15         40.09          1.10          0.05        129.71
iter,obj,time:     18        361.18         87.35          1.14         39.90          1.09          0.05        129.54
iter,obj,time:     19        308.95         87.44          1.14         40.04          0.76          0.05        129.43
iter,obj,time:     20        414.70         87.33          1.14         39.99          1.21          0.04        129.71
iter,obj,time:     21        318.26         87.43          1.14         39.95          1.19          0.05        129.76
iter,obj,time:     22        318.01         87.52          1.15         40.12          0.62          0.05        129.46
iter,obj,time:     23        317.89         87.34          1.13         39.95          1.17          0.05        129.64
iter,obj,time:     24        318.05         87.52          1.14         40.13          0.94          0.04        129.78
iter,obj,time:     25        318.38         87.41          1.14         40.07          0.84          0.05        129.52
iter,obj,time:     26        318.03         87.50          1.14         40.07          0.93          0.05        129.69
iter,obj,time:     27        319.16         87.41          1.14         40.07          0.60          0.05        129.28
iter,obj,time:     28        319.48         87.35          1.12         40.00          1.07          0.05        129.60
iter,obj,time:     29        325.26         87.51          1.14         40.03          0.66          0.05        129.40
iter,obj,time:     30        344.82         87.53          1.14         39.98          1.02          0.05        129.72
iter,obj,time:     31        327.49         87.57          1.15         40.29          0.59          0.05        129.66
iter,obj,time:     32        333.84         87.53          1.13         40.10          0.89          0.05        129.70
iter,obj,time:     33        411.20         87.51          1.15         40.44          0.42          0.05        129.56
iter,obj,time:     34        314.97         87.61          1.14         40.02          1.42          0.05        130.24
iter,obj,time:     35        320.54         87.43          1.14         40.53          0.46          0.05        129.62
iter,obj,time:     36        319.81         87.55          1.14         40.07          0.68          0.04        129.49
iter,obj,time:     37        315.54         87.53          1.15         40.55          0.20          0.05        129.48
iter,obj,time:     38        326.47         87.45          1.13         40.10          0.84          0.05        129.57
iter,obj,time:     39        319.36         87.49          1.15         40.06          0.87          0.05        129.62
iter,obj,time:     40        319.31         87.52          1.14         40.02          1.18          0.05        129.92
iter,obj,time:     41        321.00         87.32          1.14         39.99          0.86          0.05        129.37
iter,obj,time:     42        317.09         87.48          1.14         40.05          0.83          0.05        129.54
iter,obj,time:     43        315.86         87.50          1.15         40.05          0.74          0.05        129.48
iter,obj,time:     44        317.92         87.58          1.14         40.07          0.61          0.05        129.45
iter,obj,time:     45        311.88         87.40          1.12         39.97          1.12          0.05        129.66
iter,obj,time:     46        312.76         87.33          1.11         39.93          1.12          0.05        129.54
iter,obj,time:     47        317.90         87.44          1.15         40.05          0.84          0.05        129.53
iter,obj,time:     48        316.95         87.46          1.15         40.50          0.62          0.05        129.78
iter,obj,time:     49        317.74         87.27          1.12         39.88          1.07          0.05        129.39
iter,obj,time:     50        322.41         87.27          1.11         40.21          0.83          0.05        129.48
iter,obj,time:     51        317.51         87.25          1.11         39.74          1.41          0.04        129.55
iter,obj,time:     52        313.81         87.47          1.14         40.31          0.61          0.05        129.58
iter,obj,time:     53        313.36         87.26          1.12         39.91          1.19          0.05        129.54
iter,obj,time:     54        317.93         87.42          1.15         40.02          0.83          0.05        129.46
iter,obj,time:     55        310.97         87.38          1.14         40.04          0.91          0.05        129.52
iter,obj,time:     56        321.38         87.47          1.13         40.17          0.75          0.05        129.57
iter,obj,time:     57        314.94         87.45          1.17         40.06          0.84          0.05        129.57
iter,obj,time:     58        495.15         87.53          1.17         40.40          0.36          0.05        129.52
iter,obj,time:     59        354.39         87.22          1.14         39.98          1.08          0.05        129.47
iter,obj,time:     60        318.03         87.40          1.15         40.10          0.74          0.05        129.44
iter,obj,time:     61        318.03         87.32          1.13         40.38          0.58          0.05        129.46
iter,obj,time:     62        319.17         87.48          1.16         40.08          0.85          0.05        129.62
iter,obj,time:     63        314.06         87.38          1.14         40.01          0.97          0.05        129.55
iter,obj,time:     64        305.15         87.35          1.14         40.05          0.92          0.05        129.51
iter,obj,time:     65        313.76         87.41          1.16         39.84          1.18          0.04        129.63
iter,obj,time:     66        323.79         87.25          1.11         39.71          1.55          0.05        129.67
iter,obj,time:     67        319.59         87.42          1.13         40.02          1.05          0.04        129.65
iter,obj,time:     68        317.67         87.39          1.13         40.01          0.94          0.05        129.51
iter,obj,time:     69        316.94         87.51          1.15         40.17          0.55          0.05        129.43
iter,obj,time:     70        317.37         87.36          1.13         40.07          1.07          0.05        129.68
iter,obj,time:     71        323.29         87.35          1.12         39.96          1.04          0.05        129.51
iter,obj,time:     72        318.54         87.35          1.11         40.07          0.94          0.04        129.51
iter,obj,time:     73        318.94         87.27          1.12         39.97          1.25          0.05        129.67
iter,obj,time:     74        312.13         87.30          1.12         39.96          1.11          0.04        129.52
iter,obj,time:     75        313.15         87.32          1.12         40.13          1.08          0.05        129.71
iter,obj,time:     76        325.72         87.49          1.13         39.95          0.91          0.05        129.54
iter,obj,time:     77        320.59         87.46          1.12         39.90          1.12          0.05        129.66
iter,obj,time:     78        318.67         87.34          1.13         39.99          0.99          0.05        129.50
iter,obj,time:     79        319.27         87.51          1.16         40.61          0.38          0.05        129.70
iter,obj,time:     80        319.05         87.38          1.14         39.89          1.14          0.05        129.60

    1    318.03        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

    2    325.87      -0.2103     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

    3    317.71        1.790     -3.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

    4    332.75        1.790     -1.112      4.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

    5    319.72        1.790     -1.112      6.124     -102.6     -1.370    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

    6    332.46        1.790     -1.112      6.124     -102.6     0.6298    
                      -2.078      3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

    7    1924.5        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  1.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

    8    322.68        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      2.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

    9    329.96        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085    -0.9188    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   10    300.44        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                     -0.3457E-01 -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   11    320.09        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -3.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   12    964.14        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194     0.4277    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   13    310.89        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.2700E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   14    558.18        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -1.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   15    315.77        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                     -0.2218      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   16    487.96        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.7723E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   17    361.18        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.5976E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   18    308.95        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -7458.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   19    414.70        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.1653E+06
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   20    318.26        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                       0.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   21    318.01        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -4.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   22    317.89        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -2.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   23    318.05        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -5.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   24    318.38        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      4.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   25    318.03        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -11.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   26    319.16        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -1.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   27    319.48        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      9245.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   28    325.26        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000     0.1616E+05

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   29    344.82        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                      0.1994E+05  5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   30    327.49        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.     0.2639E+05  3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   31    333.84        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.     0.1960E+05  7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   32    411.20        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.     0.3643E+05  2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   33    314.97        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.     0.1332E+05
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   34    320.54        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                      0.1281E+05 0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   35    319.81        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.3582    -0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   36    315.54        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01 0.2436      0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   37    326.47        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.2000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   38    319.36        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                      0.1870    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   39    319.31        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130     0.1319    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   40    321.00        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681     0.2278    -0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   41    317.09        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01 0.9794E-01-0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   42    315.86        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021     0.2659    

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   43    317.92        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.012    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   44    311.88        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512     0.4028      0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   45    312.76        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000     0.2664    -0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   46    317.90        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01 0.2807    
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   47    316.95        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.3269    -0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   48    317.74        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01 0.2655    -0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   49    322.41        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.6012E-01-0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   50    317.51        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601     0.1409    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   51    313.81        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                      0.2456    -0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   52    313.36        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01 0.2227    -0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   53    317.93        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01 0.1920    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   54    310.97        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.7040E-01  0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   55    321.38        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                     -0.9493     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   56    314.94        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949    -0.6411      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   57    495.15        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      0.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   58    354.39        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      0.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   59    318.03        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      1.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   60    318.03        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       1.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   61    319.17        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.505      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   62    314.06        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.424    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   63    305.15        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1500E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   64    313.76        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -4.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   65    323.79        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                      0.4213    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   66    319.59        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787     0.2521      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   67    317.67        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.698      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   68    316.94        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.848    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   69    317.37        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -4.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   70    323.29        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000      1.069    -0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   71    318.54        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01 0.4796      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   72    318.94        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      9.053      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   73    312.13        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.328    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   74    313.15        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -4.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   75    325.72        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000     0.3096    -0.2373      10.12    
                       8.459    -0.1000E+05 -2.000    

   76    320.59        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904     0.7627      10.12    
                       8.459    -0.1000E+05 -2.000    

   77    318.67        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.42    
                       8.459    -0.1000E+05 -2.000    

   78    319.27        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.759    -0.1000E+05 -2.000    

   79    319.05        1.790     -1.112      6.124     -102.6     0.6298    
                     -0.7827E-01  3.856     -99.70      4.085      1.081    
                       1.965     -1.194      1.428    -0.1800E+05 -2.500    
                      -1.222      0.000      0.000      0.000     -1.221    

                      -2.500     0.5148E+05 0.3984E+05 -3729.    -0.8266E+05
                      -2.000     -6.523     -4.447     -7.411      2.884    
                      -13.88     -2.943      1849.      0.000      3231.    

                       3987.      5278.      3920.      7286.      2665.    
                       2562.     0.5816E-01-0.5642E-01  0.000    -0.5000    
                     -0.1130    -0.1681    -0.7224E-01-0.2021    -0.3408E-01

                      -1.512    -0.9723E-01  0.000    -0.3362E-01-0.1933E-01
                      0.8541E-01 0.2689E-01-0.3448E-01-0.3601    -0.1591    
                     -0.5435E-01-0.7728E-01-0.1080    -0.3704      0.000    

                      -1.949     -1.641      1.000      1.000      0.000    
                       0.000      9.205      9.124    -0.1000E+05 -2.000    
                     -0.5787    -0.7479      9.398      8.548    -0.1000E+05

                      -2.000     0.6883E-01-0.5204      8.753      9.028    
                     -0.1000E+05 -2.000    -0.6904    -0.2373      10.12    
                       8.459    -0.1000E+05 -4.000    
 finished setting up initial simplex
 count number of function evaluations which here is neval=np1          79          79

beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        1
neval is:       79


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       79     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.228570      -1.47591      -140.813       140.813       318.025       458.839    
   2  0.709707     -0.342904      -32.7156       32.7156       325.871       358.587    
   3  0.151889      -1.88460      -179.805       179.805       317.711       497.516    
   4  0.456170E-01  -3.08747      -294.568       294.568       332.752       627.321    
   5  0.882557     -0.124932      -11.9194       11.9194       319.716       331.635    
   6  0.711292     -0.340672      -32.5027       32.5027       332.461       364.964    
   7  0.241669      -1.42019      -135.497       135.497       1924.53       2060.03    
   8  0.682871     -0.381450      -36.3932       36.3932       322.677       359.070    
   9  0.500657     -0.691834      -66.0062       66.0062       329.961       395.968    
  10  0.494633     -0.703939      -67.1611       67.1611       300.437       367.598    
  11  0.437126     -0.827535      -78.9531       78.9531       320.091       399.044    
  12  0.462981     -0.770069      -73.4704       73.4704       964.139       1037.61    
  13  0.988878     -0.111840E-01  -1.06704       1.06704       310.888       311.955    
  14  0.878158     -0.129929      -12.3962       12.3962       558.181       570.578    
  15  0.825605     -0.191638      -18.2838       18.2838       315.769       334.053    
  16  0.966665     -0.339033E-01  -3.23463       3.23463       487.955       491.190    
  17  0.340930      -1.07608      -102.666       102.666       361.180       463.845    
  18  0.288920      -1.24161      -118.459       118.459       308.952       427.411    
  19  0.442843     -0.814539      -77.7132       77.7132       414.704       492.417    
  20  0.878635     -0.129386      -12.3444       12.3444       318.256       330.600    
  21  0.198777E-01  -3.91816      -373.822       373.822       318.008       691.830    
  22  0.315829      -1.15255      -109.962       109.962       317.888       427.850    
  23  0.208690      -1.56690      -149.495       149.495       318.052       467.547    
  24  0.849393     -0.163234      -15.5737       15.5737       318.381       333.955    
  25  0.945818     -0.557056E-01  -5.31473       5.31473       318.025       323.340    
  26  0.567839     -0.565917      -53.9928       53.9928       319.165       373.158    
  27  0.718388     -0.330745      -31.5556       31.5556       319.482       351.037    
  28  0.115406      -2.15930      -206.013       206.013       325.264       531.277    
  29  0.659869E-01  -2.71830      -259.346       259.346       344.821       604.167    
  30  0.171393      -1.76380      -168.280       168.280       327.487       495.767    
  31  0.161953      -1.82045      -173.685       173.685       333.837       507.522    
  32  0.455406     -0.786566      -75.0443       75.0443       411.198       486.242    
  33  0.788693     -0.237378      -22.6476       22.6476       314.971       337.618    
  34  0.157754      -1.84672      -176.191       176.191       320.536       496.727    
  35  0.126279      -2.06926      -197.423       197.423       319.806       517.229    
  36  0.646962     -0.435467      -41.5469       41.5469       315.543       357.090    
  37  0.730769     -0.313658      -29.9253       29.9253       326.468       356.394    
  38  0.443446E-01  -3.11577      -297.268       297.268       319.358       616.626    
  39  0.219048      -1.51847      -144.873       144.873       319.305       464.178    
  40  0.311223E-01  -3.46983      -331.048       331.048       321.000       652.048    
  41  0.864417     -0.145700      -13.9009       13.9009       317.094       330.995    
  42  0.372606     -0.987233      -94.1895       94.1895       315.864       410.054    
  43  0.599250E-01  -2.81466      -268.540       268.540       317.923       586.463    
  44  0.250528      -1.38418      -132.061       132.061       311.882       443.943    
  45  0.404968E-01  -3.20653      -305.927       305.927       312.764       618.691    
  46  0.792822     -0.232156      -22.1494       22.1494       317.896       340.045    
  47  0.826691     -0.190324      -18.1583       18.1583       316.952       335.110    
  48  0.258424      -1.35316      -129.101       129.101       317.736       446.837    
  49  0.713620     -0.337405      -32.1910       32.1910       322.405       354.596    
  50  0.936186     -0.659413E-01  -6.29129       6.29129       317.507       323.799    
  51  0.655367E-01  -2.72514      -259.999       259.999       313.807       573.806    
  52  0.178790      -1.72154      -164.248       164.248       313.360       477.608    
  53  0.110644E-01  -4.50403      -429.718       429.718       317.931       747.650    
  54  0.459577     -0.777448      -74.1744       74.1744       310.973       385.148    
  55  0.210706      -1.55729      -148.578       148.578       321.375       469.953    
  56  0.667378     -0.404399      -38.5827       38.5827       314.940       353.523    
  57  0.787749     -0.238575      -22.7619       22.7619       495.150       517.911    
  58  0.774339E-01  -2.55833      -244.084       244.084       354.393       598.477    
  59  0.154999      -1.86434      -177.872       177.872       318.025       495.897    
  60  0.510712     -0.671950      -64.1091       64.1091       318.025       382.134    
  61  0.628107     -0.465044      -44.3687       44.3687       319.172       363.541    
  62  0.850273     -0.162197      -15.4749       15.4749       314.057       329.532    
  63  0.355976      -1.03289      -98.5456       98.5456       305.147       403.692    
  64  0.531318     -0.632394      -60.3351       60.3351       313.757       374.092    
  65  0.404575     -0.904917      -86.3360       86.3360       323.786       410.122    
  66  0.240103      -1.42669      -136.117       136.117       319.594       455.711    
  67  0.288602      -1.24271      -118.564       118.564       317.674       436.238    
  68  0.870493     -0.138695      -13.2326       13.2326       316.943       330.176    
  69  0.453038     -0.791780      -75.5417       75.5417       317.372       392.914    
  70  0.259221      -1.35008      -128.807       128.807       323.295       452.102    
  71  0.201751      -1.60072      -152.721       152.721       318.545       471.265    
  72  0.390245     -0.940979      -89.7765       89.7765       318.942       408.718    
  73  0.311089      -1.16768      -111.405       111.405       312.134       423.539    
  74  0.618900     -0.479811      -45.7776       45.7776       313.152       358.930    
  75  0.891204     -0.115182      -10.9892       10.9892       325.716       336.705    
  76  0.876712     -0.131577      -12.5534       12.5534       320.591       333.145    
  77  0.409798     -0.892090      -85.1121       85.1121       318.671       403.783    
  78  0.337394      -1.08651      -103.661       103.661       319.266       422.927    
  79  0.810099     -0.210599      -20.0927       20.0927       319.053       339.146    
loop,thermsimp(1:2)        1   140.813       32.7156    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     81        276.17         87.40          1.15         40.24          0.83          0.05        129.67
Just calling func    0   0        129.67


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:     82        281.45         87.39          1.14         40.57          0.52          0.05        129.66
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds

   80    276.17        1.738     -1.164      6.073     -102.6     0.5786    
                     -0.1296      5.856     -99.70      4.034      1.030    
                       1.914     -1.245      1.402    -0.1823E+05 -2.474    
                      -1.196      0.000      0.000      0.000     -1.221    

                      -2.500     0.5214E+05 0.4035E+05 -3825.    -0.8478E+05
                      -1.949     -6.471     -4.395     -7.359      2.935    
                      -13.83     -2.917      2039.      0.000      3562.    

                       4396.      5819.      4322.      8033.      2938.    
                       2825.     0.6585E-01-0.4873E-01  0.000    -0.4923    
                     -0.1053    -0.1604    -0.6455E-01-0.1944    -0.2639E-01

                      -1.499    -0.8441E-01  0.000    -0.2593E-01-0.1164E-01
                      0.8541E-01 0.3458E-01-0.2679E-01-0.3524    -0.1514    
                     -0.4666E-01-0.6959E-01-0.1004    -0.3627      0.000    

                      -1.924     -1.615     0.9744     0.9744     0.2564E-01
                      0.2564E-01  9.213      9.132    -0.1013E+05 -2.051    
                     -0.5531    -0.7222      9.405      8.555    -0.1000E+05

                      -2.051     0.9447E-01-0.4948      8.760      9.035    
                     -0.1000E+05 -2.051    -0.6648    -0.2116      10.12    
                       8.467    -0.1000E+05 -2.051    
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    276.17
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        1
neval is:       81
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        1      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        2
neval is:       81


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       81     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.352733      -1.04204      -99.4188       99.4188       310.888       410.307    
   2  0.440787     -0.819193      -78.1572       78.1572       318.025       396.182    
   3  0.685789     -0.377185      -35.9863       35.9863       317.507       353.494    
   4  0.673104     -0.395856      -37.7677       37.7677       314.057       351.824    
   5  0.655536     -0.422301      -40.2907       40.2907       316.943       357.234    
   6  0.422838     -0.860766      -82.1236       82.1236       318.256       400.379    
   7  0.300870      -1.20108      -114.592       114.592       317.094       431.686    
   8  0.776987     -0.252331      -24.0743       24.0743       319.716       343.790    
   9  0.170551      -1.76872      -168.749       168.749       320.591       489.340    
  10  0.587497     -0.531884      -50.7458       50.7458       318.381       369.127    
  11  0.250425      -1.38459      -132.101       132.101       315.769       447.870    
  12  0.776362E-01  -2.55572      -243.835       243.835       316.952       560.787    
  13  0.766647     -0.265729      -25.3526       25.3526       325.716       351.068    
  14  0.480193     -0.733568      -69.9879       69.9879       314.971       384.958    
  15  0.434643     -0.833231      -79.4965       79.4965       319.053       398.549    
  16  0.815924E-01  -2.50602      -239.093       239.093       317.896       556.989    
  17  0.724257E-01  -2.62519      -250.463       250.463       319.482       569.945    
  18  0.573795     -0.555483      -52.9973       52.9973       314.940       367.937    
  19  0.196096      -1.62915      -155.433       155.433       322.405       477.838    
  20  0.240673      -1.42432      -135.890       135.890       326.468       462.359    
  21  0.194228      -1.63872      -156.347       156.347       315.543       471.890    
  22  0.236387      -1.44229      -137.605       137.605       325.871       463.476    
  23  0.261662      -1.34070      -127.913       127.913       313.152       441.065    
  24  0.146321      -1.92195      -183.369       183.369       322.677       506.045    
  25  0.169637      -1.77410      -169.262       169.262       319.172       488.434    
  26  0.886717     -0.120229      -11.4708       11.4708       332.461       343.932    
  27  0.253412      -1.37274      -130.970       130.970       300.437       431.407    
  28  0.470820     -0.753279      -71.8685       71.8685       319.165       391.033    
  29  0.329871      -1.10905      -105.812       105.812       313.757       419.569    
  30  0.726784     -0.319126      -30.4470       30.4470       318.025       348.472    
  31  0.612351     -0.490450      -46.7927       46.7927       310.973       357.766    
  32  0.146573      -1.92023      -183.205       183.205       317.372       500.577    
  33  0.812633     -0.207476      -19.7947       19.7947       329.961       349.756    
  34  0.486789     -0.719925      -68.6863       68.6863       320.091       388.777    
  35  0.653508     -0.425400      -40.5864       40.5864       305.147       345.733    
  36  0.180127      -1.71409      -163.538       163.538       318.671       482.208    
  37  0.155218      -1.86292      -177.737       177.737       318.942       496.679    
  38  0.830615     -0.185589      -17.7066       17.7066       315.864       333.571    
  39  0.728345     -0.316980      -30.2423       30.2423       323.786       354.028    
  40  0.262318      -1.33820      -127.674       127.674       319.266       446.941    
  41  0.234222      -1.45148      -138.483       138.483       312.134       450.616    
  42  0.250201      -1.38549      -132.186       132.186       308.952       441.138    
  43  0.898433     -0.107103      -10.2185       10.2185       317.888       328.106    
  44  0.580277     -0.544250      -51.9256       51.9256       317.674       369.600    
  45  0.823617     -0.194050      -18.5138       18.5138       311.882       330.396    
  46  0.820676     -0.197627      -18.8551       18.8551       317.736       336.591    
  47  0.502494     -0.688171      -65.6567       65.6567       323.295       388.951    
  48  0.751016     -0.286329      -27.3179       27.3179       319.594       346.912    
  49  0.360461      -1.02037      -97.3511       97.3511       318.025       415.376    
  50  0.948712     -0.526497E-01  -5.02318       5.02318       361.180       366.203    
  51  0.452918     -0.792045      -75.5671       75.5671       319.305       394.872    
  52  0.182886      -1.69889      -162.087       162.087       318.052       480.140    
  53  0.986780     -0.133085E-01  -1.26973       1.26973       321.375       322.645    
  54  0.720276     -0.328121      -31.3052       31.3052       318.545       349.850    
  55  0.999574     -0.426396E-03 -0.406814E-01  0.406814E-01   313.360       313.400    
  56  0.573447     -0.556089      -53.0551       53.0551       411.198       464.253    
  57  0.441160E-01  -3.12093      -297.761       297.761       487.955       785.716    
  58  0.596470     -0.516726      -49.2995       49.2995       414.704       464.004    
  59  0.561679E-01  -2.87941      -274.717       274.717       327.487       602.205    
  60  0.664610     -0.408554      -38.9792       38.9792       318.025       357.004    
  61  0.875363     -0.133117      -12.7003       12.7003       320.536       333.236    
  62  0.969943     -0.305184E-01  -2.91168       2.91168       317.711       320.622    
  63  0.692714     -0.367138      -35.0277       35.0277       333.837       368.865    
  64  0.107969      -2.22591      -212.369       212.369       319.806       532.175    
  65  0.530030     -0.634822      -60.5668       60.5668       495.150       555.716    
  66  0.246082      -1.40209      -133.770       133.770       325.264       459.034    
  67  0.561065     -0.577919      -55.1378       55.1378       558.181       613.319    
  68  0.888085     -0.118688      -11.3237       11.3237       313.807       325.131    
  69  0.180192      -1.71373      -163.503       163.503       317.923       481.427    
  70  0.259121      -1.35046      -128.844       128.844       354.393       483.237    
  71  0.728967     -0.316127      -30.1609       30.1609       344.821       374.982    
  72  0.546722     -0.603814      -57.6084       57.6084       319.358       376.966    
  73  0.334936      -1.09382      -104.358       104.358       312.764       417.122    
  74  0.681788     -0.383037      -36.5446       36.5446       332.752       369.297    
  75  0.367328      -1.00150      -95.5507       95.5507       321.000       416.551    
  76  0.310586      -1.16929      -111.559       111.559       318.008       429.568    
  77  0.964734     -0.359024E-01  -3.42536       3.42536       317.931       321.357    
  78  0.249240      -1.38934      -132.553       132.553       964.139       1096.69    
  79  0.328926      -1.11192      -106.086       106.086       276.173       382.259    
loop,thermsimp(1:2)        2   99.4188       78.1572    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     83        469.16         87.35          1.11         39.81          1.37          0.05        129.68
Just calling func    0   0        129.68


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:     84        930.96         87.35          1.11         39.88          1.26          0.05        129.65
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    469.16
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        2
neval is:       83
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        2      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        3
neval is:       83


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       83     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.167898      -1.78440      -170.245       170.245       313.360       483.605    
   2  0.274399      -1.29317      -123.378       123.378       317.711       441.089    
   3  0.597410E-01  -2.81774      -268.833       268.833       317.931       586.765    
   4  0.283115E-01  -3.56449      -340.079       340.079       321.375       661.454    
   5  0.901069     -0.104174      -9.93898       9.93898       313.807       323.746    
   6  0.717939     -0.331371      -31.6153       31.6153       317.888       349.503    
   7  0.294866      -1.22123      -116.515       116.515       311.882       428.397    
   8  0.935651     -0.665127E-01  -6.34582       6.34582       320.536       326.882    
   9  0.314362      -1.15721      -110.407       110.407       315.864       426.271    
  10  0.807729     -0.213529      -20.3723       20.3723       317.736       338.108    
  11  0.757191     -0.278140      -26.5366       26.5366       319.716       346.253    
  12  0.508654     -0.675987      -64.4943       64.4943       332.461       396.956    
  13  0.722060     -0.325647      -31.0691       31.0691       305.147       336.216    
  14  0.424032     -0.857947      -81.8546       81.8546       319.594       401.449    
  15  0.786154     -0.240602      -22.9553       22.9553       318.025       340.980    
  16  0.399894     -0.916557      -87.4464       87.4464       329.961       417.408    
  17  0.757416     -0.277843      -26.5083       26.5083       318.545       345.053    
  18  0.637270     -0.450563      -42.9871       42.9871       325.716       368.703    
  19  0.586055     -0.534342      -50.9802       50.9802       314.057       365.037    
  20  0.821724     -0.196351      -18.7334       18.7334       317.507       336.241    
  21  0.921558     -0.816897E-01  -7.79381       7.79381       323.786       331.580    
  22  0.985596     -0.145083E-01  -1.38421       1.38421       318.025       319.409    
  23  0.257194      -1.35793      -129.556       129.556       316.943       446.499    
  24  0.921438E-01  -2.38440      -227.490       227.490       310.973       538.463    
  25  0.114653      -2.16584      -206.638       206.638       361.180       567.817    
  26  0.379827     -0.968040      -92.3584       92.3584       314.940       407.298    
  27  0.541451     -0.613503      -58.5328       58.5328       333.837       392.370    
  28  0.544274     -0.608302      -58.0366       58.0366       318.381       376.418    
  29  0.934365     -0.678883E-01  -6.47706       6.47706       332.752       339.229    
  30  0.266419E-01  -3.62527      -345.878       345.878       317.674       663.552    
  31  0.919572     -0.838466E-01  -7.99960       7.99960       344.821       352.820    
  32  0.864639     -0.145444      -13.8764       13.8764       319.358       333.234    
  33  0.341156      -1.07542      -102.603       102.603       276.173       378.776    
  34  0.803175     -0.219182      -20.9117       20.9117       314.971       335.882    
  35  0.699424     -0.357498      -34.1080       34.1080       320.091       354.199    
  36  0.223868E-01  -3.79928      -362.480       362.480       323.295       685.775    
  37  0.605689     -0.501389      -47.8363       47.8363       319.165       367.001    
  38  0.312349      -1.16363      -111.019       111.019       319.305       430.324    
  39  0.437501     -0.826675      -78.8711       78.8711       318.025       396.896    
  40  0.303330      -1.19293      -113.815       113.815       319.053       432.868    
  41  0.129735      -2.04226      -194.847       194.847       318.256       513.103    
  42  0.954352     -0.467224E-01  -4.45767       4.45767       310.888       315.346    
  43  0.519807     -0.654297      -62.4249       62.4249       318.025       380.450    
  44  0.950560     -0.507036E-01  -4.83750       4.83750       321.000       325.838    
  45  0.443941     -0.812064      -77.4770       77.4770       312.764       390.241    
  46  0.911446     -0.927229E-01  -8.84647       8.84647       313.757       322.604    
  47  0.782475     -0.245293      -23.4028       23.4028       318.008       341.411    
  48  0.412534     -0.885438      -84.4774       84.4774       300.437       384.914    
  49  0.843850     -0.169780      -16.1983       16.1983       317.094       333.292    
  50  0.149432      -1.90091      -181.362       181.362       313.152       494.514    
  51  0.292747      -1.22845      -117.203       117.203       308.952       426.155    
  52  0.579908E-02  -5.15006      -491.354       491.354       319.266       810.621    
  53  0.164431      -1.80526      -172.236       172.236       315.769       488.005    
  54  0.963795     -0.368765E-01  -3.51830       3.51830       312.134       315.652    
  55  0.536638     -0.622432      -59.3847       59.3847       325.264       384.648    
  56  0.231620      -1.46266      -139.549       139.549       326.468       466.017    
  57  0.452632E-01  -3.09526      -295.311       295.311       325.871       621.182    
  58  0.241294      -1.42174      -135.645       135.645       414.704       550.349    
  59  0.757653     -0.277529      -26.4784       26.4784       411.198       437.676    
  60  0.504715     -0.683762      -65.2360       65.2360       315.543       380.779    
  61  0.878562     -0.129469      -12.3523       12.3523       322.405       334.758    
  62  0.874452     -0.134158      -12.7997       12.7997       318.052       330.852    
  63  0.370953     -0.991680      -94.6137       94.6137       317.923       412.537    
  64  0.757717     -0.277446      -26.4704       26.4704       318.671       345.141    
  65  0.642844     -0.441853      -42.1561       42.1561       354.393       396.549    
  66  0.616137     -0.484286      -46.2046       46.2046       319.172       365.377    
  67  0.551578     -0.594972      -56.7648       56.7648       320.591       377.356    
  68  0.483778E-01  -3.02871      -288.962       288.962       318.942       607.904    
  69  0.839664     -0.174753      -16.6728       16.6728       317.372       334.045    
  70  0.334065      -1.09642      -104.607       104.607       322.677       427.283    
  71  0.995512     -0.449855E-02 -0.429195      0.429195       319.806       320.236    
  72  0.214896      -1.53760      -146.699       146.699       495.150       641.848    
  73  0.541100     -0.614151      -58.5947       58.5947       317.896       376.490    
  74  0.380397     -0.966540      -92.2153       92.2153       316.952       409.167    
  75  0.854752E-01  -2.45953      -234.658       234.658       319.482       554.139    
  76  0.749036     -0.288968      -27.5698       27.5698       327.487       355.057    
  77  0.461657     -0.772934      -73.7437       73.7437       558.181       631.925    
  78  0.116336      -2.15127      -205.248       205.248       487.955       693.203    
  79  0.492714     -0.707826      -67.5320       67.5320       469.164       536.696    
loop,thermsimp(1:2)        3   170.245       123.378    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     85        290.93         87.42          1.11         39.87          1.27          0.05        129.72
Just calling func    0   0        129.73


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:     86        294.72         87.39          1.12         40.12          0.95          0.05        129.63
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    290.93
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        3
neval is:       85
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        3      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        4
neval is:       85


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       85     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.883237     -0.124162      -11.8460       11.8460       310.888       322.734    
   2  0.114178      -2.16999      -207.034       207.034       312.134       519.167    
   3  0.217017      -1.52778      -145.762       145.762       318.025       463.787    
   4  0.138317      -1.97821      -188.736       188.736       319.806       508.542    
   5  0.832728     -0.183048      -17.4642       17.4642       313.757       331.221    
   6  0.390825     -0.939496      -89.6350       89.6350       313.807       403.442    
   7  0.283633      -1.26007      -120.221       120.221       321.000       441.221    
   8  0.725809     -0.320468      -30.5751       30.5751       320.536       351.111    
   9  0.506121     -0.680979      -64.9706       64.9706       318.052       383.023    
  10  0.216234      -1.53139      -146.106       146.106       323.786       469.893    
  11  0.637942     -0.449509      -42.8865       42.8865       319.358       362.245    
  12  0.536707     -0.622302      -59.3724       59.3724       317.094       376.466    
  13  0.231844      -1.46169      -139.456       139.456       317.372       456.829    
  14  0.491379     -0.710540      -67.7909       67.7909       322.405       390.196    
  15  0.825774     -0.191434      -18.2643       18.2643       314.971       333.235    
  16  0.671593     -0.398102      -37.9820       37.9820       305.147       343.129    
  17  0.549103     -0.599470      -57.1939       57.1939       317.507       374.701    
  18  0.659287     -0.416597      -39.7465       39.7465       317.736       357.483    
  19  0.205012      -1.58469      -151.191       151.191       332.752       483.943    
  20  0.400541E-02  -5.52011      -526.660       526.660       318.025       844.685    
  21  0.750831     -0.286575      -27.3414       27.3414       318.008       345.350    
  22  0.619921     -0.478162      -45.6203       45.6203       318.545       364.165    
  23  0.435226     -0.831889      -79.3685       79.3685       318.671       398.039    
  24  0.460974     -0.774414      -73.8850       73.8850       319.716       393.601    
  25  0.891582E-01  -2.41734      -230.633       230.633       317.888       548.520    
  26  0.589618E-01  -2.83087      -270.086       270.086       344.821       614.907    
  27  0.541391     -0.613613      -58.5433       58.5433       320.091       378.634    
  28  0.545108E-01  -2.90936      -277.574       277.574       327.487       605.062    
  29  0.744722     -0.294744      -28.1208       28.1208       314.057       342.178    
  30  0.712477     -0.339008      -32.3439       32.3439       319.172       351.516    
  31  0.563836     -0.572992      -54.6677       54.6677       319.165       373.833    
  32  0.161455      -1.82353      -173.978       173.978       325.716       499.694    
  33  0.640738     -0.445135      -42.4693       42.4693       318.381       360.850    
  34  0.157494      -1.84837      -176.348       176.348       317.896       494.244    
  35  0.695323     -0.363378      -34.6690       34.6690       320.591       355.260    
  36  0.792798     -0.232186      -22.1523       22.1523       276.173       298.325    
  37  0.940634     -0.612017E-01  -5.83910       5.83910       318.025       323.864    
  38  0.750008     -0.287672      -27.4461       27.4461       315.543       342.989    
  39  0.298939E-01  -3.51010      -334.890       334.890       325.264       660.154    
  40  0.633510     -0.456480      -43.5516       43.5516       300.437       343.988    
  41  0.465723     -0.764164      -72.9070       72.9070       312.764       385.671    
  42  0.916259     -0.874560E-01  -8.34396       8.34396       333.837       342.181    
  43  0.451376     -0.795456      -75.8925       75.8925       354.393       430.286    
  44  0.414090     -0.881672      -84.1182       84.1182       318.025       402.143    
  45  0.273092      -1.29795      -123.834       123.834       332.461       456.295    
  46  0.361379      -1.01783      -97.1084       97.1084       319.594       416.702    
  47  0.548848     -0.599934      -57.2382       57.2382       314.940       372.178    
  48  0.832309     -0.183552      -17.5123       17.5123       316.952       334.464    
  49  0.673017     -0.395985      -37.7799       37.7799       317.923       355.703    
  50  0.692516     -0.367425      -35.0551       35.0551       329.961       365.017    
  51  0.354468E-01  -3.33972      -318.635       318.635       308.952       627.587    
  52  0.987850     -0.122240E-01  -1.16626       1.16626       315.864       317.031    
  53  0.659676     -0.416007      -39.6902       39.6902       322.677       362.367    
  54  0.276145      -1.28683      -122.773       122.773       311.882       434.655    
  55  0.426927     -0.851141      -81.2053       81.2053       319.305       400.510    
  56  0.221817      -1.50590      -143.674       143.674       319.053       462.727    
  57  0.911956     -0.921634E-01  -8.79309       8.79309       411.198       419.991    
  58  0.791973     -0.233228      -22.2517       22.2517       317.711       339.962    
  59  0.805447     -0.216358      -20.6422       20.6422       316.943       337.585    
  60  0.887840     -0.118963      -11.3500       11.3500       326.468       337.818    
  61  0.978176     -0.220657E-01  -2.10523       2.10523       313.360       315.465    
  62  0.539899     -0.616372      -58.8066       58.8066       315.769       374.576    
  63  0.313742      -1.15918      -110.595       110.595       313.152       423.747    
  64  0.355768      -1.03348      -98.6014       98.6014       318.256       416.857    
  65  0.413366     -0.883423      -84.2852       84.2852       469.164       553.449    
  66  0.352288      -1.04331      -99.5392       99.5392       310.973       410.512    
  67  0.269512      -1.31114      -125.093       125.093       414.704       539.797    
  68  0.841976E-01  -2.47459      -236.094       236.094       319.482       555.576    
  69  0.964450     -0.361976E-01  -3.45352       3.45352       361.180       364.633    
  70  0.554883     -0.588998      -56.1948       56.1948       317.931       374.126    
  71  0.192411      -1.64812      -157.243       157.243       318.942       476.185    
  72  0.834093     -0.181411      -17.3079       17.3079       325.871       343.179    
  73  0.606638     -0.499823      -47.6869       47.6869       558.181       605.868    
  74  0.181851E-01  -4.00716      -382.313       382.313       495.150       877.462    
  75  0.963499     -0.371840E-01  -3.54764       3.54764       321.375       324.923    
  76  0.178061      -1.72563      -164.638       164.638       317.674       482.312    
  77  0.186011      -1.68195      -160.471       160.471       323.295       483.765    
  78  0.144531      -1.93426      -184.543       184.543       487.955       672.499    
  79  0.315860      -1.15246      -109.953       109.953       290.928       400.881    
loop,thermsimp(1:2)        4   11.8460       207.034    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     87        419.58         87.46          1.13         40.05          1.00          0.05        129.70
Just calling func    0   0        129.70


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       2    419.58
 mycase(ii+1)=2: hstar-thermstar(myrank+1) > htherm(1) BUT  hstar-thermstar(myrank+1)<htherm(np1-myrank-1) i.e hstar<htherm(np1-1) or (np1-2) ... (np1-myrank-1) .. etc
 mycase(ii+1)=2: hstar > hmi but lower than htherm(myimax-1) 
 nonparal: hstar is not <hmin. but lower than some point, replace p(imax) with pstar and hmax with hstar
 nonparal: note that in nonparallel version it's different, it doesn't sort the objvalue array and it compares hstar to aNY point other than imax
  ---> do nothing and just return the reflection point pstar i.e. mycase(..)=2,mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar.
  ---> Note that this is the only case in which the processor does not do an extra function call


  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        4
neval is:       86
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        4      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        5
neval is:       86


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       86     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.968189     -0.323278E-01  -3.08432       3.08432       276.173       279.257    
   2  0.384676     -0.955353      -91.1479       91.1479       313.360       404.508    
   3  0.472770     -0.749146      -71.4742       71.4742       315.864       387.339    
   4  0.131186      -2.03114      -193.786       193.786       310.888       504.674    
   5  0.387497     -0.948046      -90.4508       90.4508       318.025       408.476    
   6  0.474858     -0.744739      -71.0537       71.0537       321.375       392.429    
   7  0.654056     -0.424563      -40.5065       40.5065       313.757       354.264    
   8  0.375266     -0.980119      -93.5107       93.5107       314.971       408.481    
   9  0.605577     -0.501574      -47.8539       47.8539       316.952       364.806    
  10  0.485605     -0.722360      -68.9186       68.9186       316.943       385.862    
  11  0.503843     -0.685490      -65.4010       65.4010       326.468       391.869    
  12  0.374521     -0.982108      -93.7005       93.7005       317.711       411.411    
  13  0.955542E-01  -2.34806      -224.023       224.023       314.057       538.080    
  14  0.902567     -0.102512      -9.78043       9.78043       333.837       343.618    
  15  0.347215      -1.05781      -100.923       100.923       315.543       416.466    
  16  0.893138     -0.113014      -10.7824       10.7824       305.147       315.929    
  17  0.561145     -0.577776      -55.1241       55.1241       325.871       380.995    
  18  0.667287     -0.404536      -38.5958       38.5958       300.437       339.033    
  19  0.601102     -0.508991      -48.5616       48.5616       318.008       366.570    
  20  0.569928     -0.562245      -53.6424       53.6424       320.536       374.178    
  21  0.655926     -0.421708      -40.2341       40.2341       319.172       359.406    
  22  0.355892      -1.03313      -98.5681       98.5681       320.591       419.159    
  23  0.208013      -1.57015      -149.804       149.804       317.923       467.728    
  24  0.879772     -0.128093      -12.2210       12.2210       317.736       329.957    
  25  0.114206E-01  -4.47233      -426.694       426.694       318.381       745.075    
  26  0.950245     -0.510357E-01  -4.86919       4.86919       319.358       324.227    
  27  0.321268      -1.13548      -108.333       108.333       322.677       431.010    
  28  0.379005     -0.970207      -92.5651       92.5651       318.545       411.110    
  29  0.117960      -2.13741      -203.925       203.925       361.180       565.105    
  30  0.822558     -0.195337      -18.6366       18.6366       329.961       348.598    
  31  0.671085     -0.398860      -38.0543       38.0543       314.940       352.994    
  32  0.220279      -1.51286      -144.338       144.338       319.165       463.503    
  33  0.836335     -0.178727      -17.0519       17.0519       317.931       334.983    
  34  0.982442E-01  -2.32030      -221.374       221.374       315.769       537.143    
  35  0.912526     -0.915389E-01  -8.73350       8.73350       317.507       326.241    
  36  0.758802     -0.276015      -26.3339       26.3339       317.094       343.428    
  37  0.562651     -0.575096      -54.8685       54.8685       320.091       374.960    
  38  0.248142      -1.39375      -132.975       132.975       318.052       451.027    
  39  0.864881     -0.145163      -13.8497       13.8497       312.764       326.614    
  40  0.495151     -0.702893      -67.0613       67.0613       322.405       389.467    
  41  0.112352E-01  -4.48870      -428.256       428.256       319.716       747.972    
  42  0.745500     -0.293700      -28.0212       28.0212       318.671       346.692    
  43  0.405071     -0.903693      -86.2191       86.2191       319.305       405.524    
  44  0.617259     -0.482466      -46.0309       46.0309       290.928       336.959    
  45  0.992755     -0.727089E-02 -0.693698      0.693698       318.025       318.719    
  46  0.888739     -0.117952      -11.2535       11.2535       313.807       325.061    
  47  0.976701     -0.235748E-01  -2.24921       2.24921       310.973       313.222    
  48  0.461976     -0.772242      -73.6777       73.6777       319.594       393.272    
  49  0.150581      -1.89325      -180.630       180.630       318.256       498.886    
  50  0.726286E-01  -2.62240      -250.196       250.196       411.198       661.394    
  51  0.280837      -1.26998      -121.166       121.166       313.152       434.318    
  52  0.727959     -0.317510      -30.2928       30.2928       354.393       384.686    
  53  0.565225     -0.570532      -54.4330       54.4330       311.882       366.315    
  54  0.884775     -0.122422      -11.6800       11.6800       321.000       332.680    
  55  0.289837      -1.23844      -118.156       118.156       332.461       450.618    
  56  0.282389      -1.26447      -120.640       120.640       317.372       438.012    
  57  0.737455     -0.304550      -29.0564       29.0564       319.053       348.109    
  58  0.436668E-02  -5.43375      -518.421       518.421       318.025       836.446    
  59  0.809492     -0.211348      -20.1642       20.1642       323.786       343.950    
  60  0.957786E-01  -2.34572      -223.799       223.799       318.942       542.741    
  61  0.335750      -1.09139      -104.127       104.127       317.674       421.801    
  62  0.687327     -0.374945      -35.7726       35.7726       323.295       359.067    
  63  0.340103      -1.07851      -102.898       102.898       332.752       435.650    
  64  0.902520     -0.102564      -9.78538       9.78538       317.896       327.681    
  65  0.872595     -0.136284      -13.0025       13.0025       325.716       338.718    
  66  0.773535     -0.256784      -24.4992       24.4992       319.806       344.305    
  67  0.627340     -0.466267      -44.4854       44.4854       312.134       356.619    
  68  0.918418     -0.851028E-01  -8.11945       8.11945       414.704       422.823    
  69  0.347451      -1.05713      -100.858       100.858       317.888       418.746    
  70  0.962049     -0.386898E-01  -3.69130       3.69130       469.164       472.855    
  71  0.716962     -0.332732      -31.7452       31.7452       319.482       351.227    
  72  0.423789     -0.858520      -81.9093       81.9093       327.487       409.396    
  73  0.899832E-01  -2.40813      -229.754       229.754       558.181       787.935    
  74  0.770387     -0.260863      -24.8883       24.8883       344.821       369.709    
  75  0.746172     -0.292799      -27.9352       27.9352       308.952       336.887    
  76  0.696546     -0.361622      -34.5015       34.5015       325.264       359.765    
  77  0.486248     -0.721037      -68.7923       68.7923       487.955       556.748    
  78  0.797666     -0.226066      -21.5684       21.5684       318.025       339.594    
  79  0.196384      -1.62769      -155.293       155.293       419.579       574.873    
loop,thermsimp(1:2)        5   3.08432       91.1479    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     88        287.00         87.38          1.12         40.00          1.18          0.05        129.73
Just calling func    0   0        129.73


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:     89        272.21         87.46          1.13         40.20          0.81          0.05        129.66
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    272.21
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        5
neval is:       88
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        5      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        6
neval is:       88


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       88     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.806234     -0.215382      -20.5491       20.5491       276.173       296.722    
   2  0.337878      -1.08507      -103.524       103.524       310.973       414.497    
   3  0.930612     -0.719127E-01  -6.86101       6.86101       305.147       312.008    
   4  0.843645     -0.170024      -16.2216       16.2216       318.025       334.247    
   5  0.757799     -0.277337      -26.4600       26.4600       319.358       345.818    
   6  0.627925     -0.465335      -44.3965       44.3965       313.807       358.203    
   7  0.412314     -0.885971      -84.5283       84.5283       317.507       402.036    
   8  0.282274      -1.26488      -120.679       120.679       312.764       433.443    
   9  0.426609E-01  -3.15447      -300.961       300.961       317.896       618.856    
  10  0.484876     -0.723862      -69.0619       69.0619       317.736       386.798    
  11  0.372210     -0.988296      -94.2909       94.2909       321.000       415.291    
  12  0.740507     -0.300421      -28.6624       28.6624       317.931       346.594    
  13  0.361519      -1.01744      -97.0716       97.0716       308.952       406.024    
  14  0.421034     -0.865042      -82.5315       82.5315       290.928       373.459    
  15  0.780595     -0.247699      -23.6324       23.6324       325.716       349.348    
  16  0.758410     -0.276531      -26.3831       26.3831       300.437       326.820    
  17  0.522921E-01  -2.95091      -281.539       281.539       318.025       599.564    
  18  0.609673     -0.494833      -47.2108       47.2108       317.094       364.305    
  19  0.204029      -1.58949      -151.649       151.649       333.837       485.487    
  20  0.516385     -0.660902      -63.0550       63.0550       323.786       386.841    
  21  0.323918      -1.12726      -107.549       107.549       319.806       427.356    
  22  0.671820     -0.397765      -37.9498       37.9498       318.671       356.620    
  23  0.850344     -0.162114      -15.4669       15.4669       319.053       334.520    
  24  0.515631     -0.662364      -63.1945       63.1945       329.961       393.156    
  25  0.919408     -0.840249E-01  -8.01661       8.01661       319.482       327.498    
  26  0.516519     -0.660643      -63.0303       63.0303       314.940       377.970    
  27  0.986900     -0.131869E-01  -1.25813       1.25813       313.757       315.015    
  28  0.127351      -2.06081      -196.617       196.617       312.134       508.750    
  29  0.775028E-01  -2.55744      -243.999       243.999       323.295       567.294    
  30  0.778307     -0.250634      -23.9124       23.9124       319.172       343.085    
  31  0.548570     -0.600441      -57.2866       57.2866       325.264       382.550    
  32  0.191672      -1.65197      -157.610       157.610       316.952       474.562    
  33  0.593733     -0.521326      -49.7384       49.7384       311.882       361.620    
  34  0.612853     -0.489631      -46.7145       46.7145       318.008       364.723    
  35  0.872749     -0.136107      -12.9856       12.9856       344.821       357.806    
  36  0.291105E-01  -3.53666      -337.424       337.424       320.536       657.960    
  37  0.310804      -1.16859      -111.493       111.493       320.091       431.584    
  38  0.238051      -1.43527      -136.936       136.936       325.871       462.807    
  39  0.600295     -0.510334      -48.6897       48.6897       354.393       403.083    
  40  0.856575     -0.154813      -14.7703       14.7703       316.943       331.714    
  41  0.127990      -2.05580      -196.139       196.139       315.864       512.004    
  42  0.390396E-01  -3.24318      -309.424       309.424       322.405       631.829    
  43  0.469298E-01  -3.05910      -291.862       291.862       326.468       618.330    
  44  0.170208      -1.77073      -168.941       168.941       321.375       490.316    
  45  0.457801     -0.781320      -74.5438       74.5438       319.594       394.138    
  46  0.451589     -0.794982      -75.8473       75.8473       313.360       389.207    
  47  0.601844     -0.507757      -48.4438       48.4438       319.305       367.749    
  48  0.923684     -0.793857E-01  -7.57400       7.57400       318.025       325.599    
  49  0.113154      -2.17901      -207.894       207.894       314.971       522.864    
  50  0.652894     -0.426340      -40.6761       40.6761       327.487       368.163    
  51  0.600010     -0.510809      -48.7350       48.7350       318.545       367.280    
  52  0.768679     -0.263082      -25.1000       25.1000       317.711       342.811    
  53  0.999310     -0.690144E-03 -0.658450E-01  0.658450E-01   315.543       315.609    
  54  0.798907     -0.224511      -21.4200       21.4200       317.888       339.308    
  55  0.246243      -1.40144      -133.708       133.708       320.591       454.299    
  56  0.798424     -0.225115      -21.4777       21.4777       317.674       339.152    
  57  0.120926      -2.11257      -201.555       201.555       414.704       616.259    
  58  0.771675     -0.259192      -24.7289       24.7289       322.677       347.405    
  59  0.670629     -0.399540      -38.1191       38.1191       313.152       351.271    
  60  0.127505      -2.05960      -196.501       196.501       332.752       529.253    
  61  0.375387     -0.979799      -93.4802       93.4802       317.372       410.853    
  62  0.572534E-01  -2.86027      -272.891       272.891       332.461       605.353    
  63  0.358654      -1.02540      -97.8306       97.8306       318.052       415.883    
  64  0.903087     -0.101937      -9.72555       9.72555       319.165       328.890    
  65  0.112925      -2.18103      -208.087       208.087       317.923       526.010    
  66  0.727950     -0.317523      -30.2941       30.2941       469.164       499.458    
  67  0.703618E-01  -2.65411      -253.222       253.222       318.256       571.477    
  68  0.461106     -0.774128      -73.8576       73.8576       310.888       384.746    
  69  0.546854     -0.603573      -57.5854       57.5854       315.769       373.355    
  70  0.264522      -1.32983      -126.876       126.876       314.057       440.933    
  71  0.562280     -0.575755      -54.9314       54.9314       318.942       373.873    
  72  0.745931     -0.293123      -27.9661       27.9661       487.955       515.921    
  73  0.753398E-01  -2.58575      -246.700       246.700       361.180       607.879    
  74  0.150464E-01  -4.19662      -400.389       400.389       419.579       819.968    
  75  0.237963      -1.43564      -136.971       136.971       411.198       548.169    
  76  0.310733      -1.16882      -111.514       111.514       318.381       429.895    
  77  0.871120     -0.137975      -13.1639       13.1639       319.716       332.880    
  78  0.610203     -0.493964      -47.1279       47.1279       558.181       605.309    
  79  0.600732     -0.509607      -48.6203       48.6203       272.208       320.828    
loop,thermsimp(1:2)        6   20.5491       103.524    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     90        501.43         87.20          1.12         39.82          1.67          0.05        129.86
Just calling func    0   0        129.86


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:     91       1062.89         87.00          1.17         40.10          0.53          0.05        128.84
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    501.43
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        6
neval is:       90
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        6      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        7
neval is:       90


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       90     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.117714      -2.13949      -204.124       204.124       276.173       480.297    
   2  0.421875     -0.863045      -82.3411       82.3411       305.147       387.488    
   3  0.700103     -0.356528      -34.0155       34.0155       313.757       347.773    
   4  0.209367      -1.56367      -149.186       149.186       315.543       464.729    
   5  0.117251      -2.14344      -204.500       204.500       272.208       476.708    
   6  0.898330     -0.107218      -10.2294       10.2294       318.025       328.255    
   7  0.209806      -1.56157      -148.986       148.986       300.437       449.423    
   8  0.917155     -0.864790E-01  -8.25075       8.25075       319.482       327.732    
   9  0.120514E-01  -4.41857      -421.565       421.565       319.165       740.730    
  10  0.189983      -1.66082      -158.455       158.455       316.943       475.398    
  11  0.257131      -1.35817      -129.579       129.579       319.716       449.295    
  12  0.913158E-01  -2.39343      -228.351       228.351       318.025       546.377    
  13  0.336531      -1.08906      -103.905       103.905       319.053       422.958    
  14  0.318351      -1.14460      -109.204       109.204       317.674       426.878    
  15  0.919606     -0.838101E-01  -7.99611       7.99611       317.888       325.884    
  16  0.719771E-01  -2.63141      -251.056       251.056       317.711       568.767    
  17  0.788730E-01  -2.53992      -242.327       242.327       319.172       561.500    
  18  0.905929     -0.987941E-01  -9.42570       9.42570       319.358       328.784    
  19  0.665501     -0.407215      -38.8514       38.8514       317.931       356.783    
  20  0.812159     -0.208059      -19.8504       19.8504       322.677       342.527    
  21  0.412726E-01  -3.18756      -304.117       304.117       325.716       629.833    
  22  0.256064      -1.36233      -129.976       129.976       313.152       443.128    
  23  0.277519      -1.28187      -122.300       122.300       318.671       440.970    
  24  0.279550      -1.27457      -121.604       121.604       344.821       466.425    
  25  0.857884     -0.153286      -14.6247       14.6247       313.807       328.432    
  26  0.205158      -1.58398      -151.123       151.123       311.882       463.005    
  27  0.482085     -0.729635      -69.6127       69.6127       317.094       386.707    
  28  0.494966E-01  -3.00585      -286.781       286.781       318.008       604.789    
  29  0.338791      -1.08237      -103.267       103.267       318.545       421.811    
  30  0.249491E-01  -3.69092      -352.141       352.141       319.305       671.446    
  31  0.480710     -0.732491      -69.8852       69.8852       327.487       397.372    
  32  0.908951E-01  -2.39805      -228.792       228.792       315.769       544.561    
  33  0.283223      -1.26152      -120.359       120.359       290.928       411.286    
  34  0.277734      -1.28109      -122.226       122.226       318.942       441.168    
  35  0.504407     -0.684372      -65.2943       65.2943       314.940       380.234    
  36  0.251881      -1.37880      -131.548       131.548       325.264       456.811    
  37  0.568193     -0.565294      -53.9333       53.9333       310.888       364.822    
  38  0.186135      -1.68128      -160.407       160.407       317.736       478.143    
  39  0.964582     -0.360604E-01  -3.44044       3.44044       323.786       327.227    
  40  0.493045     -0.707155      -67.4679       67.4679       313.360       380.828    
  41  0.477950     -0.738248      -70.4345       70.4345       329.961       400.396    
  42  0.114879      -2.16388      -206.450       206.450       319.594       526.044    
  43  0.324003      -1.12700      -107.524       107.524       317.507       425.032    
  44  0.720573     -0.327708      -31.2658       31.2658       354.393       385.659    
  45  0.934913     -0.673019E-01  -6.42111       6.42111       308.952       315.373    
  46  0.516467     -0.660745      -63.0400       63.0400       317.372       380.412    
  47  0.351513      -1.04551      -99.7493       99.7493       310.973       410.722    
  48  0.310221      -1.17047      -111.672       111.672       321.000       432.672    
  49  0.467571     -0.760204      -72.5292       72.5292       318.052       390.582    
  50  0.700644     -0.355756      -33.9418       33.9418       319.806       353.748    
  51  0.608579E-01  -2.79921      -267.066       267.066       318.381       585.447    
  52  0.360106      -1.02136      -97.4452       97.4452       320.091       417.536    
  53  0.355744      -1.03354      -98.6080       98.6080       312.764       411.372    
  54  0.356778      -1.03064      -98.3309       98.3309       314.057       412.388    
  55  0.209214      -1.56440      -149.255       149.255       320.591       469.847    
  56  0.513034     -0.667413      -63.6763       63.6763       325.871       389.547    
  57  0.131750      -2.02685      -193.377       193.377       316.952       510.328    
  58  0.860948     -0.149721      -14.2845       14.2845       333.837       348.122    
  59  0.245301      -1.40527      -134.073       134.073       321.375       455.448    
  60  0.411604     -0.887695      -84.6928       84.6928       469.164       553.856    
  61  0.444838     -0.810046      -77.2845       77.2845       312.134       389.418    
  62  0.173997      -1.74872      -166.841       166.841       315.864       482.705    
  63  0.616177     -0.484222      -46.1984       46.1984       487.955       534.154    
  64  0.794601     -0.229915      -21.9356       21.9356       314.971       336.906    
  65  0.926158     -0.767101E-01  -7.31872       7.31872       317.923       325.242    
  66  0.614053     -0.487673      -46.5277       46.5277       332.752       379.280    
  67  0.228742      -1.47516      -140.741       140.741       411.198       551.939    
  68  0.162916      -1.81452      -173.119       173.119       323.295       496.414    
  69  0.437909     -0.825744      -78.7822       78.7822       318.256       397.038    
  70  0.966188     -0.343970E-01  -3.28173       3.28173       318.025       321.307    
  71  0.756703     -0.278785      -26.5982       26.5982       558.181       584.779    
  72  0.537306     -0.621187      -59.2659       59.2659       332.461       391.727    
  73  0.544827     -0.607287      -57.9397       57.9397       361.180       419.119    
  74  0.452750     -0.792414      -75.6023       75.6023       414.704       490.306    
  75  0.951192E-01  -2.35262      -224.458       224.458       326.468       550.926    
  76  0.970150     -0.303043E-01  -2.89126       2.89126       317.896       320.787    
  77  0.645255     -0.438110      -41.7990       41.7990       322.405       364.204    
  78  0.442258     -0.815862      -77.8394       77.8394       320.536       398.375    
  79  0.571943     -0.558716      -53.3058       53.3058       501.425       554.731    
loop,thermsimp(1:2)        7   204.124       82.3411    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     92        288.95         87.36          1.14         40.12          0.82          0.05        129.50
Just calling func    0   0        129.50


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:     93        294.14         87.23          1.11         39.79          1.45          0.05        129.63
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    288.95
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        7
neval is:       92
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        7      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        8
neval is:       92


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       92     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.487401     -0.718668      -68.5664       68.5664       308.952       377.518    
   2  0.568497     -0.564760      -53.8824       53.8824       317.896       371.778    
   3  0.632037E-01  -2.76139      -263.458       263.458       318.025       581.483    
   4  0.184325      -1.69105      -161.339       161.339       317.923       479.263    
   5  0.949772     -0.515332E-01  -4.91665       4.91665       317.888       322.804    
   6  0.512179     -0.669081      -63.8354       63.8354       323.786       387.621    
   7  0.573767     -0.555532      -53.0019       53.0019       319.482       372.484    
   8  0.590189     -0.527312      -50.3096       50.3096       318.025       368.335    
   9  0.323917      -1.12727      -107.550       107.550       313.807       421.357    
  10  0.246420E-01  -3.70330      -353.323       353.323       319.358       672.681    
  11  0.923153E-01  -2.38255      -227.313       227.313       314.971       542.283    
  12  0.236043      -1.44374      -137.744       137.744       322.677       460.420    
  13  0.885388     -0.121730      -11.6139       11.6139       313.757       325.371    
  14  0.617726     -0.481710      -45.9588       45.9588       333.837       379.796    
  15  0.349992      -1.04985      -100.163       100.163       319.806       419.970    
  16  0.892028     -0.114257      -10.9010       10.9010       317.931       328.832    
  17  0.382423     -0.961227      -91.7083       91.7083       322.405       414.114    
  18  0.850527     -0.161899      -15.4464       15.4464       310.888       326.335    
  19  0.653461     -0.425472      -40.5932       40.5932       332.752       373.345    
  20  0.413959     -0.881988      -84.1483       84.1483       314.940       399.088    
  21  0.807813     -0.213424      -20.3623       20.3623       317.372       337.735    
  22  0.348045      -1.05542      -100.695       100.695       313.360       414.055    
  23  0.435267     -0.831795      -79.3595       79.3595       354.393       433.753    
  24  0.434284     -0.834056      -79.5752       79.5752       317.094       396.669    
  25  0.983564     -0.165728E-01  -1.58117       1.58117       305.147       306.728    
  26  0.545923     -0.605277      -57.7480       57.7480       312.134       369.882    
  27  0.227140      -1.48219      -141.412       141.412       325.871       467.283    
  28  0.965085     -0.355395E-01  -3.39074       3.39074       318.052       321.443    
  29  0.183882      -1.69346      -161.569       161.569       332.461       494.030    
  30  0.187300E-02  -6.28022      -599.180       599.180       318.256       917.436    
  31  0.428736     -0.846914      -80.8020       80.8020       327.487       408.289    
  32  0.459764     -0.777041      -74.1356       74.1356       320.536       394.671    
  33  0.914786     -0.890649E-01  -8.49746       8.49746       329.961       338.459    
  34  0.872236     -0.136696      -13.0418       13.0418       310.973       324.015    
  35  0.789367     -0.236524      -22.5662       22.5662       290.928       313.494    
  36  0.619233E-01  -2.78186      -265.410       265.410       312.764       578.174    
  37  0.138004E-01  -4.28306      -408.636       408.636       314.057       722.693    
  38  0.287035      -1.24815      -119.083       119.083       320.091       439.174    
  39  0.138758E-01  -4.27761      -408.116       408.116       361.180       769.296    
  40  0.593330     -0.522005      -49.8032       49.8032       318.545       368.348    
  41  0.399445     -0.917679      -87.5535       87.5535       319.053       406.606    
  42  0.982947     -0.172001E-01  -1.64102       1.64102       317.507       319.148    
  43  0.259534      -1.34887      -128.692       128.692       317.674       446.366    
  44  0.816592E-01  -2.50520      -239.015       239.015       321.000       560.015    
  45  0.166083      -1.79527      -171.282       171.282       318.671       489.953    
  46  0.967370     -0.331741E-01  -3.16506       3.16506       318.942       322.107    
  47  0.371024     -0.991488      -94.5954       94.5954       313.152       407.748    
  48  0.941964     -0.597885E-01  -5.70428       5.70428       319.716       325.420    
  49  0.130219      -2.03854      -194.492       194.492       300.437       494.928    
  50  0.599455     -0.511734      -48.8233       48.8233       321.375       370.198    
  51  0.519323     -0.655230      -62.5139       62.5139       325.264       387.778    
  52  0.829175     -0.187324      -17.8722       17.8722       311.882       329.754    
  53  0.341525      -1.07433      -102.500       102.500       315.543       418.043    
  54  0.686480     -0.376178      -35.8902       35.8902       344.821       380.711    
  55  0.273157      -1.29771      -123.811       123.811       320.591       444.402    
  56  0.472999     -0.748662      -71.4280       71.4280       316.943       388.371    
  57  0.591611     -0.524905      -50.0799       50.0799       272.208       322.288    
  58  0.253673      -1.37171      -130.871       130.871       317.736       448.608    
  59  0.522398     -0.649326      -61.9506       61.9506       276.173       338.123    
  60  0.927744     -0.749995E-01  -7.15552       7.15552       315.864       323.020    
  61  0.470581     -0.753787      -71.9170       71.9170       414.704       486.621    
  62  0.365015      -1.00782      -96.1533       96.1533       323.295       419.448    
  63  0.732288     -0.311582      -29.7273       29.7273       316.952       346.679    
  64  0.536772E-01  -2.92477      -279.045       279.045       319.594       598.639    
  65  0.725826     -0.320444      -30.5728       30.5728       487.955       518.528    
  66  0.806822     -0.214652      -20.4794       20.4794       315.769       336.249    
  67  0.104580E-01  -4.56039      -435.096       435.096       318.025       753.121    
  68  0.818881     -0.199816      -19.0640       19.0640       326.468       345.532    
  69  0.330445      -1.10732      -105.646       105.646       411.198       516.844    
  70  0.316989      -1.14889      -109.613       109.613       469.164       578.776    
  71  0.776875     -0.252476      -24.0881       24.0881       501.425       525.513    
  72  0.782540     -0.245210      -23.3949       23.3949       319.172       342.567    
  73  0.972988     -0.273831E-01  -2.61255       2.61255       317.711       320.323    
  74  0.567786E-01  -2.86860      -273.686       273.686       558.181       831.867    
  75  0.111463      -2.19406      -209.330       209.330       318.381       527.711    
  76  0.109413      -2.21263      -211.101       211.101       318.008       529.110    
  77  0.900240     -0.105094      -10.0268       10.0268       325.716       335.743    
  78  0.153236      -1.87578      -178.963       178.963       319.305       498.268    
  79  0.967387     -0.331562E-01  -3.16335       3.16335       288.946       292.109    
loop,thermsimp(1:2)        8   68.5664       53.8824    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     94        290.27         87.45          1.13         39.98          1.06          0.05        129.67
Just calling func    0   0        129.67


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:     95        300.01         87.29          1.13         40.02          1.25          0.05        129.75
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    290.27
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        8
neval is:       94
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        8      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:        9
neval is:       94


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       94     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.878288E-01  -2.43237      -232.066       232.066       288.946       521.012    
   2  0.192227      -1.64908      -157.335       157.335       305.147       462.481    
   3  0.872733     -0.136126      -12.9875       12.9875       290.928       303.915    
   4  0.444113     -0.811675      -77.4399       77.4399       317.507       394.947    
   5  0.194382      -1.63793      -156.271       156.271       317.711       473.982    
   6  0.358074      -1.02702      -97.9852       97.9852       318.052       416.038    
   7  0.461693     -0.772855      -73.7362       73.7362       318.942       392.678    
   8  0.180202      -1.71368      -163.498       163.498       272.208       435.706    
   9  0.944954     -0.566187E-01  -5.40186       5.40186       317.888       323.289    
  10  0.738770     -0.302769      -28.8864       28.8864       315.864       344.751    
  11  0.822491E-01  -2.49800      -238.328       238.328       310.973       549.301    
  12  0.313602      -1.15963      -110.637       110.637       313.757       424.395    
  13  0.978185     -0.220567E-01  -2.10438       2.10438       319.716       321.820    
  14  0.540591E-01  -2.91768      -278.369       278.369       310.888       589.257    
  15  0.872885     -0.135951      -12.9708       12.9708       317.931       330.902    
  16  0.209079      -1.56504      -149.317       149.317       311.882       461.199    
  17  0.789205E-01  -2.53931      -242.270       242.270       325.716       567.986    
  18  0.746404     -0.292489      -27.9056       27.9056       315.769       343.675    
  19  0.110219      -2.20529      -210.401       210.401       317.372       527.774    
  20  0.656016     -0.421570      -40.2209       40.2209       276.173       316.394    
  21  0.665675     -0.406953      -38.8264       38.8264       329.961       368.788    
  22  0.563292     -0.573957      -54.7598       54.7598       319.172       373.932    
  23  0.615044     -0.486062      -46.3739       46.3739       326.468       372.842    
  24  0.128081      -2.05509      -196.071       196.071       316.952       513.023    
  25  0.459916     -0.776711      -74.1041       74.1041       318.025       392.129    
  26  0.433297     -0.836332      -79.7924       79.7924       318.545       398.337    
  27  0.225675      -1.48866      -142.029       142.029       312.134       454.163    
  28  0.808805     -0.212197      -20.2452       20.2452       321.375       341.620    
  29  0.578238     -0.547770      -52.2613       52.2613       317.896       370.157    
  30  0.569572     -0.562871      -53.7021       53.7021       319.482       373.184    
  31  0.291272      -1.23350      -117.685       117.685       332.752       450.437    
  32  0.144426      -1.93499      -184.612       184.612       308.952       493.564    
  33  0.908321     -0.961572E-01  -9.17412       9.17412       333.837       343.011    
  34  0.593166     -0.522281      -49.8296       49.8296       344.821       394.650    
  35  0.327630      -1.11587      -106.463       106.463       323.786       430.249    
  36  0.823214E-01  -2.49712      -238.245       238.245       325.264       563.508    
  37  0.742531     -0.297691      -28.4020       28.4020       316.943       345.345    
  38  0.476201E-01  -3.04450      -290.468       290.468       320.536       611.004    
  39  0.183829      -1.69375      -161.597       161.597       317.094       478.691    
  40  0.417257     -0.874053      -83.3912       83.3912       314.940       398.331    
  41  0.647723E-01  -2.73688      -261.119       261.119       319.053       580.172    
  42  0.123950E-01  -4.39046      -418.883       418.883       313.152       732.035    
  43  0.281372E-01  -3.57066      -340.668       340.668       327.487       668.155    
  44  0.883044     -0.124380      -11.8668       11.8668       313.360       325.227    
  45  0.445413     -0.808754      -77.1612       77.1612       322.405       399.566    
  46  0.418101     -0.872031      -83.1983       83.1983       315.543       398.742    
  47  0.301534      -1.19887      -114.382       114.382       323.295       437.676    
  48  0.674500     -0.393783      -37.5699       37.5699       319.806       357.376    
  49  0.732783     -0.310905      -29.6627       29.6627       313.807       343.470    
  50  0.970355     -0.300929E-01  -2.87109       2.87109       354.393       357.264    
  51  0.981589     -0.185824E-01  -1.77290       1.77290       320.091       321.864    
  52  0.677253     -0.389711      -37.1813       37.1813       320.591       357.772    
  53  0.800731     -0.222230      -21.2024       21.2024       317.674       338.877    
  54  0.529544     -0.635738      -60.6542       60.6542       317.736       378.390    
  55  0.814619     -0.205035      -19.5618       19.5618       322.677       342.238    
  56  0.909218     -0.951702E-01  -9.07995       9.07995       325.871       334.951    
  57  0.269472      -1.31129      -125.107       125.107       317.923       443.031    
  58  0.166504      -1.79274      -171.041       171.041       414.704       585.745    
  59  0.328775      -1.11238      -106.130       106.130       318.671       424.800    
  60  0.333602      -1.09781      -104.739       104.739       332.461       437.200    
  61  0.213893      -1.54228      -147.145       147.145       300.437       447.582    
  62  0.401720     -0.911999      -87.0116       87.0116       319.305       406.317    
  63  0.453769     -0.790168      -75.3880       75.3880       411.198       486.586    
  64  0.649690E-01  -2.73384      -260.829       260.829       487.955       748.785    
  65  0.510128     -0.673093      -64.2182       64.2182       501.425       565.643    
  66  0.430053     -0.843847      -80.5094       80.5094       318.381       398.890    
  67  0.528469E-01  -2.94036      -280.532       280.532       318.008       598.540    
  68  0.887506     -0.119339      -11.3859       11.3859       314.971       326.356    
  69  0.499442     -0.694264      -66.2380       66.2380       321.000       387.238    
  70  0.432451     -0.838287      -79.9789       79.9789       312.764       392.743    
  71  0.637121     -0.450796      -43.0093       43.0093       469.164       512.173    
  72  0.523182     -0.647826      -61.8075       61.8075       318.025       379.833    
  73  0.221333      -1.50809      -143.883       143.883       319.594       463.477    
  74  0.597769     -0.514551      -49.0920       49.0920       319.358       368.450    
  75  0.886305     -0.120694      -11.5151       11.5151       314.057       325.572    
  76  0.306306      -1.18317      -112.884       112.884       318.025       430.909    
  77  0.341612      -1.07408      -102.475       102.475       361.180       463.655    
  78  0.388979     -0.944230      -90.0866       90.0866       558.181       648.268    
  79  0.274361      -1.29331      -123.391       123.391       290.274       413.666    
loop,thermsimp(1:2)        9   232.066       157.335    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     96        568.24         87.52          1.13         40.36          0.62          0.04        129.67
Just calling func    0   0        129.67


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       2    568.24
 mycase(ii+1)=2: hstar-thermstar(myrank+1) > htherm(1) BUT  hstar-thermstar(myrank+1)<htherm(np1-myrank-1) i.e hstar<htherm(np1-1) or (np1-2) ... (np1-myrank-1) .. etc
 mycase(ii+1)=2: hstar > hmi but lower than htherm(myimax-1) 
 nonparal: hstar is not <hmin. but lower than some point, replace p(imax) with pstar and hmax with hstar
 nonparal: note that in nonparallel version it's different, it doesn't sort the objvalue array and it compares hstar to aNY point other than imax
  ---> do nothing and just return the reflection point pstar i.e. mycase(..)=2,mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar.
  ---> Note that this is the only case in which the processor does not do an extra function call


  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:        9
neval is:       95
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:        9      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       10
neval is:       95


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       95     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.611807     -0.491339      -46.8775       46.8775       290.928       337.805    
   2  0.877337     -0.130865      -12.4855       12.4855       276.173       288.658    
   3  0.821280     -0.196891      -18.7849       18.7849       319.716       338.501    
   4  0.989636     -0.104181E-01 -0.993966      0.993966       320.091       321.085    
   5  0.492813     -0.707625      -67.5128       67.5128       317.888       385.400    
   6  0.904083     -0.100835      -9.62038       9.62038       313.360       322.980    
   7  0.490620     -0.712086      -67.9384       67.9384       314.057       381.995    
   8  0.572439     -0.557850      -53.2231       53.2231       314.971       368.194    
   9  0.588753     -0.529749      -50.5421       50.5421       317.931       368.473    
  10  0.341799      -1.07353      -102.423       102.423       325.871       428.294    
  11  0.449605     -0.799385      -76.2674       76.2674       317.674       393.942    
  12  0.740720     -0.300132      -28.6349       28.6349       321.375       350.010    
  13  0.173164E-01  -4.05610      -386.983       386.983       322.677       709.659    
  14  0.828389     -0.188272      -17.9626       17.9626       333.837       351.800    
  15  0.110451      -2.20318      -210.200       210.200       313.807       524.007    
  16  0.646816     -0.435693      -41.5684       41.5684       315.769       357.338    
  17  0.857676     -0.153529      -14.6478       14.6478       315.864       330.512    
  18  0.691202E-02  -4.97449      -474.604       474.604       316.943       791.547    
  19  0.530885     -0.633210      -60.4130       60.4130       354.393       414.806    
  20  0.742957     -0.297117      -28.3472       28.3472       319.806       348.154    
  21  0.883526E-01  -2.42642      -231.499       231.499       320.591       552.090    
  22  0.599138     -0.512263      -48.8737       48.8737       319.358       368.232    
  23  0.476407     -0.741482      -70.7430       70.7430       329.961       400.704    
  24  0.509994E-01  -2.97594      -283.927       283.927       317.896       601.823    
  25  0.669768     -0.400824      -38.2417       38.2417       326.468       364.710    
  26  0.874430     -0.134183      -12.8020       12.8020       319.482       332.284    
  27  0.830739     -0.185440      -17.6923       17.6923       319.172       336.865    
  28  0.166673      -1.79172      -170.944       170.944       317.736       488.680    
  29  0.578742     -0.546898      -52.1782       52.1782       318.025       370.203    
  30  0.433531     -0.835791      -79.7408       79.7408       321.000       400.741    
  31  0.979127     -0.210935E-01  -2.01248       2.01248       318.025       320.038    
  32  0.310252      -1.17037      -111.662       111.662       318.942       430.604    
  33  0.686879     -0.375597      -35.8348       35.8348       312.764       348.599    
  34  0.243104      -1.41427      -134.932       134.932       344.821       479.753    
  35  0.459407     -0.777818      -74.2097       74.2097       317.507       391.717    
  36  0.332163      -1.10213      -105.151       105.151       314.940       420.092    
  37  0.512243     -0.668956      -63.8235       63.8235       318.545       382.368    
  38  0.323240      -1.12936      -107.750       107.750       315.543       423.293    
  39  0.667455     -0.404284      -38.5717       38.5717       318.381       356.953    
  40  0.460037     -0.776449      -74.0791       74.0791       322.405       396.484    
  41  0.227415      -1.48098      -141.296       141.296       319.305       460.601    
  42  0.636494     -0.451780      -43.1032       43.1032       290.274       333.377    
  43  0.432078     -0.839149      -80.0611       80.0611       318.052       398.114    
  44  0.609015     -0.495913      -47.3138       47.3138       313.757       361.071    
  45  0.427755     -0.849205      -81.0205       81.0205       318.671       399.691    
  46  0.496712     -0.699745      -66.7610       66.7610       323.786       390.547    
  47  0.295308      -1.21974      -116.372       116.372       318.025       434.397    
  48  0.928979     -0.736692E-01  -7.02860       7.02860       272.208       279.236    
  49  0.245696E-01  -3.70625      -353.604       353.604       332.461       686.065    
  50  0.833617E-01  -2.48457      -237.046       237.046       323.295       560.341    
  51  0.499690     -0.693767      -66.1906       66.1906       317.923       384.114    
  52  0.320552      -1.13771      -108.546       108.546       300.437       408.983    
  53  0.151030E-01  -4.19286      -400.030       400.030       332.752       732.783    
  54  0.551054     -0.595922      -56.8554       56.8554       312.134       368.989    
  55  0.786630     -0.239997      -22.8975       22.8975       311.882       334.779    
  56  0.793760E-01  -2.53356      -241.721       241.721       305.147       546.868    
  57  0.456771     -0.783574      -74.7589       74.7589       319.594       394.353    
  58  0.613263     -0.488962      -46.6506       46.6506       361.180       407.830    
  59  0.407581     -0.897515      -85.6297       85.6297       317.711       403.340    
  60  0.214329      -1.54024      -146.951       146.951       317.094       464.045    
  61  0.543052     -0.610551      -58.2512       58.2512       411.198       469.449    
  62  0.861407     -0.149188      -14.2337       14.2337       308.952       323.186    
  63  0.727563     -0.318055      -30.3448       30.3448       469.164       499.509    
  64  0.954867     -0.461830E-01  -4.40620       4.40620       316.952       321.358    
  65  0.209413      -1.56345      -149.165       149.165       288.946       438.110    
  66  0.218233E-02  -6.12736      -584.597       584.597       317.372       901.969    
  67  0.990675     -0.936839E-02 -0.893815      0.893815       310.973       311.867    
  68  0.874543     -0.134054      -12.7897       12.7897       325.264       338.053    
  69  0.276161      -1.28677      -122.768       122.768       501.425       624.193    
  70  0.319398      -1.14132      -108.890       108.890       325.716       434.606    
  71  0.160691      -1.82827      -174.431       174.431       319.053       493.484    
  72  0.612149     -0.490779      -46.8240       46.8240       414.704       461.528    
  73  0.832427     -0.183410      -17.4987       17.4987       310.888       328.387    
  74  0.985697     -0.144064E-01  -1.37448       1.37448       318.008       319.383    
  75  0.607085     -0.499087      -47.6167       47.6167       320.536       368.152    
  76  0.612015     -0.490999      -46.8450       46.8450       558.181       605.026    
  77  0.413704     -0.882605      -84.2071       84.2071       327.487       411.694    
  78  0.909905     -0.944149E-01  -9.00789       9.00789       313.152       322.160    
  79  0.841355     -0.172741      -16.4808       16.4808       568.245       584.725    
loop,thermsimp(1:2)       10   46.8775       12.4855    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     97        283.57         87.34          1.12         39.66          1.49          0.05        129.66
Just calling func    0   0        129.66


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:     98        269.95         87.31          1.11         39.62          1.76          0.05        129.85
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    269.95
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       10
neval is:       97
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       10      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       11
neval is:       97


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       97     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.356780      -1.03064      -98.3306       98.3306       272.208       370.538    
   2  0.318207      -1.14505      -109.247       109.247       276.173       385.420    
   3  0.410972E-01  -3.19181      -304.523       304.523       310.973       615.496    
   4  0.217948      -1.52350      -145.353       145.353       318.008       463.361    
   5  0.460755     -0.774888      -73.9302       73.9302       318.025       391.955    
   6  0.694214     -0.364975      -34.8214       34.8214       320.091       354.912    
   7  0.237764      -1.43648      -137.051       137.051       316.952       454.002    
   8  0.635477     -0.453379      -43.2558       43.2558       313.152       356.408    
   9  0.882831E-01  -2.42721      -231.574       231.574       313.360       544.934    
  10  0.889613     -0.116969      -11.1597       11.1597       308.952       320.112    
  11  0.236395      -1.44225      -137.602       137.602       310.888       448.490    
  12  0.785560     -0.241359      -23.0274       23.0274       315.864       338.892    
  13  0.253594      -1.37202      -130.901       130.901       319.482       450.383    
  14  0.767743     -0.264300      -25.2163       25.2163       290.274       315.490    
  15  0.425111     -0.855405      -81.6121       81.6121       311.882       393.494    
  16  0.334680E-01  -3.39717      -324.115       324.115       319.172       643.288    
  17  0.737903     -0.303943      -28.9984       28.9984       290.928       319.926    
  18  0.530906     -0.633170      -60.4092       60.4092       325.264       385.673    
  19  0.811772     -0.208536      -19.8959       19.8959       319.716       339.612    
  20  0.781494     -0.246548      -23.5226       23.5226       319.806       343.329    
  21  0.668871     -0.402164      -38.3695       38.3695       312.764       351.133    
  22  0.609633     -0.494898      -47.2170       47.2170       321.375       368.592    
  23  0.732795E-01  -2.61347      -249.345       249.345       333.837       583.182    
  24  0.999755     -0.244962E-03 -0.233712E-01  0.233712E-01   318.381       318.404    
  25  0.556911     -0.585350      -55.8469       55.8469       315.769       371.616    
  26  0.381942     -0.962485      -91.8284       91.8284       313.757       405.586    
  27  0.230973      -1.46546      -139.816       139.816       326.468       466.284    
  28  0.791084     -0.234351      -22.3589       22.3589       320.536       342.895    
  29  0.122039      -2.10341      -200.681       200.681       314.971       515.652    
  30  0.411383     -0.888231      -84.7439       84.7439       319.358       404.102    
  31  0.753656     -0.282819      -26.9831       26.9831       317.931       344.914    
  32  0.846821     -0.166266      -15.8631       15.8631       312.134       327.997    
  33  0.577745     -0.548622      -52.3427       52.3427       318.025       370.368    
  34  0.859903     -0.150936      -14.4004       14.4004       314.057       328.457    
  35  0.915816     -0.879395E-01  -8.39009       8.39009       318.545       326.935    
  36  0.220499      -1.51186      -144.243       144.243       317.923       462.166    
  37  0.539962     -0.616256      -58.7955       58.7955       317.888       376.683    
  38  0.810725     -0.209827      -20.0190       20.0190       323.786       343.805    
  39  0.901567     -0.103621      -9.88620       9.88620       317.507       327.394    
  40  0.196148      -1.62888      -155.408       155.408       317.674       473.082    
  41  0.413437     -0.883250      -84.2687       84.2687       319.594       403.863    
  42  0.192892      -1.64562      -157.005       157.005       322.405       479.410    
  43  0.194290      -1.63840      -156.316       156.316       318.052       474.368    
  44  0.988313     -0.117563E-01  -1.12164       1.12164       318.671       319.792    
  45  0.917980     -0.855792E-01  -8.16490       8.16490       329.961       338.126    
  46  0.136083      -1.99449      -190.289       190.289       321.000       511.289    
  47  0.847126     -0.165905      -15.8286       15.8286       317.711       333.539    
  48  0.513003     -0.667474      -63.6820       63.6820       361.180       424.862    
  49  0.562161     -0.575967      -54.9516       54.9516       300.437       355.388    
  50  0.926079     -0.767957E-01  -7.32689       7.32689       327.487       334.814    
  51  0.890313     -0.116182      -11.0846       11.0846       354.393       365.478    
  52  0.857665     -0.153542      -14.6490       14.6490       314.940       329.589    
  53  0.599877     -0.511031      -48.7562       48.7562       315.543       364.300    
  54  0.835330     -0.179929      -17.1665       17.1665       325.871       343.038    
  55  0.323336      -1.12906      -107.721       107.721       318.942       426.663    
  56  0.305042      -1.18731      -113.278       113.278       318.025       431.303    
  57  0.980883     -0.193016E-01  -1.84152       1.84152       325.716       327.557    
  58  0.129682      -2.04267      -194.886       194.886       288.946       483.832    
  59  0.738352     -0.303335      -28.9404       28.9404       319.305       348.245    
  60  0.383117     -0.959416      -91.5355       91.5355       414.704       506.239    
  61  0.524900     -0.644547      -61.4947       61.4947       317.094       378.589    
  62  0.594829     -0.519481      -49.5624       49.5624       411.198       460.760    
  63  0.596925     -0.515963      -49.2268       49.2268       344.821       394.048    
  64  0.462523     -0.771060      -73.5649       73.5649       317.736       391.301    
  65  0.837977     -0.176764      -16.8647       16.8647       319.053       335.918    
  66  0.380204     -0.967046      -92.2635       92.2635       469.164       561.427    
  67  0.135974E-01  -4.29788      -410.050       410.050       313.807       723.857    
  68  0.816466     -0.202771      -19.3458       19.3458       305.147       324.493    
  69  0.877970     -0.130143      -12.4166       12.4166       320.591       333.008    
  70  0.468378     -0.758480      -72.3648       72.3648       323.295       395.659    
  71  0.238817E-01  -3.73464      -356.313       356.313       568.245       924.558    
  72  0.517025     -0.659665      -62.9370       62.9370       317.896       380.833    
  73  0.583879     -0.538062      -51.3352       51.3352       558.181       609.517    
  74  0.987129E-03  -6.92071      -660.288       660.288       501.425       1161.71    
  75  0.605732     -0.501317      -47.8295       47.8295       332.461       380.291    
  76  0.141001      -1.95899      -186.902       186.902       322.677       509.579    
  77  0.333264      -1.09882      -104.836       104.836       332.752       437.588    
  78  0.384574     -0.955619      -91.1733       91.1733       316.943       408.116    
  79  0.897742     -0.107873      -10.2919       10.2919       269.945       280.237    
loop,thermsimp(1:2)       11   98.3306       109.247    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:     99        431.82         87.50          1.13         40.06          1.01          0.05        129.74
Just calling func    0   0        129.74


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       2    431.82
 mycase(ii+1)=2: hstar-thermstar(myrank+1) > htherm(1) BUT  hstar-thermstar(myrank+1)<htherm(np1-myrank-1) i.e hstar<htherm(np1-1) or (np1-2) ... (np1-myrank-1) .. etc
 mycase(ii+1)=2: hstar > hmi but lower than htherm(myimax-1) 
 nonparal: hstar is not <hmin. but lower than some point, replace p(imax) with pstar and hmax with hstar
 nonparal: note that in nonparallel version it's different, it doesn't sort the objvalue array and it compares hstar to aNY point other than imax
  ---> do nothing and just return the reflection point pstar i.e. mycase(..)=2,mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar.
  ---> Note that this is the only case in which the processor does not do an extra function call


  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       11
neval is:       98
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       11      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       12
neval is:       98


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       98     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.759790E-01  -2.57730      -245.894       245.894       269.945       515.839    
   2  0.804470     -0.217571      -20.7579       20.7579       290.274       311.032    
   3  0.984017     -0.161120E-01  -1.53721       1.53721       318.381       319.918    
   4  0.587639     -0.531643      -50.7227       50.7227       318.671       369.393    
   5  0.523810     -0.646626      -61.6930       61.6930       290.928       352.621    
   6  0.930607     -0.719181E-01  -6.86153       6.86153       308.952       315.814    
   7  0.360114E-01  -3.32392      -317.127       317.127       305.147       622.274    
   8  0.963815     -0.368556E-01  -3.51630       3.51630       318.545       322.061    
   9  0.201264E-01  -3.90572      -372.635       372.635       317.507       690.143    
  10  0.954897     -0.461522E-01  -4.40327       4.40327       325.716       330.119    
  11  0.374160     -0.983071      -93.7924       93.7924       312.134       405.926    
  12  0.174967      -1.74316      -166.310       166.310       314.057       480.367    
  13  0.381618     -0.963335      -91.9094       91.9094       314.940       406.849    
  14  0.191097      -1.65498      -157.897       157.897       320.591       478.488    
  15  0.425287     -0.854991      -81.5726       81.5726       317.711       399.283    
  16  0.426180     -0.852893      -81.3725       81.3725       327.487       408.860    
  17  0.615671     -0.485042      -46.2767       46.2767       319.053       365.330    
  18  0.787264     -0.239192      -22.8207       22.8207       329.961       352.782    
  19  0.812636     -0.207472      -19.7944       19.7944       315.864       335.659    
  20  0.917241E-01  -2.38897      -227.926       227.926       319.716       547.642    
  21  0.671310     -0.398525      -38.0223       38.0223       320.536       358.558    
  22  0.548174     -0.601162      -57.3554       57.3554       325.871       383.227    
  23  0.134851      -2.00359      -191.157       191.157       319.806       510.964    
  24  0.373236     -0.985545      -94.0285       94.0285       323.786       417.815    
  25  0.578774     -0.546843      -52.1730       52.1730       317.931       370.104    
  26  0.910021     -0.942872E-01  -8.99571       8.99571       319.305       328.301    
  27  0.192323      -1.64858      -157.287       157.287       312.764       470.051    
  28  0.366342      -1.00419      -95.8071       95.8071       320.091       415.898    
  29  0.686994     -0.375430      -35.8189       35.8189       300.437       336.256    
  30  0.486551     -0.720414      -68.7330       68.7330       313.152       381.885    
  31  0.256801      -1.35945      -129.702       129.702       315.543       445.245    
  32  0.284977      -1.25535      -119.770       119.770       354.393       474.163    
  33  0.903072     -0.101953      -9.72704       9.72704       321.375       331.102    
  34  0.226450      -1.48523      -141.702       141.702       318.025       459.727    
  35  0.446078     -0.807261      -77.0188       77.0188       272.208       349.226    
  36  0.152634      -1.87971      -179.339       179.339       315.769       495.108    
  37  0.511955     -0.669518      -63.8771       63.8771       317.888       381.765    
  38  0.513138     -0.667210      -63.6568       63.6568       317.094       380.751    
  39  0.637309     -0.450501      -42.9812       42.9812       332.461       375.442    
  40  0.861477     -0.149107      -14.2259       14.2259       317.896       332.122    
  41  0.817364     -0.201671      -19.2409       19.2409       276.173       295.414    
  42  0.793820     -0.230898      -22.0294       22.0294       325.264       347.293    
  43  0.253309      -1.37315      -131.008       131.008       317.736       448.745    
  44  0.702532     -0.353065      -33.6850       33.6850       318.025       351.710    
  45  0.822324     -0.195620      -18.6636       18.6636       311.882       330.546    
  46  0.720485     -0.327831      -31.2775       31.2775       344.821       376.098    
  47  0.881589     -0.126029      -12.0242       12.0242       323.295       335.319    
  48  0.584479     -0.537035      -51.2372       51.2372       319.594       370.831    
  49  0.697197     -0.360688      -34.4123       34.4123       319.358       353.770    
  50  0.320931      -1.13653      -108.434       108.434       313.757       422.191    
  51  0.780071     -0.248371      -23.6964       23.6964       316.943       340.640    
  52  0.318322E-01  -3.44728      -328.896       328.896       361.180       690.076    
  53  0.693387     -0.366167      -34.9351       34.9351       318.942       353.877    
  54  0.332128      -1.10223      -105.161       105.161       318.025       423.187    
  55  0.891883E-01  -2.41701      -230.601       230.601       332.752       563.353    
  56  0.960735     -0.400567E-01  -3.82172       3.82172       310.888       314.710    
  57  0.726634     -0.319332      -30.4667       30.4667       319.482       349.948    
  58  0.867850     -0.141737      -13.5228       13.5228       316.952       330.475    
  59  0.960075     -0.407444E-01  -3.88732       3.88732       411.198       415.085    
  60  0.303374E-01  -3.49537      -333.485       333.485       317.923       651.409    
  61  0.159557      -1.83535      -175.106       175.106       318.008       493.115    
  62  0.487506     -0.718453      -68.5458       68.5458       326.468       395.014    
  63  0.978612E-01  -2.32420      -221.747       221.747       317.674       539.421    
  64  0.405010     -0.903843      -86.2335       86.2335       318.052       404.286    
  65  0.199088      -1.61401      -153.988       153.988       322.405       476.394    
  66  0.621424     -0.475741      -45.3893       45.3893       288.946       334.335    
  67  0.630612     -0.461065      -43.9891       43.9891       414.704       458.693    
  68  0.842429     -0.171466      -16.3592       16.3592       322.677       339.036    
  69  0.887493     -0.119355      -11.3874       11.3874       321.000       332.388    
  70  0.813538     -0.206363      -19.6886       19.6886       314.971       334.659    
  71  0.901945     -0.103202      -9.84625       9.84625       313.360       323.206    
  72  0.789044E-01  -2.53952      -242.289       242.289       469.164       711.453    
  73  0.325005      -1.12391      -107.230       107.230       333.837       441.067    
  74  0.701704     -0.354243      -33.7975       33.7975       558.181       591.979    
  75  0.797802     -0.225895      -21.5521       21.5521       310.973       332.525    
  76  0.707467     -0.346064      -33.0171       33.0171       319.172       352.189    
  77  0.143667      -1.94025      -185.115       185.115       313.807       498.922    
  78  0.462723     -0.770628      -73.5237       73.5237       568.245       641.768    
  79  0.345279E-01  -3.36599      -321.141       321.141       431.818       752.959    
loop,thermsimp(1:2)       12   245.894       20.7579    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    100        501.43         87.30          1.13         40.20          0.92          0.05        129.60
Just calling func    0   0        129.60


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       2    501.43
 mycase(ii+1)=2: hstar-thermstar(myrank+1) > htherm(1) BUT  hstar-thermstar(myrank+1)<htherm(np1-myrank-1) i.e hstar<htherm(np1-1) or (np1-2) ... (np1-myrank-1) .. etc
 mycase(ii+1)=2: hstar > hmi but lower than htherm(myimax-1) 
 nonparal: hstar is not <hmin. but lower than some point, replace p(imax) with pstar and hmax with hstar
 nonparal: note that in nonparallel version it's different, it doesn't sort the objvalue array and it compares hstar to aNY point other than imax
  ---> do nothing and just return the reflection point pstar i.e. mycase(..)=2,mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar.
  ---> Note that this is the only case in which the processor does not do an extra function call


  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       12
neval is:       99
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       12      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       13
neval is:       99


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:       99     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.872435     -0.136467      -13.0199       13.0199       276.173       289.193    
   2  0.311340      -1.16687      -111.328       111.328       290.274       401.602    
   3  0.293828      -1.22476      -116.851       116.851       310.888       427.740    
   4  0.586668     -0.533296      -50.8805       50.8805       308.952       359.832    
   5  0.360311      -1.02079      -97.3909       97.3909       318.381       415.772    
   6  0.315643      -1.15314      -110.018       110.018       318.545       428.563    
   7  0.481464     -0.730923      -69.7356       69.7356       313.360       383.095    
   8  0.720279     -0.328116      -31.3048       31.3048       319.305       350.610    
   9  0.551471     -0.595166      -56.7833       56.7833       325.716       382.499    
  10  0.524434     -0.645435      -61.5794       61.5794       316.952       378.531    
  11  0.781600     -0.246412      -23.5096       23.5096       311.882       335.391    
  12  0.353648      -1.03945      -99.1716       99.1716       321.375       420.547    
  13  0.451044     -0.796190      -75.9626       75.9626       317.896       393.858    
  14  0.325353      -1.12284      -107.128       107.128       321.000       428.128    
  15  0.312157      -1.16425      -111.078       111.078       310.973       422.051    
  16  0.432418     -0.838362      -79.9861       79.9861       288.946       368.932    
  17  0.296543      -1.21556      -115.974       115.974       314.971       430.944    
  18  0.705416     -0.348967      -33.2941       33.2941       323.295       356.589    
  19  0.146505      -1.92069      -183.249       183.249       315.864       499.113    
  20  0.471608     -0.751607      -71.7090       71.7090       300.437       372.146    
  21  0.633095     -0.457134      -43.6141       43.6141       322.677       366.291    
  22  0.754855     -0.281230      -26.8315       26.8315       316.943       343.775    
  23  0.444501E-01  -3.11339      -297.041       297.041       325.264       622.304    
  24  0.160973      -1.82652      -174.264       174.264       272.208       446.471    
  25  0.943694     -0.579536E-01  -5.52921       5.52921       319.482       325.011    
  26  0.187304      -1.67502      -159.810       159.810       318.025       477.835    
  27  0.840922     -0.173257      -16.5300       16.5300       319.172       335.702    
  28  0.888648     -0.118054      -11.2632       11.2632       290.928       302.191    
  29  0.920614E-01  -2.38530      -227.576       227.576       329.961       557.537    
  30  0.906493     -0.981722E-01  -9.36637       9.36637       319.358       328.724    
  31  0.221761      -1.50616      -143.699       143.699       318.942       462.641    
  32  0.248725      -1.39141      -132.751       132.751       320.536       453.286    
  33  0.315928      -1.15224      -109.933       109.933       319.053       428.986    
  34  0.949967     -0.513283E-01  -4.89711       4.89711       318.671       323.568    
  35  0.802748     -0.219715      -20.9624       20.9624       317.931       338.894    
  36  0.558987     -0.581628      -55.4917       55.4917       319.594       375.086    
  37  0.638133     -0.449209      -42.8579       42.8579       332.461       375.319    
  38  0.637852     -0.449648      -42.8998       42.8998       344.821       387.721    
  39  0.382908     -0.959961      -91.5875       91.5875       317.094       408.681    
  40  0.982834     -0.173149E-01  -1.65198       1.65198       317.888       319.540    
  41  0.497022     -0.699120      -66.7013       66.7013       313.152       379.853    
  42  0.263620      -1.33325      -127.202       127.202       325.871       453.073    
  43  0.296939      -1.21423      -115.847       115.847       326.468       442.315    
  44  0.784161     -0.243141      -23.1975       23.1975       317.711       340.908    
  45  0.545321     -0.606380      -57.8532       57.8532       318.052       375.906    
  46  0.770080     -0.261260      -24.9262       24.9262       312.134       337.060    
  47  0.358755      -1.02511      -97.8037       97.8037       314.940       412.744    
  48  0.325126      -1.12354      -107.194       107.194       327.487       434.682    
  49  0.599396     -0.511832      -48.8327       48.8327       411.198       460.031    
  50  0.323708      -1.12791      -107.612       107.612       320.091       427.703    
  51  0.329142      -1.11127      -106.023       106.023       323.786       429.809    
  52  0.685661     -0.377371      -36.0041       36.0041       313.757       349.761    
  53  0.360361      -1.02065      -97.3775       97.3775       318.025       415.403    
  54  0.665281     -0.407545      -38.8829       38.8829       333.837       372.720    
  55  0.983321     -0.168196E-01  -1.60472       1.60472       315.543       317.148    
  56  0.644247     -0.439672      -41.9481       41.9481       317.736       359.684    
  57  0.735645     -0.307008      -29.2909       29.2909       414.704       443.995    
  58  0.680276     -0.385257      -36.7564       36.7564       318.025       354.782    
  59  0.864073     -0.146098      -13.9388       13.9388       312.764       326.703    
  60  0.788785     -0.237262      -22.6366       22.6366       354.393       377.030    
  61  0.429383     -0.845405      -80.6581       80.6581       322.405       403.063    
  62  0.798857     -0.224573      -21.4260       21.4260       320.591       342.017    
  63  0.946983     -0.544737E-01  -5.19720       5.19720       314.057       319.254    
  64  0.229664      -1.47114      -140.358       140.358       318.008       458.366    
  65  0.655912     -0.421729      -40.2361       40.2361       315.769       356.005    
  66  0.236982      -1.43977      -137.365       137.365       313.807       451.172    
  67  0.588628     -0.529960      -50.5622       50.5622       319.806       370.369    
  68  0.430113     -0.843707      -80.4960       80.4960       269.945       350.441    
  69  0.384455     -0.955929      -91.2028       91.2028       317.674       408.877    
  70  0.162044E-01  -4.12247      -393.315       393.315       319.716       713.031    
  71  0.769503     -0.262010      -24.9977       24.9977       332.752       357.750    
  72  0.220892      -1.51008      -144.073       144.073       558.181       702.254    
  73  0.978294E-01  -2.32453      -221.778       221.778       305.147       526.925    
  74  0.310072      -1.17095      -111.718       111.718       568.245       679.962    
  75  0.871728E-01  -2.43986      -232.781       232.781       317.923       550.705    
  76  0.750011     -0.287667      -27.4456       27.4456       361.180       388.625    
  77  0.638844     -0.448095      -42.7517       42.7517       317.507       360.259    
  78  0.620339     -0.477489      -45.5561       45.5561       469.164       514.720    
  79  0.634192     -0.455404      -43.4490       43.4490       501.425       544.874    
loop,thermsimp(1:2)       13   13.0199       111.328    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    101        294.01         87.31          1.12         40.18          0.85          0.05        129.50
Just calling func    0   0        129.50


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    102        335.66         87.44          1.11         39.92          1.05          0.05        129.57
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds

  100    294.01        1.724     -1.179      6.058     -102.6      2.615    
                     -0.1444      3.920     -99.70      4.019      1.015    
                       1.899     -1.260      1.458    -0.1830E+05 -2.467    
                      -1.189      0.000      0.000      0.000     -1.221    

                      -2.500     0.5093E+05 0.4050E+05 -3852.    -0.8539E+05
                      -2.046     -6.456     -4.380     -7.345      2.950    
                      -13.82     -2.968      2094.      0.000      3658.    

                       4514.      5976.      4439.      8250.      3018.    
                       2901.     0.6808E-01-0.4650E-01  0.000    -0.4901    
                     -0.1031    -0.1582    -0.6232E-01-0.1921    -0.2416E-01

                      -1.495    -0.8069E-01  0.000    -0.2370E-01-0.9409E-02
                      0.8541E-01 0.3681E-01-0.2456E-01-0.3502    -0.1492    
                     -0.4443E-01-0.6736E-01-0.9812E-01-0.3605      0.000    

                      -1.916     -1.608     0.9700     0.9669    -0.8777E-01
                      0.3307E-01  9.215      9.134    -0.1017E+05 -2.066    
                     -0.5457    -0.7148      9.408      8.558    -0.1000E+05

                      -1.858     0.1019    -0.4873      8.763      9.038    
                     -0.1000E+05 -2.066    -0.6573    -0.2042      10.13    
                       8.451    -0.1000E+05 -2.066    
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    294.01
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       13
neval is:      101
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       13      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       14
neval is:      101


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      101     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.344597      -1.06538      -101.645       101.645       276.173       377.818    
   2  0.267720      -1.31781      -125.729       125.729       290.928       416.657    
   3  0.279825      -1.27359      -121.510       121.510       315.543       437.054    
   4  0.281095      -1.26906      -121.078       121.078       314.057       435.135    
   5  0.245867      -1.40297      -133.854       133.854       317.888       451.741    
   6  0.914239     -0.896636E-01  -8.55458       8.55458       318.671       327.225    
   7  0.180116      -1.71415      -163.543       163.543       319.482       483.025    
   8  0.567917     -0.565780      -53.9797       53.9797       312.764       366.744    
   9  0.431941     -0.839465      -80.0913       80.0913       319.358       399.449    
  10  0.877920     -0.130199      -12.4220       12.4220       311.882       324.304    
  11  0.280355      -1.27170      -121.330       121.330       319.172       440.502    
  12  0.486947     -0.719601      -68.6553       68.6553       312.134       380.789    
  13  0.216546      -1.52995      -145.969       145.969       317.931       463.900    
  14  0.483718E-02  -5.33142      -508.658       508.658       317.711       826.369    
  15  0.785152E-03  -7.14963      -682.129       682.129       320.591       1002.72    
  16  0.300781      -1.20137      -114.620       114.620       316.943       431.563    
  17  0.869691     -0.139618      -13.3206       13.3206       313.757       327.078    
  18  0.694261E-01  -2.66749      -254.499       254.499       269.945       524.444    
  19  0.635475     -0.453382      -43.2561       43.2561       319.305       362.561    
  20  0.894977     -0.110958      -10.5862       10.5862       318.025       328.611    
  21  0.442267     -0.815841      -77.8374       77.8374       315.769       393.607    
  22  0.283362      -1.26103      -120.312       120.312       323.295       443.606    
  23  0.518611     -0.656601      -62.6447       62.6447       332.752       395.397    
  24  0.858122E-01  -2.45559      -234.282       234.282       317.736       552.018    
  25  0.461153     -0.774026      -73.8480       73.8480       308.952       382.800    
  26  0.180026      -1.71465      -163.591       163.591       317.507       481.098    
  27  0.446938E-01  -3.10792      -296.519       296.519       322.677       619.196    
  28  0.152352      -1.88156      -179.515       179.515       288.946       468.461    
  29  0.163937E-01  -4.11086      -392.207       392.207       319.806       712.013    
  30  0.721347     -0.326635      -31.1635       31.1635       300.437       331.600    
  31  0.813323     -0.206626      -19.7137       19.7137       333.837       353.551    
  32  0.569343     -0.563273      -53.7405       53.7405       319.594       373.334    
  33  0.275899      -1.28772      -122.858       122.858       332.461       455.319    
  34  0.933187     -0.691492E-01  -6.59736       6.59736       318.052       324.650    
  35  0.716570     -0.333279      -31.7973       31.7973       354.393       386.191    
  36  0.405413     -0.902848      -86.1385       86.1385       316.952       403.090    
  37  0.907528     -0.970314E-01  -9.25753       9.25753       313.152       322.410    
  38  0.554651     -0.589416      -56.2347       56.2347       325.716       381.951    
  39  0.419962     -0.867592      -82.7748       82.7748       313.360       396.135    
  40  0.824173     -0.193375      -18.4494       18.4494       344.821       363.270    
  41  0.865647     -0.144278      -13.7653       13.7653       361.180       374.945    
  42  0.300944      -1.20083      -114.568       114.568       317.896       432.464    
  43  0.339688      -1.07973      -103.014       103.014       290.274       393.288    
  44  0.217032      -1.52771      -145.755       145.755       322.405       468.161    
  45  0.792618E-01  -2.53500      -241.858       241.858       317.094       558.952    
  46  0.997677     -0.232582E-02 -0.221901      0.221901       317.674       317.896    
  47  0.174239      -1.74733      -166.708       166.708       314.940       481.648    
  48  0.834084     -0.181422      -17.3090       17.3090       318.025       335.334    
  49  0.324404      -1.12577      -107.407       107.407       318.381       425.788    
  50  0.927598     -0.751564E-01  -7.17049       7.17049       321.375       328.546    
  51  0.981384     -0.187911E-01  -1.79282       1.79282       310.973       312.766    
  52  0.849105     -0.163572      -15.6060       15.6060       320.091       335.697    
  53  0.148698      -1.90584      -181.832       181.832       310.888       492.720    
  54  0.389930     -0.941789      -89.8538       89.8538       321.000       410.854    
  55  0.183568      -1.69517      -161.732       161.732       318.545       480.277    
  56  0.661220     -0.413669      -39.4671       39.4671       319.053       358.520    
  57  0.242183      -1.41806      -135.294       135.294       323.786       459.080    
  58  0.182262      -1.70231      -162.413       162.413       314.971       477.384    
  59  0.299801      -1.20464      -114.931       114.931       327.487       442.419    
  60  0.950117     -0.511698E-01  -4.88198       4.88198       326.468       331.350    
  61  0.184593      -1.68960      -161.201       161.201       414.704       575.905    
  62  0.730970     -0.313382      -29.8990       29.8990       272.208       302.107    
  63  0.753232E-01  -2.58597      -246.721       246.721       313.807       560.528    
  64  0.501460     -0.690231      -65.8532       65.8532       325.871       391.724    
  65  0.513248E-01  -2.96958      -283.320       283.320       320.536       603.856    
  66  0.931416     -0.710492E-01  -6.77863       6.77863       318.008       324.787    
  67  0.637420E-01  -2.75291      -262.649       262.649       411.198       673.847    
  68  0.322234E-01  -3.43506      -327.731       327.731       318.942       646.673    
  69  0.791156     -0.234260      -22.3502       22.3502       318.025       340.375    
  70  0.606746     -0.499645      -47.6699       47.6699       315.864       363.534    
  71  0.115774      -2.15611      -205.710       205.710       469.164       674.873    
  72  0.574132     -0.554896      -52.9413       52.9413       305.147       358.088    
  73  0.877193     -0.131028      -12.5011       12.5011       501.425       513.926    
  74  0.113746      -2.17379      -207.396       207.396       317.923       525.320    
  75  0.259994E-01  -3.64968      -348.207       348.207       329.961       678.169    
  76  0.213303      -1.54504      -147.409       147.409       325.264       472.672    
  77  0.444263E-01  -3.11392      -297.092       297.092       568.245       865.336    
  78  0.833204     -0.182477      -17.4097       17.4097       558.181       575.591    
  79  0.882578     -0.124908      -11.9172       11.9172       294.012       305.929    
loop,thermsimp(1:2)       14   101.645       125.729    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    103        282.49         87.28          1.11         39.57          1.48          0.05        129.49
Just calling func    0   0        129.49


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    104        278.83         87.45          1.16         40.28          0.68          0.05        129.61
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    278.83
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       14
neval is:      103
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       14      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       15
neval is:      103


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      103     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.229949      -1.46990      -140.239       140.239       272.208       412.447    
   2  0.322822      -1.13066      -107.873       107.873       294.012       401.885    
   3  0.327586      -1.11601      -106.475       106.475       310.973       417.448    
   4  0.799078     -0.224296      -21.3996       21.3996       317.674       339.074    
   5  0.698072     -0.359433      -34.2926       34.2926       313.152       347.445    
   6  0.733871     -0.309421      -29.5211       29.5211       311.882       341.403    
   7  0.823872     -0.193740      -18.4843       18.4843       318.052       336.537    
   8  0.800045     -0.223087      -21.2842       21.2842       318.008       339.293    
   9  0.162010      -1.82010      -173.651       173.651       313.757       487.408    
  10  0.113138      -2.17915      -207.907       207.907       318.671       526.578    
  11  0.973966     -0.263784E-01  -2.51670       2.51670       321.375       323.892    
  12  0.998107     -0.189521E-02 -0.180817      0.180817       318.025       318.206    
  13  0.631351     -0.459893      -43.8773       43.8773       326.468       370.346    
  14  0.698229     -0.359208      -34.2712       34.2712       300.437       334.708    
  15  0.359252      -1.02373      -97.6716       97.6716       318.025       415.697    
  16  0.936266     -0.658562E-01  -6.28317       6.28317       320.091       326.374    
  17  0.843107     -0.170662      -16.2824       16.2824       318.025       334.308    
  18  0.181284      -1.70769      -162.927       162.927       333.837       496.764    
  19  0.354246      -1.03777      -99.0106       99.0106       305.147       404.157    
  20  0.981540     -0.186324E-01  -1.77767       1.77767       319.053       320.831    
  21  0.582284E-01  -2.84338      -271.280       271.280       319.305       590.585    
  22  0.935088     -0.671143E-01  -6.40321       6.40321       344.821       351.224    
  23  0.682144     -0.382515      -36.4948       36.4948       315.864       352.359    
  24  0.441439     -0.817715      -78.0162       78.0162       312.764       390.780    
  25  0.325829      -1.12138      -106.988       106.988       319.594       426.582    
  26  0.956968E-01  -2.34657      -223.881       223.881       361.180       585.060    
  27  0.465124E-01  -3.06804      -292.714       292.714       276.173       568.887    
  28  0.645503     -0.437726      -41.7624       41.7624       312.134       353.896    
  29  0.184751      -1.68875      -161.119       161.119       325.716       486.835    
  30  0.676303     -0.391115      -37.3153       37.3153       308.952       346.267    
  31  0.408248     -0.895880      -85.4738       85.4738       354.393       439.867    
  32  0.215511      -1.53474      -146.426       146.426       325.871       472.297    
  33  0.762109     -0.271666      -25.9190       25.9190       290.274       316.193    
  34  0.445022     -0.809632      -77.2450       77.2450       315.769       393.014    
  35  0.667113     -0.404797      -38.6206       38.6206       332.752       371.373    
  36  0.995785     -0.422376E-02 -0.402979      0.402979       313.360       313.763    
  37  0.278840      -1.27712      -121.847       121.847       319.358       441.205    
  38  0.624255     -0.471196      -44.9557       44.9557       316.952       361.907    
  39  0.368212     -0.999097      -95.3214       95.3214       321.000       416.322    
  40  0.330266      -1.10786      -105.698       105.698       290.928       396.626    
  41  0.969155     -0.313304E-01  -2.98916       2.98916       318.381       321.370    
  42  0.686816     -0.375688      -35.8435       35.8435       316.943       352.787    
  43  0.201053      -1.60419      -153.051       153.051       317.896       470.947    
  44  0.481166     -0.731544      -69.7948       69.7948       314.057       383.852    
  45  0.992829     -0.719725E-02 -0.686672      0.686672       315.543       316.230    
  46  0.665697     -0.406921      -38.8233       38.8233       319.172       357.996    
  47  0.991934E-02  -4.61327      -440.141       440.141       327.487       767.628    
  48  0.211644      -1.55285      -148.154       148.154       323.295       471.448    
  49  0.908243E-01  -2.39883      -228.866       228.866       317.888       546.754    
  50  0.643762     -0.440426      -42.0200       42.0200       332.461       374.481    
  51  0.568794E-01  -2.86682      -273.516       273.516       323.786       597.303    
  52  0.159466      -1.83592      -175.161       175.161       317.931       493.092    
  53  0.918851     -0.846310E-01  -8.07443       8.07443       322.405       330.480    
  54  0.865178     -0.144820      -13.8169       13.8169       288.946       302.763    
  55  0.826009     -0.191150      -18.2372       18.2372       325.264       343.501    
  56  0.665816E-02  -5.01191      -478.174       478.174       314.971       793.145    
  57  0.998155     -0.184716E-02 -0.176233      0.176233       318.545       318.721    
  58  0.875957E-01  -2.43502      -232.320       232.320       317.507       549.827    
  59  0.546955     -0.603388      -57.5678       57.5678       314.940       372.508    
  60  0.953933     -0.471617E-01  -4.49959       4.49959       319.482       323.981    
  61  0.131488      -2.02884      -193.567       193.567       310.888       504.455    
  62  0.415197     -0.879003      -83.8635       83.8635       501.425       585.289    
  63  0.543800E-02  -5.21434      -497.488       497.488       269.945       767.433    
  64  0.821907     -0.196128      -18.7121       18.7121       317.923       336.636    
  65  0.590302     -0.527122      -50.2914       50.2914       317.736       368.028    
  66  0.380117     -0.967276      -92.2855       92.2855       317.094       409.379    
  67  0.640684     -0.445218      -42.4772       42.4772       313.807       356.284    
  68  0.268290      -1.31569      -125.526       125.526       558.181       683.708    
  69  0.625870     -0.468612      -44.7091       44.7091       414.704       459.413    
  70  0.937362     -0.646862E-01  -6.17156       6.17156       320.536       326.707    
  71  0.246375      -1.40090      -133.656       133.656       322.677       456.333    
  72  0.163534      -1.81073      -172.758       172.758       318.942       491.699    
  73  0.231078      -1.46500      -139.772       139.772       411.198       550.970    
  74  0.812335     -0.207842      -19.8297       19.8297       469.164       488.993    
  75  0.955269     -0.457625E-01  -4.36609       4.36609       329.961       334.328    
  76  0.126538      -2.06721      -197.228       197.228       319.806       517.034    
  77  0.273907      -1.29497      -123.550       123.550       317.711       441.260    
  78  0.583291     -0.539069      -51.4312       51.4312       568.245       619.676    
  79  0.186464      -1.67951      -160.238       160.238       278.834       439.072    
loop,thermsimp(1:2)       15   140.239       107.873    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    105        284.32         87.34          1.11         39.73          1.31          0.05        129.54
Just calling func    0   0        129.54


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    106        328.85         87.68          1.15         40.07          0.59          0.05        129.53
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    284.32
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       15
neval is:      105
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       15      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       16
neval is:      105


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      105     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.557805     -0.583747      -55.6938       55.6938       288.946       344.639    
   2  0.850944     -0.161409      -15.3996       15.3996       313.360       328.759    
   3  0.343999      -1.06712      -101.811       101.811       290.274       392.085    
   4  0.481777E-02  -5.33544      -509.042       509.042       315.543       824.585    
   5  0.146991      -1.91738      -182.933       182.933       318.025       500.958    
   6  0.545677     -0.605728      -57.7910       57.7910       318.545       376.336    
   7  0.761940     -0.271888      -25.9402       25.9402       319.053       344.993    
   8  0.944477     -0.571238E-01  -5.45004       5.45004       318.381       323.831    
   9  0.965249     -0.353688E-01  -3.37445       3.37445       321.375       324.749    
  10  0.634176     -0.455429      -43.4514       43.4514       319.482       362.933    
  11  0.793205     -0.231673      -22.1034       22.1034       320.091       342.194    
  12  0.743605     -0.296246      -28.2641       28.2641       320.536       348.800    
  13  0.983069E-01  -2.31966      -221.313       221.313       322.405       543.718    
  14  0.618437     -0.480560      -45.8490       45.8490       318.025       363.874    
  15  0.429182     -0.845875      -80.7028       80.7028       329.961       410.664    
  16  0.771528     -0.259382      -24.7470       24.7470       300.437       325.184    
  17  0.218286      -1.52195      -145.205       145.205       318.052       463.258    
  18  0.556408     -0.586254      -55.9330       55.9330       317.923       373.857    
  19  0.526292     -0.641899      -61.2421       61.2421       317.674       378.916    
  20  0.665532     -0.407169      -38.8470       38.8470       318.008       356.855    
  21  0.261756      -1.34034      -127.879       127.879       311.882       439.761    
  22  0.975508     -0.247971E-01  -2.36583       2.36583       325.264       327.630    
  23  0.257613      -1.35630      -129.401       129.401       308.952       438.353    
  24  0.981555E-01  -2.32120      -221.460       221.460       313.152       534.612    
  25  0.955054     -0.459870E-01  -4.38751       4.38751       344.821       349.208    
  26  0.887906     -0.118890      -11.3430       11.3430       315.864       327.207    
  27  0.407043     -0.898837      -85.7558       85.7558       316.943       402.699    
  28  0.876870     -0.131396      -12.5362       12.5362       312.134       324.670    
  29  0.957152     -0.437935E-01  -4.17823       4.17823       313.807       317.985    
  30  0.827730     -0.189068      -18.0385       18.0385       319.172       337.211    
  31  0.289027      -1.24124      -118.423       118.423       316.952       435.375    
  32  0.125230      -2.07760      -198.219       198.219       317.736       515.955    
  33  0.242443      -1.41699      -135.191       135.191       326.468       461.660    
  34  0.654103     -0.424490      -40.4996       40.4996       332.752       373.252    
  35  0.811871     -0.208414      -19.8842       19.8842       314.940       334.824    
  36  0.145201E-01  -4.23222      -403.786       403.786       332.461       736.247    
  37  0.344449      -1.06581      -101.686       101.686       314.057       415.743    
  38  0.265532      -1.32602      -126.512       126.512       312.764       439.276    
  39  0.811851     -0.208438      -19.8866       19.8866       315.769       335.656    
  40  0.983290E-01  -2.31944      -221.292       221.292       290.928       512.219    
  41  0.347314      -1.05753      -100.896       100.896       294.012       394.908    
  42  0.923773     -0.792888E-01  -7.56475       7.56475       305.147       312.712    
  43  0.690375     -0.370520      -35.3504       35.3504       317.094       352.444    
  44  0.227523      -1.48051      -141.251       141.251       272.208       413.459    
  45  0.652275     -0.427289      -40.7666       40.7666       318.025       358.792    
  46  0.669640     -0.401014      -38.2598       38.2598       321.000       359.260    
  47  0.288804      -1.24201      -118.497       118.497       310.973       429.470    
  48  0.404648     -0.904738      -86.3188       86.3188       319.594       405.913    
  49  0.371042     -0.991440      -94.5908       94.5908       278.834       373.424    
  50  0.308424      -1.17628      -112.226       112.226       354.393       466.619    
  51  0.911221     -0.929703E-01  -8.87007       8.87007       319.358       328.228    
  52  0.615436     -0.485425      -46.3132       46.3132       317.711       364.024    
  53  0.780328     -0.248041      -23.6649       23.6649       322.677       346.341    
  54  0.127539      -2.05933      -196.476       196.476       414.704       611.180    
  55  0.709081     -0.343786      -32.7998       32.7998       317.896       350.696    
  56  0.974925     -0.253942E-01  -2.42280       2.42280       323.295       325.717    
  57  0.834943     -0.180392      -17.2107       17.2107       325.871       343.082    
  58  0.696274     -0.362013      -34.5387       34.5387       325.716       360.255    
  59  0.623965     -0.471660      -45.0000       45.0000       313.757       358.757    
  60  0.620467     -0.477282      -45.5363       45.5363       469.164       514.700    
  61  0.983840E-01  -2.31888      -221.238       221.238       318.942       540.180    
  62  0.452904     -0.792074      -75.5699       75.5699       317.931       393.501    
  63  0.731276     -0.312965      -29.8592       29.8592       333.837       363.696    
  64  0.136630      -1.99048      -189.906       189.906       310.888       500.795    
  65  0.819737     -0.198772      -18.9643       18.9643       319.806       338.771    
  66  0.415452     -0.878387      -83.8048       83.8048       318.671       402.475    
  67  0.931580     -0.708731E-01  -6.76183       6.76183       317.888       324.649    
  68  0.763119     -0.270341      -25.7926       25.7926       317.507       343.300    
  69  0.214680      -1.53861      -146.795       146.795       411.198       557.993    
  70  0.548736     -0.600138      -57.2577       57.2577       276.173       333.431    
  71  0.981486     -0.186872E-01  -1.78290       1.78290       361.180       362.962    
  72  0.475333     -0.743740      -70.9584       70.9584       501.425       572.384    
  73  0.484810     -0.723998      -69.0749       69.0749       319.305       388.380    
  74  0.433802     -0.835166      -79.6812       79.6812       323.786       403.467    
  75  0.642789     -0.441939      -42.1643       42.1643       568.245       610.409    
  76  0.255584      -1.36420      -130.155       130.155       558.181       688.337    
  77  0.190283      -1.65924      -158.304       158.304       269.945       428.249    
  78  0.255288      -1.36536      -130.266       130.266       327.487       457.753    
  79  0.992726     -0.730106E-02 -0.696576      0.696576       284.323       285.020    
loop,thermsimp(1:2)       16   55.6938       15.3996    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    107        291.06         87.34          1.12         40.11          1.00          0.05        129.62
Just calling func    0   0        129.63


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    108        475.00         87.28          1.14         39.98          1.05          0.05        129.50
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    291.06
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       16
neval is:      107
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       16      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       17
neval is:      107


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      107     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.739792     -0.301387      -28.7546       28.7546       284.323       313.078    
   2  0.527958     -0.638738      -60.9404       60.9404       305.147       366.087    
   3  0.326119      -1.12049      -106.903       106.903       313.807       420.710    
   4  0.647061     -0.435314      -41.5323       41.5323       318.381       359.913    
   5  0.419805     -0.867966      -82.8105       82.8105       317.888       400.698    
   6  0.218417      -1.52135      -145.148       145.148       312.134       457.282    
   7  0.168864      -1.77866      -169.698       169.698       321.375       491.073    
   8  0.761417     -0.272575      -26.0057       26.0057       300.437       326.442    
   9  0.383989     -0.957143      -91.3186       91.3186       323.295       414.613    
  10  0.104774      -2.25595      -215.235       215.235       315.864       531.099    
  11  0.167912      -1.78432      -170.237       170.237       325.264       495.501    
  12  0.997930     -0.207190E-02 -0.197675      0.197675       319.358       319.556    
  13  0.493294     -0.706650      -67.4198       67.4198       313.360       380.780    
  14  0.483048     -0.727639      -69.4223       69.4223       276.173       345.595    
  15  0.715967     -0.334121      -31.8777       31.8777       314.940       346.818    
  16  0.595423E-01  -2.82107      -269.151       269.151       315.769       584.920    
  17  0.636569     -0.451662      -43.0919       43.0919       319.172       362.264    
  18  0.482980     -0.727779      -69.4356       69.4356       319.806       389.242    
  19  0.500121     -0.692905      -66.1084       66.1084       320.091       386.199    
  20  0.426980     -0.851018      -81.1935       81.1935       325.871       407.065    
  21  0.546576     -0.604082      -57.6340       57.6340       317.507       375.141    
  22  0.142720      -1.94687      -185.746       185.746       288.946       474.692    
  23  0.473622     -0.747346      -71.3024       71.3024       319.053       390.355    
  24  0.892718E-01  -2.41607      -230.511       230.511       322.677       553.188    
  25  0.660659     -0.414518      -39.5481       39.5481       320.536       360.084    
  26  0.328755      -1.11244      -106.136       106.136       344.821       450.956    
  27  0.544150     -0.608530      -58.0584       58.0584       317.896       375.954    
  28  0.199068      -1.61411      -153.998       153.998       317.094       471.092    
  29  0.685070     -0.378234      -36.0864       36.0864       318.008       354.095    
  30  0.500258     -0.692632      -66.0823       66.0823       313.757       379.840    
  31  0.130607      -2.03556      -194.208       194.208       318.025       512.233    
  32  0.982013E-01  -2.32074      -221.416       221.416       321.000       542.416    
  33  0.581494E-01  -2.84474      -271.410       271.410       325.716       597.125    
  34  0.841391     -0.172699      -16.4768       16.4768       319.482       335.958    
  35  0.838937E-01  -2.47820      -236.439       236.439       361.180       597.619    
  36  0.729848     -0.314919      -30.0457       30.0457       333.837       363.883    
  37  0.748292     -0.289962      -27.6646       27.6646       318.025       345.690    
  38  0.229216      -1.47309      -140.544       140.544       317.711       458.254    
  39  0.710713     -0.341487      -32.5804       32.5804       332.752       365.333    
  40  0.511506     -0.670395      -63.9608       63.9608       278.834       342.794    
  41  0.106756      -2.23721      -213.446       213.446       317.923       531.370    
  42  0.583466     -0.538770      -51.4027       51.4027       318.545       369.947    
  43  0.993140E-01  -2.30947      -220.341       220.341       317.674       538.015    
  44  0.461224     -0.773871      -73.8331       73.8331       319.305       393.138    
  45  0.574465     -0.554316      -52.8859       52.8859       290.274       343.160    
  46  0.715977     -0.334107      -31.8764       31.8764       317.931       349.808    
  47  0.877584     -0.130583      -12.4586       12.4586       294.012       306.471    
  48  0.492354     -0.708558      -67.6018       67.6018       318.671       386.272    
  49  0.874926     -0.133616      -12.7480       12.7480       316.943       329.691    
  50  0.800367     -0.222685      -21.2458       21.2458       323.786       345.032    
  51  0.507308     -0.678636      -64.7470       64.7470       319.594       384.341    
  52  0.727831     -0.317686      -30.3096       30.3096       329.961       360.271    
  53  0.899777E-01  -2.40819      -229.760       229.760       272.208       501.968    
  54  0.392780     -0.934505      -89.1589       89.1589       314.057       403.216    
  55  0.585301     -0.535629      -51.1030       51.1030       269.945       321.048    
  56  0.522884     -0.648395      -61.8618       61.8618       310.973       372.835    
  57  0.559213     -0.581225      -55.4532       55.4532       316.952       372.405    
  58  0.116989      -2.14568      -204.714       204.714       308.952       513.666    
  59  0.411020     -0.889113      -84.8281       84.8281       312.764       397.592    
  60  0.484202     -0.725253      -69.1946       69.1946       311.882       381.076    
  61  0.771761     -0.259080      -24.7182       24.7182       327.487       352.205    
  62  0.908486     -0.959755E-01  -9.15678       9.15678       326.468       335.625    
  63  0.340814      -1.07642      -102.698       102.698       318.052       420.751    
  64  0.519873     -0.654172      -62.4129       62.4129       354.393       416.806    
  65  0.516320     -0.661029      -63.0672       63.0672       310.888       373.955    
  66  0.495555     -0.702076      -66.9834       66.9834       318.025       385.009    
  67  0.291626      -1.23228      -117.569       117.569       290.928       408.497    
  68  0.492590     -0.708077      -67.5559       67.5559       469.164       536.720    
  69  0.545663E-01  -2.90834      -277.478       277.478       317.736       595.214    
  70  0.200869      -1.60510      -153.139       153.139       313.152       466.291    
  71  0.434763     -0.832954      -79.4701       79.4701       318.942       398.412    
  72  0.241886E-01  -3.72187      -355.095       355.095       322.405       677.500    
  73  0.846355     -0.166816      -15.9155       15.9155       411.198       427.114    
  74  0.598037     -0.514102      -49.0492       49.0492       501.425       550.474    
  75  0.780316     -0.248056      -23.6664       23.6664       568.245       591.911    
  76  0.242603      -1.41633      -135.129       135.129       414.704       549.833    
  77  0.483498     -0.726708      -69.3334       69.3334       558.181       627.515    
  78  0.719876     -0.328676      -31.3581       31.3581       332.461       363.819    
  79  0.223210      -1.49964      -143.077       143.077       291.059       434.136    
loop,thermsimp(1:2)       17   28.7546       60.9404    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    109        278.57         87.48          1.12         39.97          1.20          0.05        129.82
Just calling func    0   0        129.82


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    110        340.14         87.34          1.12         40.12          0.89          0.05        129.54
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    278.57
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       17
neval is:      109
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       17      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       18
neval is:      109


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      109     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.382860     -0.960086      -91.5994       91.5994       294.012       385.611    
   2  0.293468      -1.22599      -116.969       116.969       284.323       401.292    
   3  0.954036     -0.470539E-01  -4.48929       4.48929       319.358       323.847    
   4  0.452934     -0.792010      -75.5637       75.5637       269.945       345.509    
   5  0.251692      -1.37955      -131.619       131.619       300.437       432.056    
   6  0.881081     -0.126605      -12.0791       12.0791       316.943       329.022    
   7  0.855311     -0.156290      -14.9112       14.9112       326.468       341.380    
   8  0.576474     -0.550824      -52.5528       52.5528       319.482       372.034    
   9  0.433835     -0.835090      -79.6739       79.6739       278.834       358.508    
  10  0.298626      -1.20856      -115.306       115.306       290.274       405.580    
  11  0.269991      -1.30937      -124.923       124.923       323.786       448.710    
  12  0.884826     -0.122364      -11.6745       11.6745       276.173       287.847    
  13  0.664124     -0.409287      -39.0490       39.0490       318.025       357.074    
  14  0.580836     -0.543287      -51.8337       51.8337       314.940       366.774    
  15  0.285501      -1.25351      -119.594       119.594       317.931       437.526    
  16  0.690757     -0.369967      -35.2977       35.2977       327.487       362.785    
  17  0.578320     -0.547628      -52.2479       52.2479       318.008       370.256    
  18  0.563230     -0.574067      -54.7703       54.7703       318.381       373.151    
  19  0.681565     -0.383363      -36.5758       36.5758       320.536       357.111    
  20  0.453362     -0.791065      -75.4735       75.4735       329.961       405.435    
  21  0.645457     -0.437797      -41.7692       41.7692       319.172       360.942    
  22  0.982222E-01  -2.32052      -221.395       221.395       332.461       553.857    
  23  0.843064     -0.170712      -16.2873       16.2873       333.837       350.124    
  24  0.505683     -0.681845      -65.0532       65.0532       332.752       397.805    
  25  0.350376      -1.04875      -100.059       100.059       305.147       405.205    
  26  0.367167      -1.00194      -95.5926       95.5926       318.545       414.137    
  27  0.268175      -1.31611      -125.567       125.567       316.952       442.519    
  28  0.989085E-01  -2.31356      -220.731       220.731       310.973       531.704    
  29  0.349392      -1.05156      -100.327       100.327       310.888       411.215    
  30  0.945468     -0.560755E-01  -5.35002       5.35002       317.507       322.857    
  31  0.305400      -1.18613      -113.166       113.166       317.896       431.062    
  32  0.942706     -0.590006E-01  -5.62911       5.62911       313.757       319.386    
  33  0.778346     -0.250584      -23.9076       23.9076       313.360       337.267    
  34  0.256449      -1.36083      -129.833       129.833       311.882       441.715    
  35  0.338120      -1.08436      -103.456       103.456       319.594       423.050    
  36  0.644609     -0.439112      -41.8946       41.8946       318.025       359.920    
  37  0.420837     -0.865509      -82.5761       82.5761       320.091       402.667    
  38  0.793406     -0.231421      -22.0793       22.0793       318.671       340.750    
  39  0.685561     -0.377517      -36.0180       36.0180       319.806       355.824    
  40  0.278740      -1.27748      -121.881       121.881       319.053       440.934    
  41  0.414078     -0.881700      -84.1209       84.1209       319.305       403.426    
  42  0.999720     -0.280334E-03 -0.267460E-01  0.267460E-01   312.764       312.791    
  43  0.714259     -0.336509      -32.1055       32.1055       318.942       351.047    
  44  0.713371     -0.337753      -32.2242       32.2242       317.888       350.112    
  45  0.451360     -0.795490      -75.8958       75.8958       314.057       389.953    
  46  0.887280     -0.119595      -11.4103       11.4103       325.871       337.281    
  47  0.234319      -1.45107      -138.443       138.443       290.928       429.371    
  48  0.277567E-01  -3.58428      -341.967       341.967       323.295       665.262    
  49  0.582411     -0.540579      -51.5753       51.5753       354.393       405.969    
  50  0.969019     -0.314707E-01  -3.00254       3.00254       313.807       316.810    
  51  0.441889     -0.816696      -77.9189       77.9189       318.052       395.971    
  52  0.150247      -1.89548      -180.843       180.843       411.198       592.041    
  53  0.901555E-01  -2.40622      -229.572       229.572       291.059       520.630    
  54  0.274120      -1.29419      -123.476       123.476       344.821       468.296    
  55  0.166801      -1.79095      -170.870       170.870       312.134       483.004    
  56  0.783053     -0.244555      -23.3324       23.3324       317.711       341.043    
  57  0.541655     -0.613126      -58.4968       58.4968       313.152       371.649    
  58  0.113786      -2.17344      -207.362       207.362       317.094       524.456    
  59  0.794080     -0.230571      -21.9982       21.9982       288.946       310.944    
  60  0.266758      -1.32141      -126.073       126.073       321.375       447.448    
  61  0.637690     -0.449903      -42.9241       42.9241       325.264       368.188    
  62  0.912681     -0.913685E-01  -8.71724       8.71724       272.208       280.925    
  63  0.303728      -1.19162      -113.690       113.690       318.025       431.715    
  64  0.318303      -1.14475      -109.218       109.218       308.952       418.170    
  65  0.255833      -1.36323      -130.062       130.062       315.864       445.927    
  66  0.988998     -0.110626E-01  -1.05546       1.05546       317.923       318.979    
  67  0.335641      -1.09171      -104.158       104.158       469.164       573.321    
  68  0.575346     -0.552784      -52.7398       52.7398       317.674       370.414    
  69  0.439298E-01  -3.12516      -298.164       298.164       321.000       619.164    
  70  0.179935      -1.71516      -163.639       163.639       414.704       578.343    
  71  0.939813     -0.620740E-01  -5.92232       5.92232       501.425       507.347    
  72  0.787717     -0.238616      -22.7657       22.7657       322.677       345.442    
  73  0.622521     -0.473978      -45.2210       45.2210       315.769       360.990    
  74  0.544172     -0.608491      -58.0546       58.0546       568.245       626.299    
  75  0.688511     -0.373223      -35.6083       35.6083       317.736       353.344    
  76  0.771411     -0.259534      -24.7615       24.7615       325.716       350.477    
  77  0.814829     -0.204777      -19.5373       19.5373       361.180       380.717    
  78  0.726465     -0.319564      -30.4889       30.4889       558.181       588.670    
  79  0.484661     -0.724306      -69.1043       69.1043       278.568       347.672    
loop,thermsimp(1:2)       18   91.5994       116.969    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    111        282.96         87.32          1.15         40.07          1.01          0.05        129.59
Just calling func    0   0        129.59


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    112        289.41         87.41          1.18         39.94          1.03          0.05        129.61
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    282.96
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       18
neval is:      111
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       18      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       19
neval is:      111


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      111     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.352992      -1.04131      -99.3488       99.3488       272.208       371.557    
   2  0.270835E-01  -3.60883      -344.310       344.310       276.173       620.483    
   3  0.923755     -0.793087E-01  -7.56665       7.56665       288.946       296.512    
   4  0.535520     -0.624517      -59.5836       59.5836       312.764       372.348    
   5  0.629344     -0.463078      -44.1811       44.1811       313.807       357.988    
   6  0.572648E-01  -2.86007      -272.872       272.872       317.923       590.796    
   7  0.353113E-01  -3.34355      -319.000       319.000       313.757       632.758    
   8  0.580838     -0.543283      -51.8333       51.8333       317.507       369.341    
   9  0.370403     -0.993164      -94.7553       94.7553       319.358       414.113    
  10  0.443010     -0.814162      -77.6772       77.6772       316.943       394.620    
  11  0.188704      -1.66757      -159.099       159.099       313.360       472.459    
  12  0.177608      -1.72818      -164.881       164.881       325.871       490.752    
  13  0.694998     -0.363847      -34.7137       34.7137       318.671       353.384    
  14  0.160742      -1.82796      -174.401       174.401       317.711       492.111    
  15  0.290050      -1.23770      -118.086       118.086       326.468       444.554    
  16  0.441138E-01  -3.12098      -297.765       297.765       322.677       620.442    
  17  0.372461     -0.987622      -94.2266       94.2266       269.945       364.172    
  18  0.652779     -0.426517      -40.6929       40.6929       278.568       319.261    
  19  0.998108     -0.189387E-02 -0.180690      0.180690       317.888       318.068    
  20  0.741140     -0.299566      -28.5809       28.5809       333.837       362.418    
  21  0.623042     -0.473141      -45.1413       45.1413       325.716       370.857    
  22  0.504617     -0.683955      -65.2545       65.2545       318.942       384.196    
  23  0.872499     -0.136394      -13.0130       13.0130       317.736       330.749    
  24  0.142620      -1.94757      -185.813       185.813       319.806       505.619    
  25  0.580285     -0.544236      -51.9242       51.9242       318.025       369.949    
  26  0.860063E-01  -2.45334      -234.067       234.067       320.536       554.602    
  27  0.401846     -0.911687      -86.9818       86.9818       278.834       365.815    
  28  0.161242      -1.82485      -174.105       174.105       318.025       492.130    
  29  0.550753     -0.596469      -56.9077       56.9077       319.172       376.080    
  30  0.815012     -0.204553      -19.5159       19.5159       315.769       335.285    
  31  0.438663     -0.824024      -78.6181       78.6181       327.487       406.105    
  32  0.542283     -0.611968      -58.3863       58.3863       314.940       373.326    
  33  0.943132E-01  -2.36113      -225.270       225.270       325.264       550.534    
  34  0.236587      -1.44144      -137.524       137.524       318.008       455.533    
  35  0.283068      -1.26207      -120.411       120.411       317.674       438.085    
  36  0.973178     -0.271886E-01  -2.59400       2.59400       313.152       315.746    
  37  0.596723     -0.516302      -49.2591       49.2591       319.482       368.741    
  38  0.595114     -0.519003      -49.5168       49.5168       318.381       367.898    
  39  0.948736     -0.526250E-01  -5.02082       5.02082       361.180       366.200    
  40  0.216072E-01  -3.83473      -365.862       365.862       294.012       659.874    
  41  0.440213     -0.820496      -78.2815       78.2815       314.057       392.338    
  42  0.905197     -0.996023E-01  -9.50281       9.50281       318.052       327.555    
  43  0.158396      -1.84266      -175.804       175.804       332.752       508.556    
  44  0.287789      -1.24553      -118.833       118.833       284.323       403.156    
  45  0.238244      -1.43446      -136.858       136.858       320.091       456.950    
  46  0.363881      -1.01093      -96.4501       96.4501       319.305       415.755    
  47  0.828805     -0.187771      -17.9148       17.9148       305.147       323.062    
  48  0.587140     -0.532492      -50.8038       50.8038       329.961       380.765    
  49  0.141687      -1.95414      -186.440       186.440       290.274       476.714    
  50  0.879115     -0.128839      -12.2922       12.2922       354.393       366.686    
  51  0.742190     -0.298150      -28.4458       28.4458       310.888       339.334    
  52  0.218958      -1.51887      -144.912       144.912       318.545       463.457    
  53  0.333192      -1.09904      -104.856       104.856       308.952       413.808    
  54  0.356774      -1.03065      -98.3321       98.3321       319.594       417.926    
  55  0.739597     -0.301650      -28.7797       28.7797       290.928       319.707    
  56  0.224658E-01  -3.79576      -362.144       362.144       317.896       680.040    
  57  0.338214      -1.08408      -103.429       103.429       318.025       421.454    
  58  0.227014      -1.48275      -141.465       141.465       300.437       441.902    
  59  0.289792E-01  -3.54118      -337.855       337.855       317.931       655.786    
  60  0.871226     -0.137854      -13.1523       13.1523       319.053       332.205    
  61  0.159622      -1.83495      -175.068       175.068       311.882       486.950    
  62  0.581826     -0.541584      -51.6712       51.6712       316.952       368.623    
  63  0.733467E-02  -4.91514      -468.942       468.942       315.864       784.806    
  64  0.646078     -0.436835      -41.6774       41.6774       321.375       363.052    
  65  0.976710     -0.235653E-01  -2.24830       2.24830       323.786       326.034    
  66  0.390127     -0.941284      -89.8056       89.8056       344.821       434.626    
  67  0.394291     -0.930666      -88.7926       88.7926       312.134       400.926    
  68  0.796004     -0.228151      -21.7673       21.7673       501.425       523.192    
  69  0.393786     -0.931948      -88.9149       88.9149       291.059       379.973    
  70  0.672353     -0.396971      -37.8741       37.8741       317.094       354.968    
  71  0.856786E-01  -2.45715      -234.431       234.431       310.973       545.404    
  72  0.769351     -0.262207      -25.0166       25.0166       332.461       357.478    
  73  0.161441E-01  -4.12620      -393.671       393.671       469.164       862.834    
  74  0.126673      -2.06615      -197.126       197.126       414.704       611.830    
  75  0.594452E-01  -2.82270      -269.307       269.307       558.181       827.488    
  76  0.865232     -0.144757      -13.8109       13.8109       411.198       425.009    
  77  0.980529     -0.196631E-01  -1.87601       1.87601       321.000       322.876    
  78  0.862745     -0.147636      -14.0856       14.0856       568.245       582.330    
  79  0.587821     -0.531332      -50.6931       50.6931       282.959       333.652    
loop,thermsimp(1:2)       19   99.3488       344.310    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    113        932.29         87.89          1.23         40.06          0.29          0.05        129.52
Just calling func    0   0        129.52


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       2    932.29
 mycase(ii+1)=2: hstar-thermstar(myrank+1) > htherm(1) BUT  hstar-thermstar(myrank+1)<htherm(np1-myrank-1) i.e hstar<htherm(np1-1) or (np1-2) ... (np1-myrank-1) .. etc
 mycase(ii+1)=2: hstar > hmi but lower than htherm(myimax-1) 
 nonparal: hstar is not <hmin. but lower than some point, replace p(imax) with pstar and hmax with hstar
 nonparal: note that in nonparallel version it's different, it doesn't sort the objvalue array and it compares hstar to aNY point other than imax
  ---> do nothing and just return the reflection point pstar i.e. mycase(..)=2,mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar.
  ---> Note that this is the only case in which the processor does not do an extra function call


  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       19
neval is:      112
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       19      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       20
neval is:      112


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      112     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.534746     -0.625963      -59.7216       59.7216       288.946       348.667    
   2  0.288348      -1.24359      -118.648       118.648       313.152       431.800    
   3  0.910112E-01  -2.39677      -228.670       228.670       317.888       546.558    
   4  0.213812      -1.54266      -147.181       147.181       278.568       425.749    
   5  0.575222     -0.552999      -52.7603       52.7603       290.928       343.688    
   6  0.855707     -0.155827      -14.8671       14.8671       321.000       335.867    
   7  0.818692     -0.200047      -19.0860       19.0860       305.147       324.233    
   8  0.309911      -1.17147      -111.767       111.767       323.786       435.553    
   9  0.773438     -0.256910      -24.5111       24.5111       318.052       342.564    
  10  0.440502E-01  -3.12243      -297.903       297.903       317.736       615.639    
  11  0.211655      -1.55280      -148.149       148.149       319.053       467.202    
  12  0.713577     -0.337465      -32.1967       32.1967       282.959       315.156    
  13  0.927405     -0.753650E-01  -7.19039       7.19039       315.769       322.960    
  14  0.360229      -1.02101      -97.4124       97.4124       310.888       408.301    
  15  0.911872     -0.922553E-01  -8.80185       8.80185       318.671       327.473    
  16  0.800691     -0.222280      -21.2072       21.2072       317.094       338.301    
  17  0.169830      -1.77296      -169.154       169.154       332.461       501.615    
  18  0.581014     -0.542980      -51.8044       51.8044       313.807       365.611    
  19  0.869395     -0.139958      -13.3530       13.3530       333.837       347.190    
  20  0.773880     -0.256338      -24.4566       24.4566       321.375       345.832    
  21  0.496085     -0.701008      -66.8815       66.8815       269.945       336.827    
  22  0.530037     -0.634809      -60.5655       60.5655       278.834       339.399    
  23  0.239414      -1.42956      -136.391       136.391       361.180       497.571    
  24  0.595728     -0.517972      -49.4184       49.4184       354.393       403.812    
  25  0.170793      -1.76730      -168.614       168.614       318.381       486.995    
  26  0.983027     -0.171183E-01  -1.63321       1.63321       316.952       318.585    
  27  0.608714     -0.496407      -47.3609       47.3609       319.482       366.843    
  28  0.518727     -0.656378      -62.6234       62.6234       317.507       380.131    
  29  0.887918     -0.118876      -11.3417       11.3417       318.025       329.367    
  30  0.140498      -1.96256      -187.243       187.243       325.716       512.959    
  31  0.256308      -1.36138      -129.885       129.885       272.208       402.093    
  32  0.887238     -0.119642      -11.4147       11.4147       312.764       324.179    
  33  0.306042      -1.18403      -112.966       112.966       314.940       427.906    
  34  0.993873     -0.614632E-02 -0.586405      0.586405       319.172       319.759    
  35  0.275412E-01  -3.59207      -342.711       342.711       291.059       633.769    
  36  0.698960     -0.358161      -34.1713       34.1713       329.961       364.133    
  37  0.268424      -1.31519      -125.479       125.479       318.942       444.421    
  38  0.580935E-01  -2.84570      -271.501       271.501       314.057       585.558    
  39  0.242705      -1.41591      -135.088       135.088       316.943       452.032    
  40  0.443517     -0.813019      -77.5682       77.5682       312.134       389.702    
  41  0.904179     -0.100728      -9.61019       9.61019       284.323       293.934    
  42  0.454025     -0.789603      -75.3341       75.3341       327.487       402.821    
  43  0.592994     -0.522572      -49.8573       49.8573       308.952       358.809    
  44  0.401796     -0.911812      -86.9937       86.9937       319.358       406.352    
  45  0.130776      -2.03427      -194.085       194.085       319.305       513.390    
  46  0.709753     -0.342839      -32.7094       32.7094       319.594       352.303    
  47  0.388071     -0.946568      -90.3097       90.3097       318.025       408.335    
  48  0.362521      -1.01467      -96.8073       96.8073       411.198       508.005    
  49  0.285379      -1.25394      -119.635       119.635       344.821       464.456    
  50  0.286508      -1.24999      -119.258       119.258       317.674       436.933    
  51  0.951542     -0.496714E-01  -4.73903       4.73903       300.437       305.176    
  52  0.122933      -2.09612      -199.986       199.986       326.468       526.454    
  53  0.210928      -1.55624      -148.477       148.477       318.008       466.485    
  54  0.860093     -0.150715      -14.3793       14.3793       320.091       334.470    
  55  0.997563     -0.243951E-02 -0.232748      0.232748       318.545       318.777    
  56  0.750720     -0.286722      -27.3554       27.3554       313.360       340.715    
  57  0.667101     -0.404814      -38.6223       38.6223       290.274       328.896    
  58  0.508750E-01  -2.97838      -284.160       284.160       311.882       596.042    
  59  0.552474     -0.593349      -56.6100       56.6100       325.871       382.481    
  60  0.514478     -0.664602      -63.4081       63.4081       317.711       381.119    
  61  0.539834     -0.616494      -58.8182       58.8182       318.025       376.843    
  62  0.610888     -0.492841      -47.0208       47.0208       319.806       366.827    
  63  0.328075      -1.11451      -106.333       106.333       332.752       439.085    
  64  0.894692     -0.111276      -10.6166       10.6166       501.425       512.042    
  65  0.810283     -0.210372      -20.0711       20.0711       310.973       331.044    
  66  0.691642     -0.368687      -35.1755       35.1755       325.264       360.439    
  67  0.896896     -0.108815      -10.3818       10.3818       320.536       330.917    
  68  0.742287     -0.298020      -28.4334       28.4334       568.245       596.678    
  69  0.974450     -0.258821E-01  -2.46935       2.46935       317.923       320.393    
  70  0.339669      -1.07978      -103.019       103.019       414.704       517.723    
  71  0.854515     -0.157221      -15.0001       15.0001       322.677       337.677    
  72  0.153353      -1.87501      -178.890       178.890       276.173       455.063    
  73  0.883349     -0.124034      -11.8338       11.8338       313.757       325.591    
  74  0.716255     -0.333718      -31.8393       31.8393       317.931       349.771    
  75  0.645043     -0.438438      -41.8303       41.8303       294.012       335.842    
  76  0.630111     -0.461860      -44.0649       44.0649       317.896       361.961    
  77  0.511014     -0.671358      -64.0527       64.0527       315.864       379.917    
  78  0.130062      -2.03974      -194.607       194.607       558.181       752.788    
  79  0.671069     -0.398883      -38.0564       38.0564       932.287       970.344    
loop,thermsimp(1:2)       20   59.7216       118.648    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    114        469.16         87.37          1.12         39.93          1.14          0.05        129.62
Just calling func    0   0        129.62


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       2    469.16
 mycase(ii+1)=2: hstar-thermstar(myrank+1) > htherm(1) BUT  hstar-thermstar(myrank+1)<htherm(np1-myrank-1) i.e hstar<htherm(np1-1) or (np1-2) ... (np1-myrank-1) .. etc
 mycase(ii+1)=2: hstar > hmi but lower than htherm(myimax-1) 
 nonparal: hstar is not <hmin. but lower than some point, replace p(imax) with pstar and hmax with hstar
 nonparal: note that in nonparallel version it's different, it doesn't sort the objvalue array and it compares hstar to aNY point other than imax
  ---> do nothing and just return the reflection point pstar i.e. mycase(..)=2,mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar.
  ---> Note that this is the only case in which the processor does not do an extra function call


  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       20
neval is:      113
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       20      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       21
neval is:      113


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      113     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.297422      -1.21260      -115.692       115.692       284.323       400.015    
   2  0.663536     -0.410173      -39.1336       39.1336       300.437       339.570    
   3  0.263982      -1.33188      -127.071       127.071       282.959       410.030    
   4  0.792402     -0.232686      -22.2000       22.2000       316.952       339.152    
   5  0.624731     -0.470434      -44.8829       44.8829       318.545       363.427    
   6  0.170977      -1.76622      -168.511       168.511       319.172       487.684    
   7  0.362487      -1.01477      -96.8165       96.8165       317.923       414.740    
   8  0.659245     -0.416659      -39.7525       39.7525       315.769       355.522    
   9  0.746481E-03  -7.20014      -686.948       686.948       312.764       999.712    
  10  0.690046     -0.370998      -35.3960       35.3960       305.147       340.543    
  11  0.905636     -0.991173E-01  -9.45654       9.45654       313.757       323.214    
  12  0.317643      -1.14683      -109.416       109.416       318.671       428.087    
  13  0.321948      -1.13336      -108.132       108.132       290.274       398.406    
  14  0.293974      -1.22426      -116.804       116.804       318.025       434.829    
  15  0.679275     -0.386729      -36.8968       36.8968       320.536       357.433    
  16  0.180340      -1.71291      -163.425       163.425       310.973       474.398    
  17  0.539600     -0.616927      -58.8595       58.8595       320.091       378.951    
  18  0.260315      -1.34586      -128.405       128.405       294.012       422.417    
  19  0.256777      -1.35955      -129.711       129.711       321.000       450.711    
  20  0.518851     -0.656138      -62.6005       62.6005       269.945       332.546    
  21  0.485887     -0.721780      -68.8633       68.8633       322.677       391.540    
  22  0.562814     -0.574805      -54.8408       54.8408       317.094       371.935    
  23  0.906369     -0.983082E-01  -9.37935       9.37935       278.834       288.213    
  24  0.332143      -1.10219      -105.157       105.157       313.360       418.517    
  25  0.912001E-01  -2.39470      -228.472       228.472       318.052       546.525    
  26  0.302569      -1.19545      -114.055       114.055       290.928       404.982    
  27  0.362040      -1.01600      -96.9341       96.9341       321.375       418.309    
  28  0.630870     -0.460656      -43.9500       43.9500       333.837       377.787    
  29  0.685312     -0.377881      -36.0527       36.0527       288.946       324.998    
  30  0.329910      -1.10894      -105.801       105.801       317.931       423.732    
  31  0.906630E-01  -2.40061      -229.036       229.036       319.594       548.630    
  32  0.339749      -1.07955      -102.997       102.997       308.952       411.949    
  33  0.783039     -0.244573      -23.3341       23.3341       325.264       348.598    
  34  0.322673      -1.13112      -107.917       107.917       317.896       425.813    
  35  0.255311      -1.36527      -130.257       130.257       329.961       460.219    
  36  0.645921     -0.437078      -41.7005       41.7005       313.807       355.508    
  37  0.240122      -1.42661      -136.109       136.109       319.806       455.915    
  38  0.224638      -1.49326      -142.469       142.469       319.482       461.950    
  39  0.682659     -0.381760      -36.4228       36.4228       318.025       354.448    
  40  0.533856     -0.627629      -59.8805       59.8805       315.864       375.745    
  41  0.439620E-02  -5.42701      -517.778       517.778       317.507       835.285    
  42  0.409891     -0.891863      -85.0904       85.0904       317.711       402.801    
  43  0.379406     -0.969149      -92.4641       92.4641       325.871       418.335    
  44  0.982111     -0.180514E-01  -1.72224       1.72224       312.134       313.856    
  45  0.243530      -1.41251      -134.764       134.764       272.208       406.972    
  46  0.709323     -0.343445      -32.7672       32.7672       327.487       360.254    
  47  0.212014      -1.55110      -147.987       147.987       354.393       502.380    
  48  0.530919     -0.633146      -60.4069       60.4069       319.358       379.765    
  49  0.439600     -0.821890      -78.4145       78.4145       310.888       389.303    
  50  0.304385      -1.18946      -113.484       113.484       318.025       431.509    
  51  0.850253     -0.162221      -15.4771       15.4771       278.568       294.045    
  52  0.686564     -0.376055      -35.8785       35.8785       314.940       350.819    
  53  0.894299     -0.111715      -10.6584       10.6584       313.152       323.811    
  54  0.724097E-02  -4.92800      -470.168       470.168       323.786       793.955    
  55  0.666382     -0.405892      -38.7251       38.7251       317.674       356.399    
  56  0.216072      -1.53214      -146.178       146.178       332.752       478.930    
  57  0.481454     -0.730944      -69.7375       69.7375       318.942       388.679    
  58  0.107413      -2.23107      -212.861       212.861       316.943       529.804    
  59  0.943557     -0.580990E-01  -5.54308       5.54308       276.173       281.716    
  60  0.259811      -1.34780      -128.590       128.590       344.821       473.411    
  61  0.526852     -0.640836      -61.1406       61.1406       318.008       379.149    
  62  0.306319E-01  -3.48571      -332.563       332.563       319.053       651.616    
  63  0.180513      -1.71195      -163.333       163.333       318.381       481.714    
  64  0.901495     -0.103701      -9.89385       9.89385       361.180       371.073    
  65  0.274530      -1.29269      -123.333       123.333       332.461       455.794    
  66  0.773836     -0.256395      -24.4620       24.4620       411.198       435.660    
  67  0.158774      -1.84027      -175.576       175.576       501.425       677.001    
  68  0.514226     -0.665093      -63.4549       63.4549       325.716       389.171    
  69  0.312978      -1.16162      -110.828       110.828       319.305       430.133    
  70  0.917534     -0.860656E-01  -8.21131       8.21131       414.704       422.915    
  71  0.548182     -0.601148      -57.3541       57.3541       326.468       383.822    
  72  0.131177      -2.03121      -193.792       193.792       317.888       511.680    
  73  0.407078     -0.898750      -85.7475       85.7475       314.057       399.804    
  74  0.793948     -0.230737      -22.0141       22.0141       311.882       333.896    
  75  0.817497     -0.201509      -19.2254       19.2254       568.245       587.470    
  76  0.948163     -0.532294E-01  -5.07848       5.07848       317.736       322.815    
  77  0.578937E-01  -2.84915      -271.830       271.830       291.059       562.889    
  78  0.701887     -0.353983      -33.7727       33.7727       558.181       591.954    
  79  0.934701     -0.675283E-01  -6.44271       6.44271       469.164       475.606    
loop,thermsimp(1:2)       21   115.692       39.1336    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    115        277.89         87.32          1.12         39.85          1.16          0.05        129.51
Just calling func    0   0        129.51


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    116        308.91         87.30          1.12         39.91          1.23          0.05        129.61
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    277.89
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       21
neval is:      115
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       21      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       22
neval is:      115


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      115     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.383671     -0.957969      -91.3975       91.3975       276.173       367.570    
   2  0.741480     -0.299107      -28.5370       28.5370       278.834       307.371    
   3  0.138898      -1.97401      -188.336       188.336       278.568       466.903    
   4  0.751974E-01  -2.58764      -246.880       246.880       312.134       559.014    
   5  0.824485     -0.192996      -18.4133       18.4133       317.736       336.149    
   6  0.982900     -0.172482E-01  -1.64561       1.64561       313.757       315.403    
   7  0.693409     -0.366136      -34.9321       34.9321       313.152       348.084    
   8  0.941572     -0.602045E-01  -5.74396       5.74396       288.946       294.690    
   9  0.812713     -0.207378      -19.7854       19.7854       269.945       289.730    
  10  0.879507     -0.128393      -12.2497       12.2497       311.882       324.132    
  11  0.418958     -0.869984      -83.0030       83.0030       316.952       399.955    
  12  0.314952      -1.15533      -110.228       110.228       300.437       410.664    
  13  0.812426     -0.207731      -19.8191       19.8191       305.147       324.966    
  14  0.213788      -1.54277      -147.192       147.192       325.264       472.456    
  15  0.521629     -0.650798      -62.0910       62.0910       314.940       377.031    
  16  0.287143      -1.24777      -119.047       119.047       318.025       437.072    
  17  0.518340     -0.657125      -62.6947       62.6947       313.807       376.502    
  18  0.712802E-02  -4.94372      -471.668       471.668       315.769       787.438    
  19  0.579935     -0.544838      -51.9817       51.9817       317.674       369.656    
  20  0.508101E-02  -5.28224      -503.966       503.966       320.536       824.502    
  21  0.984466     -0.156557E-01  -1.49368       1.49368       327.487       328.981    
  22  0.394325     -0.930579      -88.7842       88.7842       318.545       407.329    
  23  0.837309     -0.177562      -16.9408       16.9408       361.180       378.120    
  24  0.683519     -0.380501      -36.3027       36.3027       317.094       353.397    
  25  0.892337     -0.113912      -10.8680       10.8680       315.864       326.732    
  26  0.297675      -1.21175      -115.610       115.610       333.837       449.448    
  27  0.566054     -0.569065      -54.2931       54.2931       320.091       374.384    
  28  0.325499E-01  -3.42498      -326.769       326.769       318.008       644.777    
  29  0.721169     -0.326882      -31.1870       31.1870       319.358       350.545    
  30  0.370449     -0.993040      -94.7435       94.7435       326.468       421.212    
  31  0.398952     -0.918913      -87.6713       87.6713       318.942       406.613    
  32  0.942469     -0.592518E-01  -5.65307       5.65307       325.716       331.369    
  33  0.379045     -0.970101      -92.5550       92.5550       310.888       403.443    
  34  0.218373      -1.52155      -145.167       145.167       322.677       467.844    
  35  0.413944     -0.882024      -84.1517       84.1517       290.274       374.426    
  36  0.452532     -0.792896      -75.6483       75.6483       314.057       389.705    
  37  0.938896     -0.630505E-01  -6.01549       6.01549       284.323       290.339    
  38  0.389299     -0.943409      -90.0083       90.0083       317.711       407.719    
  39  0.943794     -0.578471E-01  -5.51905       5.51905       290.928       296.447    
  40  0.706887     -0.346884      -33.0954       33.0954       272.208       305.303    
  41  0.274873      -1.29145      -123.214       123.214       282.959       406.173    
  42  0.343864      -1.06751      -101.848       101.848       308.952       410.800    
  43  0.869527E-01  -2.44239      -233.023       233.023       317.923       550.946    
  44  0.859615     -0.151271      -14.4324       14.4324       321.375       335.807    
  45  0.264079      -1.33151      -127.036       127.036       325.871       452.907    
  46  0.494871     -0.703457      -67.1151       67.1151       313.360       380.475    
  47  0.112943      -2.18087      -208.072       208.072       294.012       502.084    
  48  0.358273      -1.02646      -97.9321       97.9321       414.704       512.636    
  49  0.215257      -1.53592      -146.538       146.538       317.931       464.470    
  50  0.441681     -0.817166      -77.9638       77.9638       317.896       395.860    
  51  0.888276     -0.118473      -11.3032       11.3032       318.671       329.974    
  52  0.780286     -0.248095      -23.6701       23.6701       319.305       342.975    
  53  0.488747     -0.715911      -68.3033       68.3033       318.025       386.328    
  54  0.683795     -0.380097      -36.2642       36.2642       318.025       354.289    
  55  0.466986     -0.761456      -72.6486       72.6486       411.198       483.847    
  56  0.900497     -0.104809      -9.99954       9.99954       321.000       331.000    
  57  0.876058     -0.132323      -12.6246       12.6246       332.461       345.086    
  58  0.413808     -0.882354      -84.1832       84.1832       319.806       403.990    
  59  0.268165      -1.31615      -125.571       125.571       329.961       455.532    
  60  0.637465     -0.450255      -42.9578       42.9578       319.482       362.439    
  61  0.476344     -0.741616      -70.7557       70.7557       344.821       415.577    
  62  0.878474     -0.129569      -12.3619       12.3619       310.973       323.335    
  63  0.185973      -1.68216      -160.490       160.490       469.164       629.654    
  64  0.802667E-03  -7.12757      -680.024       680.024       332.752       1012.78    
  65  0.480758     -0.732390      -69.8756       69.8756       318.381       388.257    
  66  0.789279     -0.236635      -22.5767       22.5767       319.172       341.749    
  67  0.174217      -1.74745      -166.720       166.720       354.393       521.114    
  68  0.825561     -0.191692      -18.2888       18.2888       317.888       336.176    
  69  0.532291     -0.630566      -60.1607       60.1607       316.943       377.104    
  70  0.118632E-01  -4.43431      -423.067       423.067       318.052       741.119    
  71  0.214857      -1.53778      -146.716       146.716       319.594       466.310    
  72  0.111318      -2.19536      -209.454       209.454       291.059       500.513    
  73  0.823034     -0.194758      -18.5814       18.5814       568.245       586.826    
  74  0.697593     -0.360119      -34.3581       34.3581       558.181       592.539    
  75  0.588207     -0.530676      -50.6305       50.6305       319.053       369.683    
  76  0.384970     -0.954591      -91.0751       91.0751       501.425       592.500    
  77  0.768352     -0.263507      -25.1405       25.1405       323.786       348.927    
  78  0.990092     -0.995757E-02 -0.950028      0.950028       317.507       318.457    
  79  0.550430     -0.597056      -56.9636       56.9636       277.887       334.851    
loop,thermsimp(1:2)       22   91.3975       28.5370    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    117        283.39         87.28          1.12         39.77          1.41          0.05        129.62
Just calling func    0   0        129.63


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    118        286.30         87.29          1.12         39.86          1.48          0.05        129.80
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    283.39
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       22
neval is:      117
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       22      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       23
neval is:      117


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      117     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.327656      -1.11579      -106.455       106.455       269.945       376.400    
   2  0.736029     -0.306486      -29.2411       29.2411       284.323       313.564    
   3  0.608436     -0.496864      -47.4046       47.4046       288.946       336.350    
   4  0.584882     -0.536346      -51.1715       51.1715       290.928       342.099    
   5  0.617514     -0.482053      -45.9915       45.9915       272.208       318.199    
   6  0.376473     -0.976909      -93.2045       93.2045       278.834       372.038    
   7  0.535145     -0.625218      -59.6505       59.6505       313.757       373.408    
   8  0.341783      -1.07358      -102.428       102.428       317.507       419.935    
   9  0.804208E-01  -2.52048      -240.473       240.473       310.973       551.446    
  10  0.660499     -0.414760      -39.5712       39.5712       311.882       351.453    
  11  0.739860E-01  -2.60388      -248.430       248.430       305.147       553.577    
  12  0.203251      -1.59331      -152.014       152.014       315.864       467.878    
  13  0.637025     -0.450946      -43.0237       43.0237       327.487       370.511    
  14  0.687460     -0.374752      -35.7541       35.7541       318.671       354.425    
  15  0.663581     -0.410105      -39.1271       39.1271       321.000       360.127    
  16  0.579690     -0.545263      -52.0222       52.0222       325.716       377.738    
  17  0.775653     -0.254050      -24.2383       24.2383       277.887       302.126    
  18  0.284124      -1.25834      -120.055       120.055       321.375       441.431    
  19  0.317710      -1.14662      -109.396       109.396       317.736       427.132    
  20  0.958871     -0.419990E-01  -4.00703       4.00703       317.888       321.895    
  21  0.582932     -0.539685      -51.4900       51.4900       319.172       370.662    
  22  0.905476     -0.992942E-01  -9.47342       9.47342       319.305       328.778    
  23  0.225214      -1.49070      -142.224       142.224       332.461       474.686    
  24  0.618260     -0.480846      -45.8763       45.8763       313.152       359.028    
  25  0.608706     -0.496420      -47.3622       47.3622       323.786       371.148    
  26  0.651052     -0.429165      -40.9456       40.9456       319.358       360.304    
  27  0.138439E-02  -6.58249      -628.020       628.020       317.094       945.114    
  28  0.157375      -1.84913      -176.420       176.420       318.025       494.446    
  29  0.168063      -1.78342      -170.151       170.151       319.482       489.633    
  30  0.924354     -0.786598E-01  -7.50474       7.50474       276.173       283.678    
  31  0.985585     -0.145204E-01  -1.38536       1.38536       317.674       319.060    
  32  0.540844E-01  -2.91721      -278.324       278.324       319.053       597.377    
  33  0.535345     -0.624843      -59.6148       59.6148       320.091       379.706    
  34  0.736351     -0.306048      -29.1993       29.1993       290.274       319.473    
  35  0.283062E-01  -3.56467      -340.097       340.097       313.807       653.904    
  36  0.690743     -0.369987      -35.2995       35.2995       314.940       350.240    
  37  0.260994      -1.34326      -128.157       128.157       316.943       445.100    
  38  0.243637      -1.41208      -134.723       134.723       361.180       495.902    
  39  0.850226     -0.162253      -15.4802       15.4802       313.360       328.840    
  40  0.589307     -0.528809      -50.4523       50.4523       318.025       368.478    
  41  0.515087     -0.663420      -63.2953       63.2953       318.381       381.676    
  42  0.348855      -1.05310      -100.474       100.474       314.057       414.531    
  43  0.791407     -0.233943      -22.3199       22.3199       317.896       340.216    
  44  0.370775     -0.992160      -94.6595       94.6595       316.952       411.611    
  45  0.676021     -0.391531      -37.3551       37.3551       310.888       348.243    
  46  0.125601      -2.07465      -197.937       197.937       319.806       517.743    
  47  0.582904     -0.539733      -51.4946       51.4946       282.959       334.454    
  48  0.818994     -0.199679      -19.0509       19.0509       318.942       337.993    
  49  0.291406      -1.23304      -117.641       117.641       318.545       436.186    
  50  0.887104     -0.119794      -11.4292       11.4292       317.711       329.140    
  51  0.666242     -0.406102      -38.7452       38.7452       300.437       339.182    
  52  0.931047     -0.714460E-01  -6.81649       6.81649       308.952       315.768    
  53  0.169651      -1.77401      -169.254       169.254       344.821       514.075    
  54  0.228429      -1.47653      -140.872       140.872       326.468       467.340    
  55  0.453181     -0.791463      -75.5116       75.5116       318.025       393.537    
  56  0.376518     -0.976789      -93.1930       93.1930       333.837       427.030    
  57  0.551543     -0.595035      -56.7708       56.7708       325.871       382.642    
  58  0.837469     -0.177371      -16.9226       16.9226       329.961       346.884    
  59  0.436148     -0.829773      -79.1666       79.1666       317.931       397.098    
  60  0.245765      -1.40338      -133.893       133.893       319.594       453.487    
  61  0.727782     -0.317754      -30.3161       30.3161       278.568       308.884    
  62  0.677441     -0.389433      -37.1548       37.1548       322.677       359.831    
  63  0.835222     -0.180057      -17.1788       17.1788       325.264       342.443    
  64  0.964839     -0.357941E-01  -3.41503       3.41503       411.198       414.613    
  65  0.799790     -0.223406      -21.3146       21.3146       291.059       312.373    
  66  0.274169      -1.29401      -123.458       123.458       294.012       417.470    
  67  0.342685      -1.07094      -102.176       102.176       414.704       516.880    
  68  0.688325     -0.373494      -35.6342       35.6342       354.393       390.027    
  69  0.683936     -0.379890      -36.2444       36.2444       317.923       354.168    
  70  0.779136     -0.249570      -23.8109       23.8109       312.134       335.944    
  71  0.806749     -0.214742      -20.4881       20.4881       568.245       588.733    
  72  0.645551     -0.437652      -41.7553       41.7553       501.425       543.180    
  73  0.403078     -0.908624      -86.6896       86.6896       558.181       644.871    
  74  0.663948     -0.409551      -39.0743       39.0743       469.164       508.238    
  75  0.410392     -0.890644      -84.9741       84.9741       318.008       402.983    
  76  0.483021     -0.727696      -69.4276       69.4276       318.052       387.480    
  77  0.174230      -1.74738      -166.713       166.713       315.769       482.482    
  78  0.414733E-01  -3.18271      -303.654       303.654       320.536       624.190    
  79  0.517990     -0.657799      -62.7590       62.7590       283.393       346.152    
loop,thermsimp(1:2)       23   106.455       29.2411    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    119        287.14         87.29          1.14         40.16          0.82          0.05        129.46
Just calling func    0   0        129.46


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    120        575.58         87.28          1.11         39.62          1.48          0.05        129.53
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    287.14
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       23
neval is:      119
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       23      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       24
neval is:      119


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      119     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.291502      -1.23271      -117.610       117.610       276.173       393.782    
   2  0.991852     -0.818183E-02 -0.780608      0.780608       277.887       278.668    
   3  0.317368      -1.14769      -109.499       109.499       278.568       388.066    
   4  0.737330     -0.304720      -29.0726       29.0726       291.059       320.131    
   5  0.834641     -0.180753      -17.2452       17.2452       284.323       301.569    
   6  0.464401     -0.767007      -73.1783       73.1783       308.952       382.130    
   7  0.592116     -0.524053      -49.9986       49.9986       272.208       322.206    
   8  0.464372     -0.767069      -73.1841       73.1841       317.674       390.858    
   9  0.636055E-01  -2.75505      -262.853       262.853       290.274       553.127    
  10  0.712927     -0.338376      -32.2836       32.2836       317.888       350.171    
  11  0.265597      -1.32578      -126.489       126.489       319.305       445.794    
  12  0.152318      -1.88178      -179.536       179.536       313.360       492.896    
  13  0.629580     -0.462703      -44.1453       44.1453       317.711       361.856    
  14  0.849464     -0.163150      -15.5657       15.5657       282.959       298.525    
  15  0.487816     -0.717817      -68.4852       68.4852       312.134       380.619    
  16  0.374667     -0.981718      -93.6633       93.6633       288.946       382.609    
  17  0.657383     -0.419488      -40.0223       40.0223       318.942       358.964    
  18  0.846901     -0.166172      -15.8540       15.8540       300.437       316.291    
  19  0.201185      -1.60353      -152.989       152.989       317.896       470.885    
  20  0.771980     -0.258797      -24.6912       24.6912       290.928       315.619    
  21  0.507739     -0.677788      -64.6661       64.6661       325.264       389.930    
  22  0.280262      -1.27203      -121.361       121.361       283.393       404.755    
  23  0.285359      -1.25401      -119.642       119.642       329.961       449.603    
  24  0.246191      -1.40165      -133.728       133.728       310.888       444.616    
  25  0.559989E-01  -2.88242      -275.005       275.005       314.940       589.945    
  26  0.330462      -1.10726      -105.641       105.641       311.882       417.523    
  27  0.899405     -0.106022      -10.1153       10.1153       317.923       328.039    
  28  0.637003     -0.450981      -43.0270       43.0270       318.671       361.698    
  29  0.699726E-01  -2.65965      -253.751       253.751       313.152       566.903    
  30  0.677191     -0.389802      -37.1900       37.1900       322.677       359.867    
  31  0.649507     -0.431542      -41.1724       41.1724       321.000       362.173    
  32  0.527986     -0.638685      -60.9354       60.9354       319.358       380.293    
  33  0.374870E-01  -3.28376      -313.296       313.296       318.025       631.321    
  34  0.448697     -0.801407      -76.4603       76.4603       327.487       403.947    
  35  0.809612     -0.211200      -20.1501       20.1501       319.172       339.322    
  36  0.836235     -0.178846      -17.0632       17.0632       323.786       340.849    
  37  0.198161      -1.61867      -154.434       154.434       278.834       433.267    
  38  0.222702      -1.50192      -143.294       143.294       313.757       457.052    
  39  0.888863     -0.117812      -11.2401       11.2401       269.945       281.185    
  40  0.868267     -0.141256      -13.4769       13.4769       325.716       339.193    
  41  0.164066      -1.80749      -172.448       172.448       320.091       492.539    
  42  0.163797      -1.80912      -172.604       172.604       318.381       490.985    
  43  0.883498     -0.123867      -11.8178       11.8178       325.871       337.689    
  44  0.749983     -0.287705      -27.4492       27.4492       318.052       345.502    
  45  0.666691     -0.405428      -38.6809       38.6809       354.393       393.074    
  46  0.978530     -0.217038E-01  -2.07070       2.07070       318.025       320.096    
  47  0.442024     -0.816391      -77.8899       77.8899       317.931       395.821    
  48  0.228080      -1.47806      -141.018       141.018       318.008       459.026    
  49  0.226174      -1.48645      -141.818       141.818       316.952       458.770    
  50  0.388394     -0.945736      -90.2304       90.2304       314.057       404.287    
  51  0.257425      -1.35703      -129.470       129.470       411.198       540.669    
  52  0.707288     -0.346317      -33.0413       33.0413       294.012       327.053    
  53  0.518387     -0.657032      -62.6858       62.6858       317.507       380.193    
  54  0.628700     -0.464102      -44.2788       44.2788       333.837       378.116    
  55  0.981249     -0.189295E-01  -1.80602       1.80602       317.736       319.542    
  56  0.928260     -0.744431E-01  -7.10244       7.10244       318.545       325.647    
  57  0.752004E-02  -4.89018      -466.560       466.560       321.375       787.935    
  58  0.930611     -0.719140E-01  -6.86114       6.86114       316.943       323.804    
  59  0.552686     -0.592965      -56.5733       56.5733       319.594       376.167    
  60  0.695877     -0.362583      -34.5931       34.5931       326.468       361.061    
  61  0.432533     -0.838096      -79.9607       79.9607       315.864       395.825    
  62  0.127859      -2.05683      -196.237       196.237       332.461       528.698    
  63  0.304427      -1.18932      -113.471       113.471       315.769       429.240    
  64  0.938376     -0.636043E-01  -6.06833       6.06833       319.482       325.550    
  65  0.958131     -0.427711E-01  -4.08068       4.08068       318.025       322.106    
  66  0.177025      -1.73147      -165.195       165.195       361.180       526.375    
  67  0.352264      -1.04338      -99.5459       99.5459       469.164       568.710    
  68  0.915612     -0.881621E-01  -8.41133       8.41133       344.821       353.232    
  69  0.891986     -0.114305      -10.9055       10.9055       414.704       425.610    
  70  0.754865     -0.281216      -26.8301       26.8301       319.806       346.636    
  71  0.616120     -0.484313      -46.2072       46.2072       501.425       547.632    
  72  0.873159     -0.135638      -12.9409       12.9409       310.973       323.914    
  73  0.437761     -0.826082      -78.8144       78.8144       305.147       383.961    
  74  0.627710     -0.465677      -44.4291       44.4291       568.245       612.674    
  75  0.174492      -1.74588      -166.570       166.570       319.053       485.623    
  76  0.181620      -1.70584      -162.750       162.750       320.536       483.286    
  77  0.514409     -0.664737      -63.4209       63.4209       558.181       621.602    
  78  0.496451     -0.700270      -66.8110       66.8110       313.807       380.618    
  79  0.109177      -2.21478      -211.307       211.307       287.140       498.447    
loop,thermsimp(1:2)       24   117.610      0.780608    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    121        282.66         87.42          1.14         40.05          1.04          0.05        129.71
Just calling func    0   0        129.71


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    122        282.81         87.29          1.13         39.96          0.96          0.05        129.39
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds

  120    282.66        1.705     -1.198      6.146     -102.6     0.6751    
                     -0.1634      3.939     -99.70      4.000     0.9960    
                       1.880     -1.279      1.467    -0.1838E+05 -2.457    
                      -1.179      0.000      0.000      0.000     -1.221    

                      -2.500     0.5077E+05 0.4069E+05 -3888.    -0.8617E+05
                      -2.059     -6.437     -4.361     -7.326      2.969    
                      -13.80     -2.975      2164.      0.000      3781.    

                       4666.      6177.      4588.      8527.      2474.    
                       2998.     0.7093E-01-0.6133E-01  0.000    -0.4872    
                     -0.1003    -0.1553    -0.5947E-01-0.2049    -0.2131E-01

                      -1.491    -0.7594E-01  0.000    -0.3724E-01-0.6558E-02
                      0.8541E-01 0.3966E-01-0.2171E-01-0.3646    -0.1463    
                     -0.4158E-01-0.6451E-01-0.9527E-01-0.3576      0.000    

                      -2.932     -1.598     0.9614     0.9574    -0.1130    
                      0.4257E-01  9.218      9.137    -0.1021E+05 -2.085    
                     -0.5361    -0.7053      9.411      8.561    -0.1000E+05

                      -1.818     0.5536E-01-0.4778      8.765      9.041    
                     -0.1000E+05 -2.085    -0.6478    -0.3187      10.13    
                       8.448    -0.1000E+05 -2.085    
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    282.66
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       24
neval is:      121
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       24      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       25
neval is:      121


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      121     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.145902      -1.92482      -183.643       183.643       277.887       461.530    
   2  0.438196     -0.825090      -78.7198       78.7198       269.945       348.665    
   3  0.637359     -0.450422      -42.9737       42.9737       282.959       325.933    
   4  0.122813      -2.09709      -200.078       200.078       284.323       484.402    
   5  0.926899     -0.759107E-01  -7.24245       7.24245       290.928       298.170    
   6  0.456580     -0.783992      -74.7988       74.7988       300.437       375.236    
   7  0.988763     -0.113008E-01  -1.07819       1.07819       317.736       318.814    
   8  0.499609     -0.693930      -66.2062       66.2062       318.025       384.231    
   9  0.432617     -0.837902      -79.9422       79.9422       291.059       371.001    
  10  0.403570     -0.907406      -86.5734       86.5734       318.025       404.599    
  11  0.435824     -0.830517      -79.2376       79.2376       272.208       351.445    
  12  0.504807     -0.683579      -65.2186       65.2186       316.943       382.162    
  13  0.778763     -0.250048      -23.8565       23.8565       310.973       334.830    
  14  0.429140     -0.845972      -80.7121       80.7121       319.482       400.194    
  15  0.597763     -0.514562      -49.0931       49.0931       318.545       367.638    
  16  0.425932     -0.853476      -81.4280       81.4280       294.012       375.440    
  17  0.825778     -0.191430      -18.2639       18.2639       317.923       336.187    
  18  0.448772     -0.801241      -76.4444       76.4444       325.871       402.316    
  19  0.701335     -0.354770      -33.8477       33.8477       325.716       359.564    
  20  0.425857     -0.853651      -81.4448       81.4448       319.172       400.617    
  21  0.800815     -0.222126      -21.1925       21.1925       323.786       344.979    
  22  0.724239     -0.322634      -30.7817       30.7817       318.052       348.834    
  23  0.312194      -1.16413      -111.067       111.067       319.806       430.873    
  24  0.796592     -0.227412      -21.6969       21.6969       317.888       339.584    
  25  0.164146      -1.80700      -172.402       172.402       344.821       517.222    
  26  0.503041     -0.687083      -65.5529       65.5529       318.942       384.495    
  27  0.640838     -0.444978      -42.4543       42.4543       322.677       365.131    
  28  0.327752      -1.11550      -106.427       106.427       326.468       432.895    
  29  0.720325     -0.328053      -31.2988       31.2988       318.671       349.969    
  30  0.447570     -0.803922      -76.7002       76.7002       317.711       394.411    
  31  0.377461     -0.974289      -92.9545       92.9545       321.000       413.955    
  32  0.951264     -0.499633E-01  -4.76688       4.76688       319.594       324.361    
  33  0.610405     -0.493632      -47.0963       47.0963       333.837       380.933    
  34  0.564697     -0.571466      -54.5222       54.5222       317.507       372.030    
  35  0.993998     -0.601974E-02 -0.574329      0.574329       319.358       319.932    
  36  0.908032     -0.964757E-01  -9.20451       9.20451       313.807       323.011    
  37  0.731210     -0.313055      -29.8678       29.8678       312.134       342.001    
  38  0.818812     -0.199901      -19.0721       19.0721       308.952       328.024    
  39  0.423172     -0.859976      -82.0482       82.0482       288.946       370.994    
  40  0.554414     -0.589843      -56.2755       56.2755       305.147       361.422    
  41  0.244903E-01  -3.70948      -353.912       353.912       278.568       632.480    
  42  0.337898      -1.08501      -103.518       103.518       325.264       428.782    
  43  0.634521E-01  -2.75747      -263.083       263.083       317.674       580.758    
  44  0.824978     -0.192398      -18.3562       18.3562       354.393       372.750    
  45  0.954123     -0.469622E-01  -4.48055       4.48055       276.173       280.653    
  46  0.807852     -0.213376      -20.3577       20.3577       317.931       338.289    
  47  0.335430      -1.09234      -104.218       104.218       315.864       420.082    
  48  0.266194      -1.32353      -126.275       126.275       327.487       453.762    
  49  0.797818     -0.225874      -21.5501       21.5501       314.057       335.607    
  50  0.710601     -0.341644      -32.5954       32.5954       283.393       315.989    
  51  0.469059     -0.757026      -72.2260       72.2260       311.882       384.108    
  52  0.256457E-01  -3.66338      -349.514       349.514       414.704       764.218    
  53  0.620630     -0.477020      -45.5113       45.5113       315.769       361.281    
  54  0.600237     -0.510431      -48.6990       48.6990       278.834       327.533    
  55  0.959467     -0.413769E-01  -3.94767       3.94767       310.888       314.836    
  56  0.541492     -0.613428      -58.5257       58.5257       319.305       377.831    
  57  0.577789     -0.548547      -52.3355       52.3355       329.961       382.297    
  58  0.701570     -0.354435      -33.8157       33.8157       313.757       347.573    
  59  0.274557E-01  -3.59518      -343.007       343.007       316.952       659.959    
  60  0.584746     -0.536578      -51.1936       51.1936       318.008       369.202    
  61  0.131184      -2.03115      -193.787       193.787       317.896       511.683    
  62  0.986883     -0.132037E-01  -1.25973       1.25973       320.536       321.795    
  63  0.257198      -1.35791      -129.555       129.555       319.053       448.608    
  64  0.831173     -0.184917      -17.6425       17.6425       318.381       336.024    
  65  0.332503      -1.10111      -105.054       105.054       320.091       425.145    
  66  0.123451      -2.09191      -199.584       199.584       313.360       512.944    
  67  0.545729     -0.605633      -57.7820       57.7820       287.140       344.922    
  68  0.194995      -1.63478      -155.970       155.970       361.180       517.150    
  69  0.811658     -0.208676      -19.9093       19.9093       332.461       352.371    
  70  0.610911     -0.492804      -47.0172       47.0172       411.198       458.215    
  71  0.482852     -0.728044      -69.4609       69.4609       501.425       570.886    
  72  0.487726     -0.718001      -68.5027       68.5027       290.274       358.777    
  73  0.650526     -0.429973      -41.0227       41.0227       313.152       354.175    
  74  0.710826     -0.341328      -32.5653       32.5653       469.164       501.729    
  75  0.840473     -0.173791      -16.5810       16.5810       314.940       331.521    
  76  0.705857     -0.348343      -33.2346       33.2346       568.245       601.479    
  77  0.890032     -0.116498      -11.1148       11.1148       558.181       569.296    
  78  0.980994     -0.191887E-01  -1.83075       1.83075       318.025       319.856    
  79  0.633321     -0.456778      -43.5801       43.5801       282.662       326.242    
loop,thermsimp(1:2)       25   183.643       78.7198    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    123       1028.32         87.45          1.12         39.95          1.13          0.05        129.69
Just calling func    0   0        129.69


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    124        529.95         87.39          1.11         39.60          1.69          0.05        129.83
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       3    529.95
 mycase(ii+1)=3 or 4: hstar-thermstar(myrank+1) > htherm(1) AND  hstar-thermstar(myrank+1)>htherm(np1-myrank-1)
 nonparal: hstar > all func values except possibly hmax.  
 nonparal: if hstar<=hmax, replace p(imax) with pstar/ hmax with hstar test whether it is < func value at some point other than p(imax)
 reflection did not do any good i.e. hstar not better than the best AND not better than MY worst point (after imax)
 ---> contract by getting the convex combo of pstar and pbar: PSTST= b * pstar + (one-b) * pbar
 ---> compare the contraction point to EITHER pstar OR the worst point of the original simplex (depending on which is better):  
 ---> IF (hstar-thermstar(myrank+1)<htherm(myimax)) THEN i.e. (pstar is better of the two)
 ----------------> IF (hstst<hstar) THEN ! case 3 - return the contraction point
 ----------------------------> mycase(myrank+1)=3, mypoint..pstst, myval..hstst
 ----------------> ELSE - return the better of pstar and the original point, which is here pstar
 ----------------------------> mycase(myrank+1)=4, mypoint..pstar, myval..hstar
 ---> ELSE  ther original point of the simplex is better than pstar 
 ----------------> IF (hstst-thermstst(myrank+1)<htherm(myimax)) THEN ! case 3 - return the contraction point
 ----------------------------> mycase(myrank+1)=3, mypoint..pstst, myval..hstst
 ---------------->ELSE ! case 4 - return the better of pstar and the original point of the simplex,here g(myimax,:)
 ----------------------------> mycase(myrank+1)=4, mypoint..g(myimax,:), myval..h(myimax)


  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       25
neval is:      123
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       25      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       26
neval is:      123


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      123     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.781042     -0.247126      -23.5777       23.5777       276.173       299.750    
   2  0.928800     -0.738619E-01  -7.04699       7.04699       290.928       297.975    
   3  0.727994     -0.317462      -30.2883       30.2883       310.888       341.177    
   4  0.109723E-01  -4.51238      -430.515       430.515       283.393       713.909    
   5  0.160096      -1.83198      -174.785       174.785       317.736       492.521    
   6  0.497079     -0.699006      -66.6905       66.6905       318.025       384.716    
   7  0.789473     -0.236389      -22.5533       22.5533       319.358       341.911    
   8  0.763780     -0.269476      -25.7100       25.7100       320.536       346.246    
   9  0.217288      -1.52653      -145.643       145.643       313.807       459.450    
  10  0.867642     -0.141976      -13.5456       13.5456       319.594       333.140    
  11  0.740966     -0.299800      -28.6032       28.6032       282.959       311.562    
  12  0.999757     -0.242662E-03 -0.231518E-01  0.231518E-01   282.662       282.685    
  13  0.587476     -0.531920      -50.7491       50.7491       278.834       329.583    
  14  0.703619     -0.351518      -33.5375       33.5375       308.952       342.489    
  15  0.740946     -0.299828      -28.6058       28.6058       314.940       343.546    
  16  0.335927      -1.09086      -104.076       104.076       310.973       415.049    
  17  0.736553     -0.305774      -29.1731       29.1731       314.057       343.230    
  18  0.597397     -0.515174      -49.1515       49.1515       318.381       367.533    
  19  0.126601      -2.06672      -197.181       197.181       317.923       515.104    
  20  0.990194     -0.985477E-02 -0.940219      0.940219       317.931       318.872    
  21  0.716453     -0.333443      -31.8130       31.8130       317.888       349.701    
  22  0.279233E-01  -3.57829      -341.396       341.396       312.134       653.530    
  23  0.413932     -0.882054      -84.1546       84.1546       287.140       371.295    
  24  0.109516      -2.21168      -211.011       211.011       323.786       534.797    
  25  0.440749     -0.819279      -78.1654       78.1654       313.757       391.923    
  26  0.412115     -0.886453      -84.5743       84.5743       269.945       354.519    
  27  0.146963      -1.91758      -182.951       182.951       318.052       501.004    
  28  0.345919      -1.06155      -101.280       101.280       318.671       419.951    
  29  0.343614      -1.06824      -101.918       101.918       272.208       374.125    
  30  0.600334E-01  -2.81285      -268.368       268.368       332.461       600.829    
  31  0.751538     -0.285634      -27.2516       27.2516       313.152       340.404    
  32  0.878119     -0.129973      -12.4004       12.4004       290.274       302.674    
  33  0.544046     -0.608721      -58.0766       58.0766       325.716       383.792    
  34  0.931023     -0.714714E-01  -6.81891       6.81891       315.769       322.588    
  35  0.131968      -2.02520      -193.219       193.219       305.147       498.366    
  36  0.826694E-01  -2.49291      -237.842       237.842       322.677       560.519    
  37  0.174702E-02  -6.34984      -605.823       605.823       318.545       924.368    
  38  0.233470      -1.45470      -138.790       138.790       318.008       456.798    
  39  0.232927      -1.45703      -139.012       139.012       288.946       427.957    
  40  0.958279     -0.426163E-01  -4.06592       4.06592       291.059       295.124    
  41  0.820100     -0.198330      -18.9221       18.9221       317.507       336.429    
  42  0.305797      -1.18483      -113.042       113.042       354.393       467.435    
  43  0.260853      -1.34380      -128.209       128.209       300.437       428.645    
  44  0.960408     -0.403967E-01  -3.85415       3.85415       294.012       297.866    
  45  0.318957      -1.14270      -109.022       109.022       319.305       428.327    
  46  0.146887      -1.91809      -183.001       183.001       333.837       516.838    
  47  0.787623     -0.238735      -22.7772       22.7772       316.943       339.720    
  48  0.452412     -0.793163      -75.6737       75.6737       329.961       405.635    
  49  0.218339      -1.52170      -145.182       145.182       311.882       457.064    
  50  0.177672      -1.72782      -164.847       164.847       318.025       482.872    
  51  0.928922     -0.737304E-01  -7.03444       7.03444       318.942       325.976    
  52  0.341447      -1.07456      -102.521       102.521       317.711       420.232    
  53  0.462674     -0.770732      -73.5337       73.5337       319.482       393.015    
  54  0.125513      -2.07534      -198.003       198.003       319.172       517.176    
  55  0.354899      -1.03592      -98.8347       98.8347       325.871       424.706    
  56  0.341830      -1.07344      -102.415       102.415       318.025       420.440    
  57  0.604983     -0.502555      -47.9475       47.9475       321.000       368.948    
  58  0.223932      -1.49641      -142.769       142.769       315.864       458.633    
  59  0.146473      -1.92091      -183.269       183.269       320.091       503.360    
  60  0.997224     -0.277992E-02 -0.265225      0.265225       325.264       325.529    
  61  0.430465     -0.842888      -80.4179       80.4179       319.806       400.224    
  62  0.712472     -0.339015      -32.3446       32.3446       326.468       358.813    
  63  0.303370      -1.19280      -113.802       113.802       319.053       432.855    
  64  0.676458E-01  -2.69347      -256.977       256.977       327.487       584.465    
  65  0.226497      -1.48502      -141.682       141.682       411.198       552.881    
  66  0.590955     -0.526015      -50.1858       50.1858       277.887       328.073    
  67  0.914813     -0.890359E-01  -8.49470       8.49470       284.323       292.818    
  68  0.157483      -1.84844      -176.355       176.355       469.164       645.519    
  69  0.117954E-01  -4.44005      -423.614       423.614       317.896       741.510    
  70  0.589104     -0.529153      -50.4852       50.4852       313.360       363.845    
  71  0.826668     -0.190352      -18.1610       18.1610       361.180       379.341    
  72  0.535992     -0.623635      -59.4995       59.4995       344.821       404.320    
  73  0.460564     -0.775304      -73.9698       73.9698       558.181       632.151    
  74  0.142631E-01  -4.25008      -405.489       405.489       501.425       906.915    
  75  0.599401E-01  -2.81441      -268.516       268.516       317.674       586.190    
  76  0.427239     -0.850412      -81.1357       81.1357       568.245       649.380    
  77  0.181411      -1.70699      -162.860       162.860       278.568       441.427    
  78  0.693634E-01  -2.66840      -254.585       254.585       316.952       571.537    
  79  0.893045     -0.113118      -10.7923       10.7923       529.949       540.741    
loop,thermsimp(1:2)       26   23.5777       7.04699    

 sort simplex so values of h (with thermal fluctuations) are increasing in index. sort g and h acordingly


 calculate pbar [the centroid fo the vertices of best np1 MINUS nprocs points]
 do i=1,np1-nprocs .... pbar = pbar + g(i,:)


 assign each processor one of the nprocs worst points
 myimax=np1-myrank
 for example: if numprocs is 2 so that myrank is 0 or 1, we will have myimax=np1 for myrank=0 and myimax=np1-1 for myrank=1. 
 then reflect the worst point [g(myimax,:) ] through pbar and call this pstar and get obj value at pstar and call it hstar 

iter,obj,time:    125        279.24         87.27          1.14         40.01          1.08          0.05        129.55
Just calling func    0   0        129.55


reflection --> reflecting MY worst point i.e. g( myimax,:) through PBAR to get the reflection point PSTAR. 
(R) PSTAR = a * (PBAR - g(imax,:)) + PBAR 
(RR) HSTAR=functn(PSTAR,HSTAR) 

now each processor follows different instructions based on their hstar  
and they return a point mypoint with value myval in appropriate index corresponding to which proccessor. 
record what happened in appropriate engry of mycase 

iter,obj,time:    126        275.74         87.38          1.17         40.09          0.84          0.05        129.52
 share outcomes and figure out what the new simplex will look like
 First share outcomes MYCASE, MYPOINT and MYVAL
 right after mycase,mypoint,myval assignments: count number of function evaluations, print as appropriate
 nrounds is no of evals per processor (it can be >1 depending on mycase
 nevalp=nevalp+nrounds
 do 0 to nprocs and writes down what their mycase situation is (after broadcast)
 For case=1 where the reflection PSTAR gives a HSTAR lower than current min, we do  expansion to calculate a new PSTST through expanding and then compare that PSTST to PSTAR
 For case=2 where the reflection PSTAR gives a HSTAR higher than current min BUT lower than htherm(myimax-1), we do nothing (no new PSTST) 
 For case=3, where the reflection PSTAR gives a HSTAR higher than both the current min AND htherm(myimax-1)
 ............we do contraction to calculate a new PSTST by convx combo of pstar and pbar 
 ............then we compare PSTST to EITHER pstar OR the worst point of the original simplex (depending on which is better):  


  myrank  mycase     myval
       0       1    275.74
 mycase(ii+1)=1: hstar-thermstar(myrank+1) < htherm(1) where htherm(1) is the minimum
 nonparal: hstar < hmin. reflection did well i.e. hstar is lower than the current min (htherm(1))
  ---> expand further i.e. expand pbar in the direction of pstar --> call it pstst
  ---> call functn to get h at expansion pt pstst and call it hstst: PSTST,HSTST
  -------------> if hstst<hstar then return expansion point (pstst) i.e. mypoint(myrank+1,:)=pstst,myval(myrank+1)=hstst
  -------------> if hstst>=hstar then return reflection point (pstar) i.e. mypoint(myrank+1,:)=pstar,myval(myrank+1)=hstar



  myrank  mycase     myval
       0    ****      0.00




 CHECK cases
 -----IF at least one proces did not have case 4, then replace worst points and restart loop
 -----IF all processes had case 4, then shrink
current SAtemp,tstepnext are:    95.4076               157
loop is:       26
neval is:      125
 ............
 ............
 ............
 ............
 At least one process did not have case 4 ---> replace the worst nprocs points of simplex with mypoint(1:nprocs) and restart loop
 -----> g(np1-nprocs+1:np1,:)=mypoint(1:nprocs,:)
 -----> h(np1-nprocs+1:np1)=myval(1:nprocs)
 -----> go to 250 (which starts main cycle if loop<nloop)
        loop,nloop are:       26      95
 right before GO TO 250



beginning of Main_loop, just augmented loop: loop=loop+1
T0,tstep,tfreq (these do not change):    95.4076      0.500000    
T0,tstep,tfreq (these do not change):             78
current SAtemp,tstepnext are:    95.4076               157
loop is:       27
neval is:      125


Should I lower temperature?
check: neval>tstepnext?
---if yes: lower temp and get the new temp as SAtemp=SAtemp*Tstep and new tstepnext as tstepnext=tstepnext+Tfreq : 
---if no:  leave SAtemp and tstepnext as they are  lower temp and get the new temp as SAtemp=SAtemp*Tstep: 


 After checking wtr I should lower temperature i.e. out of the neval>tstepnext if statement 
next time, will lower temprature when neval>tstepnext:      157
neval,tstepnext:      125     157

compute and add thermal fluctuations: thermsimp,thermstar,thermstst 


   i      SArandom   logSArandom    SAtemp*log     thermsimp      h       htherm=h+thermsimp
   1  0.818509     -0.200271      -19.1074       19.1074       282.662       301.769    
   2  0.309452      -1.17295      -111.909       111.909       284.323       396.232    
   3  0.303638      -1.19192      -113.718       113.718       291.059       404.777    
   4  0.754457     -0.281757      -26.8817       26.8817       294.012       320.894    
   5  0.623133     -0.472996      -45.1274       45.1274       290.928       336.055    
   6  0.989422E-01  -2.31322      -220.699       220.699       276.173       496.871    
   7  0.695126     -0.363662      -34.6961       34.6961       290.274       324.970    
   8  0.832210E-01  -2.48626      -237.208       237.208       282.959       520.167    
   9  0.869521     -0.139813      -13.3392       13.3392       317.931       331.271    
  10  0.488136     -0.717160      -68.4225       68.4225       315.769       384.192    
  11  0.579877     -0.544940      -51.9914       51.9914       325.264       377.255    
  12  0.480435     -0.733064      -69.9398       69.9398       318.942       388.882    
  13  0.792626     -0.232404      -22.1731       22.1731       277.887       300.061    
  14  0.870230     -0.138998      -13.2614       13.2614       278.834       292.095    
  15  0.886361     -0.120631      -11.5091       11.5091       319.594       331.103    
  16  0.358181      -1.02672      -97.9566       97.9566       317.507       415.464    
  17  0.560125     -0.579594      -55.2977       55.2977       316.943       372.241    
  18  0.546151     -0.604859      -57.7081       57.7081       313.152       370.860    
  19  0.732086     -0.311858      -29.7536       29.7536       310.888       340.642    
  20  0.590102     -0.527460      -50.3237       50.3237       319.358       369.682    
  21  0.867355     -0.142307      -13.5772       13.5772       308.952       322.529    
  22  0.749758     -0.288005      -27.4779       27.4779       314.057       341.535    
  23  0.721970     -0.325772      -31.0811       31.0811       314.940       346.021    
  24  0.596865     -0.516065      -49.2365       49.2365       320.536       369.772    
  25  0.878161     -0.129925      -12.3958       12.3958       317.888       330.283    
  26  0.558752E-01  -2.88463      -275.216       275.216       269.945       545.161    
  27  0.555543     -0.587810      -56.0815       56.0815       326.468       382.550    
  28  0.597562     -0.514897      -49.1250       49.1250       313.360       362.485    
  29  0.995329     -0.468202E-02 -0.446700      0.446700       318.381       318.828    
  30  0.206787      -1.57606      -150.368       150.368       321.000       471.369    
  31  0.645457     -0.437797      -41.7692       41.7692       287.140       328.909    
  32  0.871352     -0.137710      -13.1385       13.1385       272.208       285.346    
  33  0.701360     -0.354733      -33.8442       33.8442       361.180       395.024    
  34  0.936151     -0.659784E-01  -6.29484       6.29484       325.716       332.011    
  35  0.590091     -0.527478      -50.3254       50.3254       318.025       368.351    
  36  0.750433     -0.287105      -27.3920       27.3920       313.757       341.149    
  37  0.326255      -1.12007      -106.864       106.864       319.482       426.345    
  38  0.873133     -0.135668      -12.9437       12.9437       319.806       332.750    
  39  0.621627     -0.475415      -45.3582       45.3582       344.821       390.179    
  40  0.153041      -1.87705      -179.085       179.085       329.961       509.046    
  41  0.196696      -1.62610      -155.142       155.142       310.973       466.115    
  42  0.365028      -1.00778      -96.1499       96.1499       318.671       414.821    
  43  0.398429     -0.920226      -87.7965       87.7965       317.711       405.507    
  44  0.549691     -0.598399      -57.0918       57.0918       318.025       375.117    
  45  0.994179     -0.583795E-02 -0.556985      0.556985       325.871       326.428    
  46  0.147335E-01  -4.21763      -402.394       402.394       288.946       691.340    
  47  0.224737      -1.49282      -142.427       142.427       319.305       461.732    
  48  0.182172      -1.70281      -162.461       162.461       300.437       462.897    
  49  0.230919      -1.46569      -139.838       139.838       319.053       458.891    
  50  0.491818     -0.709647      -67.7057       67.7057       278.568       346.273    
  51  0.370754     -0.992217      -94.6650       94.6650       318.008       412.673    
  52  0.785622     -0.241279      -23.0199       23.0199       311.882       334.902    
  53  0.476284     -0.741742      -70.7678       70.7678       315.864       386.632    
  54  0.958799     -0.420736E-01  -4.01414       4.01414       313.807       317.821    
  55  0.305133      -1.18701      -113.249       113.249       354.393       467.643    
  56  0.270329      -1.30812      -124.804       124.804       318.025       442.829    
  57  0.130426      -2.03695      -194.340       194.340       317.736       512.076    
  58  0.222171      -1.50431      -143.522       143.522       305.147       448.669    
  59  0.233872      -1.45298      -138.625       138.625       318.052       456.678    
  60  0.916355E-02  -4.69252      -447.702       447.702       320.091       767.793    
  61  0.400634     -0.914708      -87.2700       87.2700       317.923       405.194    
  62  0.354647E-01  -3.33922      -318.587       318.587       333.837       652.424    
  63  0.453450     -0.790870      -75.4549       75.4549       319.172       394.627    
  64  0.411527     -0.887880      -84.7105       84.7105       323.786       408.497    
  65  0.607753     -0.497987      -47.5117       47.5117       529.949       577.461    
  66  0.157481      -1.84845      -176.356       176.356       411.198       587.554    
  67  0.260711E-01  -3.64693      -347.944       347.944       322.677       670.621    
  68  0.183987      -1.69289      -161.515       161.515       316.952       478.466    
  69  0.704951     -0.349627      -33.3571       33.3571       327.487       360.844    
  70  0.337767      -1.08540      -103.555       103.555       317.674       421.230    
  71  0.718219     -0.330981      -31.5781       31.5781       332.461       364.039    
